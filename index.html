<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Consciousness OS v6.0</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #f8f6ff;
  --bg2: #ffffff;
  --bg3: #f0ecff;
  --text: #1a1040;
  --text2: #4a3f6b;
  --text3: #7c6d99;
  --border: #e2d9f3;
  --primary: #7c3aed;
  --primary2: #6d28d9;
  --accent: #06b6d4;
  --accent2: #0891b2;
  --pink: #ec4899;
  --success: #10b981;
  --warning: #f59e0b;
  --danger: #ef4444;
  --card-shadow: 0 2px 12px rgba(124,58,237,0.08);
  --nav-h: 56px;
  --topbar-h: 54px;
}
[data-theme="dark"] {
  --bg: #0f0a1e;
  --bg2: #1a1035;
  --bg3: #221a42;
  --text: #f0ebff;
  --text2: #c4b5fd;
  --text3: #9170d8;
  --border: #2d2250;
  --card-shadow: 0 2px 12px rgba(0,0,0,0.4);
}
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%;font-family:"DM Sans",sans-serif;background:var(--bg);color:var(--text);font-size:15px;overflow-x:hidden}

/* ‚îÄ‚îÄ TOPBAR ‚îÄ‚îÄ */
.topbar{position:fixed;top:0;left:0;right:0;height:var(--topbar-h);background:var(--bg2);border-bottom:1px solid var(--border);display:flex;align-items:center;padding:0 8px;gap:0;z-index:200;box-shadow:var(--card-shadow)}
.topbar-brand{font-family:"Syne",sans-serif;font-weight:800;font-size:14px;background:linear-gradient(135deg,var(--primary),var(--pink));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;flex-shrink:0;white-space:nowrap;padding-right:8px;cursor:default}
.topbar-actions{display:flex;gap:5px;align-items:center;overflow-x:auto;flex:1;min-width:0;scrollbar-width:none;-webkit-overflow-scrolling:touch;padding:4px 0;scroll-behavior:smooth}
.topbar-actions::-webkit-scrollbar{display:none}
.tb-btn{background:var(--bg3);border:1.5px solid var(--border);color:var(--text);border-radius:9px;padding:5px 10px;cursor:pointer;font-size:12px;font-weight:600;display:flex;align-items:center;gap:3px;transition:all .2s;white-space:nowrap;flex-shrink:0;height:32px;font-family:"DM Sans",sans-serif}
.tb-btn:hover,.tb-btn:active{background:var(--primary);color:#fff;border-color:var(--primary)}
.lang-sel{background:var(--bg3);border:1.5px solid var(--border);color:var(--text);border-radius:9px;padding:4px 5px;cursor:pointer;font-size:11px;font-weight:600;flex-shrink:0;height:32px}

/* ‚îÄ‚îÄ BOTTOM NAV ‚îÄ‚îÄ */
.bottom-nav{position:fixed;bottom:0;left:0;right:0;height:var(--nav-h);background:var(--bg2);border-top:1px solid var(--border);display:flex;overflow-x:auto;z-index:200;scrollbar-width:none}
.bottom-nav::-webkit-scrollbar{display:none}
.nav-tab{flex:0 0 auto;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:0 11px;gap:2px;cursor:pointer;border:none;background:transparent;color:var(--text3);font-size:10px;font-family:"DM Sans",sans-serif;transition:all .2s;min-width:56px}
.nav-tab .ni{font-size:18px;line-height:1}
.nav-tab.active{color:var(--primary)}
.nav-tab.active .ni{transform:scale(1.15)}

/* ‚îÄ‚îÄ MAIN CONTENT ‚îÄ‚îÄ */
.main{padding-top:calc(var(--topbar-h) + 12px);padding-bottom:calc(var(--nav-h) + 16px);min-height:100vh}
.tab-panel{display:none;padding:0 14px;animation:fadeUp .3s ease}
.tab-panel.active{display:block}
@keyframes fadeUp{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:none}}

/* ‚îÄ‚îÄ CARDS ‚îÄ‚îÄ */
.card{background:var(--bg2);border:1px solid var(--border);border-radius:14px;padding:16px;margin-bottom:14px;box-shadow:var(--card-shadow)}
.card-title{font-family:"Syne",sans-serif;font-weight:700;font-size:15px;color:var(--text);margin-bottom:12px;display:flex;align-items:center;gap:7px}
.card-title .emoji{font-size:18px}
.section-header{font-family:"Syne",sans-serif;font-weight:700;font-size:19px;margin:18px 0 10px;display:flex;align-items:center;gap:8px}

/* ‚îÄ‚îÄ BUTTONS ‚îÄ‚îÄ */
.btn{display:inline-flex;align-items:center;gap:6px;padding:9px 16px;border-radius:10px;border:none;cursor:pointer;font-family:"DM Sans",sans-serif;font-weight:600;font-size:14px;transition:all .2s}
.btn-primary{background:linear-gradient(135deg,var(--primary),var(--pink));color:#fff}
.btn-primary:hover{opacity:.88;transform:translateY(-1px)}
.btn-secondary{background:var(--bg3);border:1px solid var(--border);color:var(--text2)}
.btn-secondary:hover{border-color:var(--primary);color:var(--primary)}
.btn-accent{background:linear-gradient(135deg,var(--accent),var(--accent2));color:#fff}
.btn-danger{background:var(--danger);color:#fff}
.btn-sm{padding:6px 11px;font-size:12px;border-radius:8px}
.btn-block{width:100%;justify-content:center}

/* ‚îÄ‚îÄ FORMS ‚îÄ‚îÄ */
.form-group{margin-bottom:14px}
.form-label{display:block;font-size:12px;font-weight:600;color:var(--text2);margin-bottom:5px;text-transform:uppercase;letter-spacing:.5px}
.form-input,.form-select,.form-textarea{width:100%;background:var(--bg3);border:1px solid var(--border);border-radius:10px;padding:9px 12px;color:var(--text);font-family:"DM Sans",sans-serif;font-size:14px;transition:border .2s;outline:none}
.form-input:focus,.form-select:focus,.form-textarea:focus{border-color:var(--primary)}
.form-textarea{resize:vertical;min-height:80px}
.form-row{display:grid;grid-template-columns:1fr 1fr;gap:10px}

/* ‚îÄ‚îÄ ENHANCED SLIDER WITH DOTS ‚îÄ‚îÄ */
.slider-group{margin-bottom:20px}
.slider-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.slider-label{font-size:13px;font-weight:600;color:var(--text2)}
.slider-value-badge{background:var(--primary);color:#fff;border-radius:20px;padding:2px 10px;font-size:13px;font-weight:700;min-width:32px;text-align:center}
.slider-track{width:100%;-webkit-appearance:none;appearance:none;height:6px;border-radius:3px;outline:none;background:linear-gradient(to right,var(--primary) var(--pct,50%),var(--border) var(--pct,50%));cursor:pointer;margin-bottom:8px}
.slider-track::-webkit-slider-thumb{-webkit-appearance:none;width:20px;height:20px;border-radius:50%;background:var(--primary);box-shadow:0 2px 8px rgba(124,58,237,0.4);cursor:pointer;border:2px solid #fff}
.slider-dots{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}
.slider-dot{width:22px;height:22px;border-radius:50%;border:2px solid var(--border);background:var(--bg3);display:flex;align-items:center;justify-content:center;font-size:9px;font-weight:700;color:var(--text3);transition:all .25s;cursor:default}
.slider-dot.active{border-color:var(--primary);background:var(--primary);color:#fff;transform:scale(1.2)}
.slider-dot.near{border-color:var(--primary);background:var(--bg3);color:var(--primary)}
.slider-anchor-text{font-size:11px;color:var(--text3);text-align:center;min-height:30px;transition:all .3s;background:var(--bg3);border-radius:8px;padding:5px 8px;line-height:1.4}
.slider-pair-labels{display:flex;justify-content:space-between;font-size:9px;color:var(--text3);margin-top:2px;padding:0 2px}

/* ‚îÄ‚îÄ BRAINWAVE PLAYER ‚îÄ‚îÄ */
.bw-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:14px}
.bw-card{background:var(--bg3);border:1px solid var(--border);border-radius:12px;padding:12px;cursor:pointer;transition:all .25s;text-align:center;position:relative;overflow:hidden}
.bw-card::before{content:'';position:absolute;inset:0;background:linear-gradient(135deg,var(--primary),var(--accent));opacity:0;transition:.3s}
.bw-card.playing::before{opacity:.12}
.bw-card.playing{border-color:var(--primary);box-shadow:0 0 16px rgba(124,58,237,0.25)}
.bw-card .bw-emoji{font-size:28px;margin-bottom:6px;display:block}
.bw-card .bw-name{font-weight:700;font-size:13px;color:var(--text);position:relative}
.bw-card .bw-desc{font-size:11px;color:var(--text3);margin-top:3px;position:relative}
.bw-card .bw-freq{font-size:10px;color:var(--accent);font-weight:600;margin-top:3px;position:relative}
.bw-visualizer{height:60px;background:var(--bg3);border-radius:10px;margin-bottom:12px;display:flex;align-items:center;justify-content:center;gap:3px;overflow:hidden}
.bw-bar{width:4px;border-radius:2px;background:linear-gradient(to top,var(--primary),var(--accent));animation:none;transform-origin:bottom}
.bw-bar.animating{animation:bwAnim var(--dur,0.5s) ease-in-out infinite alternate}
@keyframes bwAnim{from{transform:scaleY(.2)}to{transform:scaleY(1)}}
.bw-controls{display:flex;gap:8px;align-items:center;background:var(--bg3);border-radius:12px;padding:12px;margin-bottom:12px}
.bw-vol{flex:1}
.bw-timer{font-size:12px;color:var(--text3);font-weight:600;min-width:48px;text-align:right}
.wave-type-btns{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:10px}
.wave-btn{padding:5px 11px;border-radius:20px;border:1px solid var(--border);background:var(--bg3);color:var(--text2);font-size:11px;cursor:pointer;transition:all .2s}
.wave-btn.active{background:var(--primary);color:#fff;border-color:var(--primary)}

/* ‚îÄ‚îÄ AI HUB ‚îÄ‚îÄ */
.ai-models-bar{display:flex;gap:6px;overflow-x:auto;padding-bottom:6px;margin-bottom:12px;scrollbar-width:none}
.ai-models-bar::-webkit-scrollbar{display:none}
.ai-model-btn{flex:0 0 auto;display:flex;flex-direction:column;align-items:center;gap:3px;padding:8px 12px;border-radius:10px;border:2px solid var(--border);background:var(--bg3);cursor:pointer;transition:all .2s;min-width:72px}
.ai-model-btn.active{border-color:var(--primary);background:var(--bg)}
.ai-model-btn .ai-logo{font-size:20px}
.ai-model-btn .ai-name{font-size:10px;font-weight:700;color:var(--text2)}
.chat-messages{height:340px;overflow-y:auto;background:var(--bg3);border-radius:12px;padding:12px;margin-bottom:10px;display:flex;flex-direction:column;gap:10px}
.chat-msg{max-width:85%;padding:10px 13px;border-radius:12px;font-size:13px;line-height:1.5;animation:fadeUp .2s ease}
.chat-msg.user{align-self:flex-end;background:linear-gradient(135deg,var(--primary),var(--pink));color:#fff;border-bottom-right-radius:3px}
.chat-msg.ai{align-self:flex-start;background:var(--bg2);border:1px solid var(--border);color:var(--text);border-bottom-left-radius:3px}
.chat-msg.ai .ai-tag{font-size:10px;font-weight:700;color:var(--primary);margin-bottom:4px}
.chat-input-area{display:flex;gap:8px}
.chat-input{flex:1;background:var(--bg3);border:1px solid var(--border);border-radius:10px;padding:9px 12px;color:var(--text);font-family:"DM Sans",sans-serif;font-size:14px;outline:none;resize:none;height:44px;max-height:140px;overflow:hidden;transition:border .2s}
.chat-input:focus{border-color:var(--primary)}
.suggested-qs{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:8px}
.sq-btn{padding:5px 10px;border-radius:20px;border:1px solid var(--border);background:var(--bg3);color:var(--text2);font-size:11px;cursor:pointer;transition:all .2s;white-space:nowrap}
.sq-btn:hover{border-color:var(--primary);color:var(--primary)}
.ai-tip-card{background:linear-gradient(135deg,rgba(124,58,237,.1),rgba(236,72,153,.1));border:1px solid rgba(124,58,237,.2);border-radius:12px;padding:12px;margin-bottom:10px;font-size:13px;line-height:1.5}
.chat-controls{display:flex;gap:6px;margin-bottom:8px}

/* ‚îÄ‚îÄ ANALYSIS ‚îÄ‚îÄ */
.stats-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-bottom:14px}
.stat-box{background:var(--bg3);border-radius:12px;padding:12px;text-align:center;border:1px solid var(--border)}
.stat-box .sv{font-size:24px;font-weight:800;font-family:"Syne",sans-serif;color:var(--primary)}
.stat-box .sl{font-size:10px;color:var(--text3);margin-top:2px}
.trend-item{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid var(--border)}
.trend-item:last-child{border-bottom:none}

/* ‚îÄ‚îÄ HEALTH ‚îÄ‚îÄ */
.health-jump-bar{display:flex;gap:5px;flex-wrap:wrap;margin-bottom:14px}
.section-jump{padding:4px 9px;border-radius:20px;border:1px solid var(--border);background:var(--bg3);color:var(--text2);font-size:11px;cursor:pointer;transition:all .2s}
.section-jump.active{background:var(--primary);color:#fff;border-color:var(--primary)}
.health-progress{height:6px;background:var(--bg3);border-radius:3px;margin-bottom:14px;overflow:hidden}
.health-progress-bar{height:100%;background:linear-gradient(to right,var(--primary),var(--pink));border-radius:3px;transition:width .4s}
.health-section{display:none}
.health-section.active{display:block}
.unit-toggle{display:flex;gap:0;border-radius:8px;overflow:hidden;border:1px solid var(--border);width:fit-content}
.unit-btn{padding:5px 12px;font-size:12px;cursor:pointer;border:none;background:var(--bg3);color:var(--text2);font-family:"DM Sans",sans-serif;transition:all .2s}
.unit-btn.active{background:var(--primary);color:#fff}
.dual-input{display:flex;gap:6px;align-items:center}
.dual-input .form-input{flex:1}
.dual-input .unit-label{font-size:12px;color:var(--text3);white-space:nowrap}

/* ‚îÄ‚îÄ GAMES ‚îÄ‚îÄ */
.games-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:14px}
.game-card{background:var(--bg3);border:1px solid var(--border);border-radius:12px;padding:14px;text-align:center;cursor:pointer;transition:all .25s}
.game-card:hover{border-color:var(--primary);transform:translateY(-2px);box-shadow:0 6px 20px rgba(124,58,237,.15)}
.game-card .g-emoji{font-size:32px;margin-bottom:6px;display:block}
.game-card .g-name{font-weight:700;font-size:13px;color:var(--text)}
.game-card .g-desc{font-size:11px;color:var(--text3);margin-top:3px}
.game-card .g-tag{font-size:10px;color:var(--accent);font-weight:600;margin-top:4px}
.game-view{display:none}
.game-view.active{display:block}
.game-header{display:flex;align-items:center;gap:10px;margin-bottom:14px}
.game-score-bar{display:flex;gap:14px;background:var(--bg3);border-radius:10px;padding:10px 14px;margin-bottom:14px}
.game-score-bar .gs{text-align:center;flex:1}
.game-score-bar .gsv{font-size:20px;font-weight:800;font-family:"Syne",sans-serif;color:var(--primary)}
.game-score-bar .gsl{font-size:10px;color:var(--text3)}
#sudoku-grid{display:grid;grid-template-columns:repeat(9,1fr);gap:1px;background:var(--border);border:2px solid var(--primary);border-radius:8px;overflow:hidden;max-width:340px;margin:0 auto 14px}
.sudoku-cell{background:var(--bg3);aspect-ratio:1;display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:700;color:var(--text);cursor:pointer;transition:background .15s;border:none}
.sudoku-cell:nth-child(3n){border-right:2px solid var(--primary)}
.sudoku-cell.given{color:var(--primary);background:rgba(124,58,237,.08)}
.sudoku-cell.selected{background:rgba(124,58,237,.25)}
.sudoku-cell.error{background:rgba(239,68,68,.15);color:var(--danger)}
.sudoku-numpad{display:grid;grid-template-columns:repeat(9,1fr);gap:4px;margin-bottom:10px;max-width:340px;margin:0 auto 14px}
.sudoku-num{background:var(--bg3);border:1px solid var(--border);border-radius:6px;padding:8px 4px;text-align:center;cursor:pointer;font-weight:700;font-size:13px;transition:all .2s}
.sudoku-num:hover{background:var(--primary);color:#fff}
.pattern-grid{display:grid;gap:6px;margin-bottom:14px}
.pattern-cell{border-radius:8px;aspect-ratio:1;transition:all .3s;cursor:pointer;border:2px solid transparent}
.pattern-cell.show{border-color:var(--primary);box-shadow:0 0 16px rgba(124,58,237,.4)}
.typing-area{font-size:16px;line-height:1.8;letter-spacing:.3px}
.typing-area .correct{color:var(--success)}
.typing-area .incorrect{color:var(--danger);text-decoration:underline}
.typing-area .current{background:var(--primary);color:#fff;border-radius:2px}

/* ‚îÄ‚îÄ DREAMS ‚îÄ‚îÄ */
.dream-types{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:10px}
.dream-type-btn{padding:5px 11px;border-radius:20px;border:1px solid var(--border);background:var(--bg3);color:var(--text2);font-size:12px;cursor:pointer;transition:all .2s}
.dream-type-btn.active{background:var(--primary);color:#fff;border-color:var(--primary)}
.technique-card{background:var(--bg3);border:1px solid var(--border);border-radius:12px;padding:14px;margin-bottom:10px;cursor:pointer;transition:all .2s}
.technique-card:hover{border-color:var(--primary)}
.technique-card .tc-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}
.technique-card .tc-title{font-weight:700;font-size:14px}
.technique-card .tc-body{font-size:13px;color:var(--text2);line-height:1.5;display:none}
.technique-card.open .tc-body{display:block}
.technique-card .tc-chevron{transition:transform .2s;color:var(--text3)}
.technique-card.open .tc-chevron{transform:rotate(180deg)}
.dream-ai-box{background:linear-gradient(135deg,rgba(124,58,237,.1),rgba(6,182,212,.1));border:1px solid rgba(124,58,237,.2);border-radius:12px;padding:14px;margin-top:10px}

/* ‚îÄ‚îÄ VOICE & MEDIA ‚îÄ‚îÄ */
.recorder-visual{width:80px;height:80px;border-radius:50%;background:linear-gradient(135deg,var(--primary),var(--pink));display:flex;align-items:center;justify-content:center;margin:0 auto 14px;cursor:pointer;transition:all .3s;font-size:32px}
.recorder-visual.recording{animation:pulse 1s ease-in-out infinite;box-shadow:0 0 0 0 rgba(124,58,237,.5)}
@keyframes pulse{0%,100%{box-shadow:0 0 0 0 rgba(124,58,237,.5)}50%{box-shadow:0 0 0 14px rgba(124,58,237,0)}}
.memo-item{background:var(--bg3);border:1px solid var(--border);border-radius:10px;padding:10px;margin-bottom:8px}
.memo-meta{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;font-size:11px;color:var(--text3)}
.media-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:8px}
.media-thumb{aspect-ratio:1;border-radius:8px;overflow:hidden;background:var(--bg3);cursor:pointer;position:relative}
.media-thumb img,.media-thumb video{width:100%;height:100%;object-fit:cover}
.ai-insight-box{background:linear-gradient(135deg,rgba(16,185,129,.1),rgba(6,182,212,.1));border:1px solid rgba(16,185,129,.2);border-radius:12px;padding:12px;margin-top:10px;font-size:13px}

/* ‚îÄ‚îÄ CALENDAR & ALARMS ‚îÄ‚îÄ */
.cal-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:3px;margin-bottom:14px}
.cal-day-header{text-align:center;font-size:10px;font-weight:700;color:var(--text3);padding:4px 0}
.cal-day{aspect-ratio:1;border-radius:8px;display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:12px;cursor:pointer;position:relative;border:1px solid transparent;transition:all .2s}
.cal-day:hover{background:var(--bg3)}
.cal-day.today{background:var(--primary);color:#fff;font-weight:700}
.cal-day.has-log{border-color:var(--primary);color:var(--primary)}
.cal-day.has-dream::after{content:'üí§';font-size:8px;position:absolute;bottom:1px;right:1px}
.alarm-item{display:flex;justify-content:space-between;align-items:center;background:var(--bg3);border-radius:10px;padding:10px;margin-bottom:6px;border:1px solid var(--border)}
.alarm-toggle{width:40px;height:22px;border-radius:11px;background:var(--border);position:relative;cursor:pointer;transition:background .2s}
.alarm-toggle.on{background:var(--primary)}
.alarm-toggle::after{content:'';position:absolute;width:18px;height:18px;border-radius:50%;background:#fff;top:2px;left:2px;transition:left .2s;box-shadow:0 1px 4px rgba(0,0,0,.2)}
.alarm-toggle.on::after{left:20px}

/* ‚îÄ‚îÄ SETTINGS ‚îÄ‚îÄ */
.setting-item{display:flex;justify-content:space-between;align-items:center;padding:12px 0;border-bottom:1px solid var(--border)}
.setting-item:last-child{border-bottom:none}
.setting-info{flex:1;padding-right:12px}
.setting-title{font-weight:600;font-size:14px}
.setting-desc{font-size:12px;color:var(--text3);margin-top:2px}
.toggle{width:44px;height:24px;border-radius:12px;background:var(--border);position:relative;cursor:pointer;transition:background .25s;flex-shrink:0}
.toggle.on{background:var(--primary)}
.toggle::after{content:'';position:absolute;width:20px;height:20px;border-radius:50%;background:#fff;top:2px;left:2px;transition:left .25s;box-shadow:0 1px 4px rgba(0,0,0,.2)}
.toggle.on::after{left:22px}
.setting-help{font-size:10px;color:var(--accent);cursor:pointer;margin-top:3px;display:inline-block}

/* ‚îÄ‚îÄ MODALS ‚îÄ‚îÄ */
.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.5);backdrop-filter:blur(4px);z-index:500;display:flex;align-items:center;justify-content:center;padding:14px;opacity:0;pointer-events:none;transition:opacity .3s}
.modal-overlay.open{opacity:1;pointer-events:all}
.modal{background:var(--bg2);border-radius:18px;width:100%;max-width:460px;max-height:85vh;overflow-y:auto;padding:20px;animation:fadeUp .3s ease;border:1px solid var(--border);scrollbar-width:thin}
.modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}
.modal-title{font-family:"Syne",sans-serif;font-weight:700;font-size:18px}
.modal-close{background:var(--bg3);border:none;border-radius:8px;padding:6px 10px;cursor:pointer;font-size:16px;color:var(--text3)}

/* ‚îÄ‚îÄ ONBOARDING ‚îÄ‚îÄ */
.onboard-overlay{position:fixed;inset:0;background:rgba(0,0,0,.6);backdrop-filter:blur(6px);z-index:800;display:flex;align-items:center;justify-content:center;padding:16px}
.onboard-card{background:var(--bg2);border-radius:20px;width:100%;max-width:420px;padding:24px;border:1px solid var(--border);max-height:90vh;overflow-y:auto}
.onboard-step{display:none;animation:fadeUp .3s ease}
.onboard-step.active{display:block}
.onboard-icon{font-size:56px;text-align:center;margin-bottom:14px;display:block}
.onboard-title{font-family:"Syne",sans-serif;font-size:22px;font-weight:800;text-align:center;margin-bottom:8px;background:linear-gradient(135deg,var(--primary),var(--pink));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.onboard-text{text-align:center;color:var(--text2);font-size:14px;line-height:1.6;margin-bottom:18px}
.onboard-features{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:18px}
.of-item{background:var(--bg3);border-radius:10px;padding:10px;text-align:center;border:1px solid var(--border)}
.of-item .of-icon{font-size:22px;margin-bottom:4px}
.of-item .of-name{font-size:11px;font-weight:700;color:var(--text)}
.onboard-dots{display:flex;justify-content:center;gap:6px;margin-bottom:16px}
.odot{width:8px;height:8px;border-radius:50%;background:var(--border);transition:all .2s}
.odot.active{background:var(--primary);width:22px;border-radius:4px}
.onboard-nav{display:flex;gap:8px}

/* ‚îÄ‚îÄ TOAST ‚îÄ‚îÄ */
.toast{position:fixed;bottom:calc(var(--nav-h) + 14px);left:50%;transform:translateX(-50%) translateY(20px);background:var(--text);color:var(--bg);padding:10px 20px;border-radius:24px;font-size:13px;font-weight:600;z-index:9999;opacity:0;transition:all .3s;pointer-events:none;white-space:nowrap}
.toast.show{opacity:1;transform:translateX(-50%) translateY(0)}

/* ‚îÄ‚îÄ MISC ‚îÄ‚îÄ */
.badge{display:inline-block;padding:2px 8px;border-radius:12px;font-size:10px;font-weight:700}
.badge-primary{background:rgba(124,58,237,.15);color:var(--primary)}
.badge-success{background:rgba(16,185,129,.15);color:var(--success)}
.badge-warning{background:rgba(245,158,11,.15);color:var(--warning)}
.badge-danger{background:rgba(239,68,68,.15);color:var(--danger)}
.progress-bar-wrap{height:8px;background:var(--bg3);border-radius:4px;overflow:hidden}
.progress-bar-fill{height:100%;border-radius:4px;background:linear-gradient(to right,var(--primary),var(--pink));transition:width .4s}
.divider{border:none;border-top:1px solid var(--border);margin:14px 0}
.empty-state{text-align:center;padding:30px 20px;color:var(--text3)}
.empty-state .es-icon{font-size:40px;margin-bottom:10px;display:block}
.empty-state .es-text{font-size:14px}
.chip{display:inline-flex;align-items:center;gap:4px;padding:3px 9px;border-radius:12px;background:var(--bg3);border:1px solid var(--border);font-size:11px;color:var(--text2);margin:2px}
.score-ring{position:relative;width:80px;height:80px;flex-shrink:0}
.score-ring svg{transform:rotate(-90deg)}
.score-ring .ring-text{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;font-family:"Syne",sans-serif;font-weight:800;font-size:18px;color:var(--primary)}
.score-ring .ring-sub{font-size:8px;color:var(--text3);font-family:"DM Sans",sans-serif;font-weight:400}
.collapsible-header{display:flex;justify-content:space-between;align-items:center;cursor:pointer;padding:10px 0;user-select:none}
.collapsible-body{display:none}
.collapsible-body.open{display:block}
@media(max-width:380px){.bw-grid,.games-grid{grid-template-columns:1fr}}
.rc-item{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid var(--border)}
.rc-item:last-child{border-bottom:none}
.spinner{display:inline-block;width:16px;height:16px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:spin .6s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
.ai-loading{display:flex;gap:5px;align-items:center;padding:8px 12px}
.ai-loading span{width:6px;height:6px;border-radius:50%;background:var(--primary);animation:bounce .8s ease-in-out infinite}
.ai-loading span:nth-child(2){animation-delay:.15s}
.ai-loading span:nth-child(3){animation-delay:.3s}
@keyframes bounce{0%,100%{transform:translateY(0)}50%{transform:translateY(-6px)}}
.reality-check-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.rc-btn{background:var(--bg3);border:1px solid var(--border);border-radius:10px;padding:12px;text-align:center;cursor:pointer;transition:all .2s}
.rc-btn:hover{border-color:var(--success)}
.rc-btn.done{border-color:var(--success);background:rgba(16,185,129,.1)}
.rc-btn .rc-icon{font-size:22px;margin-bottom:4px;display:block}
.rc-btn .rc-name{font-size:11px;font-weight:700;color:var(--text)}
.health-nav-btns{display:flex;justify-content:space-between;margin-top:16px}
.comparison-row{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:10px}
.comparison-box{background:var(--bg3);border:1px solid var(--border);border-radius:10px;padding:12px;text-align:center}
.comparison-box .cv{font-size:22px;font-weight:800;font-family:"Syne",sans-serif}
.comparison-box .cl{font-size:11px;color:var(--text3);margin-top:3px}

/* ‚îÄ‚îÄ THEME ENGINE ‚îÄ‚îÄ */
[data-theme="scifi"]{--bg:#020818;--bg2:#05122e;--bg3:#0a1f42;--text:#a0d4ff;--text2:#7ab8e8;--text3:#4a8fbe;--border:#1a3a6a;--primary:#00b4ff;--primary2:#0088cc;--accent:#00ffcc;--pink:#ff006a;--card-shadow:0 0 20px rgba(0,180,255,0.15)}
[data-theme="natural"]{--bg:#f0f7ee;--bg2:#ffffff;--bg3:#e8f5e3;--text:#1a3a1f;--text2:#2d5a35;--text3:#5a8a5f;--border:#c5e0c5;--primary:#2d7a3a;--primary2:#1d5a2a;--accent:#5dba6f;--pink:#c87f5f;--card-shadow:0 2px 12px rgba(45,122,58,0.1)}
[data-theme="spiritual"]{--bg:#1a0a2e;--bg2:#231040;--bg3:#2d1a55;--text:#f0d9ff;--text2:#d4a8ff;--text3:#9a6fcc;--border:#3d2570;--primary:#c040ff;--primary2:#9020e0;--accent:#ffcc00;--pink:#ff80c0;--card-shadow:0 0 20px rgba(192,64,255,0.15)}
[data-theme="classic"]{--bg:#faf8f0;--bg2:#ffffff;--bg3:#f5f0e8;--text:#2c1a00;--text2:#5c4020;--text3:#8c7050;--border:#d4c4a0;--primary:#8b4513;--primary2:#6b3010;--accent:#c87020;--pink:#e05060;--card-shadow:0 2px 12px rgba(139,69,19,0.1)}
[data-theme="winter"]{--bg:#e8f4ff;--bg2:#ffffff;--bg3:#d0ebff;--text:#0a2040;--text2:#204060;--text3:#507090;--border:#a0c8e8;--primary:#0060c0;--primary2:#0040a0;--accent:#00b0d8;--pink:#d060c0;--card-shadow:0 2px 12px rgba(0,96,192,0.1)}
[data-theme="summer"]{--bg:#fff8e8;--bg2:#ffffff;--bg3:#fff0c8;--text:#3a1a00;--text2:#6a3a10;--text3:#a06030;--border:#e8c870;--primary:#e08000;--primary2:#c06000;--accent:#f0a000;--pink:#e04080;--card-shadow:0 2px 12px rgba(224,128,0,0.12)}

/* ‚îÄ‚îÄ WORLD / FINANCE TAB ‚îÄ‚îÄ */
.world-nav{display:flex;gap:6px;overflow-x:auto;padding-bottom:6px;margin-bottom:14px;scrollbar-width:none}
.world-nav::-webkit-scrollbar{display:none}
.world-nav-btn{flex:0 0 auto;padding:6px 14px;border-radius:20px;border:1px solid var(--border);background:var(--bg3);color:var(--text2);font-size:12px;font-weight:600;cursor:pointer;transition:all .2s;white-space:nowrap}
.world-nav-btn.active{background:var(--primary);color:#fff;border-color:var(--primary)}
.world-panel{display:none}
.world-panel.active{display:block}
.market-card{background:var(--bg3);border:1px solid var(--border);border-radius:12px;padding:12px;margin-bottom:8px;display:flex;justify-content:space-between;align-items:center;cursor:pointer;transition:all .2s}
.market-card:hover{border-color:var(--primary)}
.market-card .mc-name{font-weight:700;font-size:14px}
.market-card .mc-price{font-size:18px;font-weight:800;font-family:"Syne",sans-serif;color:var(--primary)}
.market-card .mc-change{font-size:12px;font-weight:700}
.mc-up{color:var(--success)}
.mc-down{color:var(--danger)}
.causal-chain{background:linear-gradient(135deg,rgba(124,58,237,.08),rgba(6,182,212,.08));border:1px solid rgba(124,58,237,.2);border-radius:12px;padding:14px;margin-top:10px}
.causal-step{display:flex;gap:10px;margin-bottom:10px;align-items:flex-start}
.causal-step:last-child{margin-bottom:0}
.causal-arrow{font-size:18px;color:var(--accent);flex-shrink:0;margin-top:2px}
.causal-text{font-size:13px;color:var(--text2);line-height:1.5}
.geo-event{background:var(--bg3);border-left:3px solid var(--primary);border-radius:0 10px 10px 0;padding:10px 12px;margin-bottom:8px;cursor:pointer;transition:all .2s}
.geo-event:hover{background:rgba(124,58,237,.08)}
.geo-event .ge-title{font-weight:700;font-size:13px}
.geo-event .ge-meta{font-size:11px;color:var(--text3);margin-top:2px}
.ai-ask-box{background:var(--bg3);border:1px solid var(--border);border-radius:12px;padding:12px;margin-bottom:12px}
.ai-ask-row{display:flex;gap:8px;margin-top:8px}

/* ‚îÄ‚îÄ PATH / CAREER TAB ‚îÄ‚îÄ */
.path-stage-btns{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:14px}
.path-stage-btn{padding:6px 13px;border-radius:20px;border:1px solid var(--border);background:var(--bg3);color:var(--text2);font-size:12px;cursor:pointer;transition:all .2s}
.path-stage-btn.active{background:var(--primary);color:#fff;border-color:var(--primary)}
.skill-tag{display:inline-flex;align-items:center;gap:4px;padding:4px 10px;border-radius:12px;background:rgba(124,58,237,.1);border:1px solid rgba(124,58,237,.2);font-size:11px;color:var(--primary);margin:2px;font-weight:600}
.path-result-card{background:linear-gradient(135deg,rgba(124,58,237,.08),rgba(236,72,153,.08));border:1px solid rgba(124,58,237,.25);border-radius:14px;padding:16px;margin-top:12px}
.path-result-card h3{font-family:"Syne",sans-serif;font-size:16px;font-weight:700;margin-bottom:10px}
.path-detail{font-size:13px;color:var(--text2);line-height:1.6}
.energy-pattern-btn{padding:5px 11px;border-radius:20px;border:1px solid var(--border);background:var(--bg3);color:var(--text2);font-size:11px;cursor:pointer;transition:all .2s;margin:2px}
.energy-pattern-btn.active{background:var(--accent);color:#fff;border-color:var(--accent)}

/* ‚îÄ‚îÄ SCIENCE TAB ‚îÄ‚îÄ */
.science-nav{display:flex;gap:6px;overflow-x:auto;padding-bottom:6px;margin-bottom:14px;scrollbar-width:none}
.science-nav::-webkit-scrollbar{display:none}
.science-cat-btn{flex:0 0 auto;padding:6px 13px;border-radius:20px;border:1px solid var(--border);background:var(--bg3);color:var(--text2);font-size:12px;font-weight:600;cursor:pointer;transition:all .2s;white-space:nowrap}
.science-cat-btn.active{background:var(--accent);color:#fff;border-color:var(--accent)}
.discovery-card{background:var(--bg2);border:1px solid var(--border);border-radius:14px;padding:16px;margin-bottom:12px;cursor:pointer;transition:all .2s;position:relative;overflow:hidden}
.discovery-card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,var(--primary),var(--accent))}
.discovery-card:hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(124,58,237,.15)}
.dc-category{font-size:10px;font-weight:700;color:var(--accent);text-transform:uppercase;letter-spacing:.8px;margin-bottom:6px}
.dc-title{font-family:"Syne",sans-serif;font-size:15px;font-weight:700;margin-bottom:6px}
.dc-desc{font-size:12px;color:var(--text2);line-height:1.5}
.dc-impact{font-size:11px;color:var(--primary);font-weight:600;margin-top:6px}
.superfact-card{background:linear-gradient(135deg,var(--bg3),var(--bg2));border:1px solid var(--border);border-radius:12px;padding:14px;margin-bottom:10px;cursor:pointer}
.superfact-card .sf-num{font-size:28px;font-weight:800;font-family:"Syne",sans-serif;color:var(--primary);margin-bottom:4px}
.superfact-card .sf-text{font-size:13px;color:var(--text2);line-height:1.5}

/* ‚îÄ‚îÄ SYSTEM TAB ‚îÄ‚îÄ */
.theme-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-bottom:14px}
.theme-swatch{border-radius:10px;padding:10px 6px;text-align:center;cursor:pointer;border:2px solid transparent;transition:all .2s}
.theme-swatch.active{border-color:var(--primary)}
.theme-swatch .ts-circle{width:28px;height:28px;border-radius:50%;margin:0 auto 4px}
.theme-swatch .ts-name{font-size:10px;font-weight:700;color:var(--text2)}
.legal-item{display:flex;justify-content:space-between;align-items:center;padding:12px 0;border-bottom:1px solid var(--border);cursor:pointer}
.legal-item:last-child{border-bottom:none}
.legal-item:hover .li-title{color:var(--primary)}
.li-title{font-weight:600;font-size:14px;transition:color .2s}
.li-desc{font-size:12px;color:var(--text3);margin-top:2px}
.account-options{display:flex;flex-direction:column;gap:8px}
.account-option{background:var(--bg3);border:1px solid var(--border);border-radius:12px;padding:14px;cursor:pointer;display:flex;align-items:center;gap:12px;transition:all .2s}
.account-option:hover{border-color:var(--primary)}
.account-option .ao-icon{font-size:28px;flex-shrink:0}
.account-option .ao-title{font-weight:700;font-size:14px}
.account-option .ao-desc{font-size:12px;color:var(--text3);margin-top:2px}
.consciousness-guide-card{background:linear-gradient(135deg,rgba(124,58,237,.1),rgba(192,64,255,.1));border:1px solid rgba(124,58,237,.25);border-radius:14px;padding:16px;margin-bottom:12px}
.guide-section{margin-bottom:14px}
.guide-section h3{font-family:"Syne",sans-serif;font-size:15px;font-weight:700;margin-bottom:6px;color:var(--primary)}
.guide-section p{font-size:13px;color:var(--text2);line-height:1.7}

/* ‚îÄ‚îÄ PASSIVE TRACKING ‚îÄ‚îÄ */
.telemetry-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:12px}
.telemetry-box{background:var(--bg3);border:1px solid var(--border);border-radius:10px;padding:10px;text-align:center}
.telemetry-box .tb-val{font-size:20px;font-weight:800;font-family:"Syne",sans-serif;color:var(--accent)}
.telemetry-box .tb-lbl{font-size:10px;color:var(--text3);margin-top:2px}
.correlation-item{display:flex;gap:10px;padding:8px 0;border-bottom:1px solid var(--border);align-items:center;cursor:pointer}
.correlation-item:last-child{border-bottom:none}
.corr-icon{font-size:20px;flex-shrink:0}
.corr-text{font-size:12px;color:var(--text2);line-height:1.4}
.corr-strength{font-size:11px;font-weight:700;color:var(--primary)}

/* ‚îÄ‚îÄ SYSTEM NAV TABS ‚îÄ‚îÄ */
.sys-tab-row{display:flex;gap:0;border-radius:10px;overflow:hidden;border:1px solid var(--border);margin-bottom:14px}
.sys-tab-btn{flex:1;padding:8px 4px;font-size:11px;font-weight:700;border:none;background:var(--bg3);color:var(--text2);cursor:pointer;transition:all .2s;font-family:"DM Sans",sans-serif}
.sys-tab-btn.active{background:var(--primary);color:#fff}
.sys-panel{display:none}
.sys-panel.active{display:block}

/* ‚îÄ‚îÄ NEWS DETAIL ‚îÄ‚îÄ */
.news-article{background:var(--bg2);border:1px solid var(--border);border-radius:14px;padding:16px;margin-bottom:12px;cursor:pointer;transition:all .2s;position:relative}
.news-article::before{content:'';position:absolute;top:0;left:0;width:4px;height:100%;background:linear-gradient(180deg,var(--primary),var(--accent));border-radius:14px 0 0 14px}
.news-article:hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(124,58,237,.15);border-color:var(--primary)}
.news-category{font-size:10px;font-weight:700;color:var(--accent);text-transform:uppercase;letter-spacing:.8px;margin-bottom:6px}
.news-headline{font-family:"Syne",sans-serif;font-size:15px;font-weight:700;margin-bottom:6px;line-height:1.3}
.news-summary{font-size:12px;color:var(--text2);line-height:1.5;margin-bottom:8px}
.news-meta{display:flex;gap:8px;align-items:center;font-size:10px;color:var(--text3)}
.news-impact{font-size:11px;color:var(--primary);font-weight:600;margin-top:6px;padding-top:6px;border-top:1px solid var(--border)}
.news-detail-overlay{position:fixed;inset:0;background:rgba(0,0,0,.6);backdrop-filter:blur(6px);z-index:700;display:none;overflow-y:auto;padding:14px}
.news-detail-overlay.open{display:block}
.news-detail-card{background:var(--bg2);border-radius:18px;max-width:600px;margin:0 auto;padding:20px;border:1px solid var(--border);animation:fadeUp .3s ease}
.news-detail-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:16px}
.news-detail-close{background:var(--bg3);border:none;border-radius:8px;padding:6px 10px;cursor:pointer;font-size:18px;color:var(--text3);flex-shrink:0}
.news-detail-body{font-size:14px;color:var(--text2);line-height:1.8}
.news-detail-body p{margin-bottom:12px}
.news-detail-body strong{color:var(--text)}
.news-detail-body h3{font-family:"Syne",sans-serif;font-size:15px;font-weight:700;margin:14px 0 8px;color:var(--text)}

/* ‚îÄ‚îÄ STUDY QUESTIONNAIRE ‚îÄ‚îÄ */
.study-section{display:none}
.study-section.active{display:block}
.study-jump-bar{display:flex;gap:4px;flex-wrap:wrap;margin-bottom:12px}
.study-jump{padding:3px 8px;border-radius:16px;border:1px solid var(--border);background:var(--bg3);color:var(--text2);font-size:10px;cursor:pointer;transition:all .2s}
.study-jump.active{background:var(--primary);color:#fff;border-color:var(--primary)}
.study-progress{height:5px;background:var(--bg3);border-radius:3px;margin-bottom:14px;overflow:hidden}
.study-progress-bar{height:100%;background:linear-gradient(to right,var(--accent),var(--primary));border-radius:3px;transition:width .4s}
.study-result{background:linear-gradient(135deg,rgba(6,182,212,.1),rgba(124,58,237,.1));border:1px solid rgba(6,182,212,.25);border-radius:14px;padding:16px;margin-top:12px}
.study-result h2{font-family:"Syne",sans-serif;font-size:18px;font-weight:800;margin-bottom:12px;color:var(--primary)}
.study-result h3{font-family:"Syne",sans-serif;font-size:14px;font-weight:700;margin:12px 0 6px;color:var(--text)}
.study-result p{font-size:13px;color:var(--text2);line-height:1.7;margin-bottom:8px}
.study-rating{display:flex;gap:6px;flex-wrap:wrap}
.study-rating-btn{width:36px;height:36px;border-radius:50%;border:2px solid var(--border);background:var(--bg3);color:var(--text2);font-size:13px;font-weight:700;cursor:pointer;transition:all .2s;display:flex;align-items:center;justify-content:center}
.study-rating-btn.active{background:var(--primary);color:#fff;border-color:var(--primary)}

/* ‚îÄ‚îÄ NEW GAMES ‚îÄ‚îÄ */
.chess-board{display:grid;grid-template-columns:repeat(8,1fr);max-width:340px;margin:0 auto 12px;border:2px solid var(--primary);border-radius:4px;overflow:hidden}
.chess-sq{aspect-ratio:1;display:flex;align-items:center;justify-content:center;font-size:22px;cursor:pointer;transition:background .15s;user-select:none}
.chess-sq.light{background:#f0d9b5}
.chess-sq.dark-sq{background:#b58863}
.chess-sq.selected{background:rgba(124,58,237,.5)!important}
.chess-sq.valid-move{background:rgba(0,200,0,.4)!important}
.anagram-input{font-size:22px;font-weight:800;font-family:Syne,sans-serif;text-align:center;letter-spacing:4px}
.word-scramble-letters{display:flex;gap:8px;justify-content:center;flex-wrap:wrap;margin-bottom:14px}
.letter-tile{width:40px;height:48px;background:var(--primary);color:#fff;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:20px;font-weight:800;font-family:Syne,sans-serif;cursor:pointer;transition:all .2s;user-select:none}
.letter-tile:hover{transform:translateY(-4px);box-shadow:0 6px 16px rgba(124,58,237,.4)}
.simon-grid{display:grid;grid-template-columns:1fr 1fr;gap:6px;max-width:280px;margin:0 auto 14px}
.simon-btn{aspect-ratio:1;border-radius:16px;cursor:pointer;transition:all .15s;border:none;opacity:.8}
.simon-btn.lit{opacity:1;transform:scale(1.05);box-shadow:0 0 20px currentColor}
.trivia-option{background:var(--bg3);border:2px solid var(--border);border-radius:10px;padding:12px;margin-bottom:8px;cursor:pointer;font-size:14px;font-weight:600;transition:all .2s}
.trivia-option:hover{border-color:var(--primary)}
.trivia-option.correct{background:rgba(16,185,129,.2);border-color:var(--success);color:var(--success)}
.trivia-option.wrong{background:rgba(239,68,68,.15);border-color:var(--danger);color:var(--danger)}
</style>
</head>
<body>

<!-- ‚ïê‚ïê TOPBAR ‚ïê‚ïê -->
<div class="topbar">
  <div class="topbar-brand">üß† Consciousness OS</div>
  <div class="topbar-actions">
    <select class="lang-sel" id="langSel" onchange="setLang(this.value)" title="Language">
      <option value="en">üåê EN</option>
      <option value="hi">üáÆüá≥ HI</option>
      <option value="es">üá™üá∏ ES</option>
      <option value="fr">üá´üá∑ FR</option>
      <option value="de">üá©üá™ DE</option>
      <option value="pt">üáßüá∑ PT</option>
      <option value="zh">üá®üá≥ ZH</option>
      <option value="ar">üá∏üá¶ AR</option>
      <option value="ja">üáØüáµ JA</option>
      <option value="ru">üá∑üá∫ RU</option>
    </select>
    <button class="tb-btn" onclick="toggleTheme()" id="themeBtn" title="Toggle theme">üåô Theme</button>
    <button class="tb-btn" onclick="switchTab('world')" title="News & World">üåç News</button>
    <button class="tb-btn" onclick="switchTab('science')" title="Science Feed">üî¨ Science</button>
    <button class="tb-btn" onclick="showOnboarding()" title="App guide">‚ùì</button>
    <button class="tb-btn" onclick="exportData()" title="Export">üíæ</button>
  </div>
</div>

<!-- ‚ïê‚ïê MAIN CONTENT ‚ïê‚ïê -->
<div class="main">

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     TAB 1 ‚Äî DAILY CONSCIOUSNESS LOG
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="tab-panel active" id="tab-log">
  <div class="section-header">üìù <span data-t="daily_log">Daily Consciousness Log</span></div>

  <div class="card">
    <div class="card-title"><span class="emoji">üìÖ</span> <span data-t="entry_info">Entry Info</span></div>
    <div class="form-row">
      <div class="form-group"><label class="form-label" data-t="date">Date</label>
        <input type="date" class="form-input" id="logDate"></div>
      <div class="form-group"><label class="form-label" data-t="time_of_day">Time of Day</label>
        <select class="form-select" id="logTime">
          <option value="morning">üåÖ Morning</option>
          <option value="afternoon">‚òÄÔ∏è Afternoon</option>
          <option value="evening">üåÜ Evening</option>
          <option value="night">üåô Night</option>
        </select></div>
    </div>
    <div class="form-row">
      <div class="form-group"><label class="form-label" data-t="activity">Activity</label>
        <select class="form-select" id="logActivity">
          <option>Deep Work</option><option>Exercise</option><option>Rest</option><option>Social</option><option>Learning</option><option>Creative</option><option>Meditation</option><option>Entertainment</option>
        </select></div>
      <div class="form-group"><label class="form-label">Brainwave State</label>
        <select class="form-select" id="logBrainwave">
          <option>Alpha (Relaxed Focus)</option><option>Beta (Active Thinking)</option><option>Gamma (Peak Performance)</option><option>Theta (Creativity/Dream)</option><option>Delta (Deep Rest)</option>
        </select></div>
    </div>
  </div>

  <div class="card">
    <div class="card-title"><span class="emoji">üéöÔ∏è</span> <span data-t="consciousness_metrics">Consciousness Metrics</span></div>
    <div id="slidersContainer"></div>
    <div style="display:flex;align-items:center;justify-content:space-between;margin-top:10px">
      <div style="font-size:13px;color:var(--text2)">Consciousness Score</div>
      <div class="score-ring">
        <svg width="80" height="80" viewBox="0 0 80 80">
          <circle cx="40" cy="40" r="34" fill="none" stroke="var(--border)" stroke-width="7"/>
          <circle id="scoreCircle" cx="40" cy="40" r="34" fill="none" stroke="var(--primary)" stroke-width="7"
            stroke-dasharray="213.6" stroke-dashoffset="213.6" stroke-linecap="round"/>
        </svg>
        <div class="ring-text"><span id="scoreValue">0.0</span><span class="ring-sub">/ 10</span></div>
      </div>
    </div>
  </div>

  <div class="card">
    <div class="card-title"><span class="emoji">üßò</span> Inner State</div>
    <div class="form-row">
      <div class="form-group"><label class="form-label">Dominant Emotion</label>
        <select class="form-select" id="logEmotion">
          <option>Joy</option><option>Calm</option><option>Curious</option><option>Focused</option><option>Creative</option><option>Anxious</option><option>Frustrated</option><option>Tired</option><option>Inspired</option><option>Grateful</option><option>Melancholy</option><option>Excited</option><option>Neutral</option>
        </select></div>
      <div class="form-group"><label class="form-label">Physical Sensation</label>
        <select class="form-select" id="logSensation">
          <option>Energized</option><option>Relaxed</option><option>Tense</option><option>Heavy</option><option>Light</option><option>Neutral</option><option>Achy</option><option>Vibrant</option>
        </select></div>
    </div>
  </div>

  <div class="card">
    <div class="card-title"><span class="emoji">‚úçÔ∏è</span> Reflections</div>
    <div class="form-group"><label class="form-label">Raw Thoughts / Stream of Consciousness</label>
      <textarea class="form-textarea" id="logThought" placeholder="What's on your mind right now?"></textarea></div>
    <div class="form-group"><label class="form-label">Key Insight Today</label>
      <textarea class="form-textarea" id="logInsight" style="min-height:60px" placeholder="What did you realize?"></textarea></div>
    <div class="form-group"><label class="form-label">Current Goal</label>
      <input type="text" class="form-input" id="logGoal" placeholder="What are you working toward?"></div>
    <div class="form-group"><label class="form-label">Main Obstacle</label>
      <input type="text" class="form-input" id="logObstacle" placeholder="What's blocking you?"></div>
    <div class="form-group"><label class="form-label">Gratitude</label>
      <input type="text" class="form-input" id="logGratitude" placeholder="3 things you're grateful for..."></div>
    <div class="form-group"><label class="form-label">Recurring Pattern / Observation</label>
      <input type="text" class="form-input" id="logPattern" placeholder="Any recurring themes?"></div>
    <div class="form-group"><label class="form-label">Key Action to Take</label>
      <input type="text" class="form-input" id="logAction" placeholder="One concrete action step"></div>
  </div>

  <button class="btn btn-primary btn-block" onclick="saveLog()" style="margin-bottom:14px">
    ‚ú® <span data-t="save_entry">Save Entry</span>
  </button>

  <div class="card" id="recentLogsCard">
    <div class="card-title"><span class="emoji">üìã</span> Recent Entries</div>
    <div id="recentLogs"></div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     TAB 2 ‚Äî BRAINWAVE AUDIO
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="tab-panel" id="tab-waves">
  <div class="section-header">üéµ Brainwave Audio Lab</div>

  <div class="card">
    <div class="card-title"><span class="emoji">üéß</span> Now Playing</div>
    <div style="text-align:center;margin-bottom:12px">
      <div style="font-size:20px;font-weight:800;font-family:Syne,sans-serif;color:var(--primary)" id="bwNowName">Select a session below</div>
      <div style="font-size:12px;color:var(--text3);margin-top:3px" id="bwNowDesc">Binaural beats & frequencies for mind enhancement</div>
      <div style="font-size:11px;color:var(--accent);margin-top:2px" id="bwNowFreq"></div>
    </div>
    <div class="bw-visualizer" id="bwVisualizer">
      <div style="color:var(--text3);font-size:12px">‚ñ∂ Press Play to begin</div>
    </div>
    <div class="bw-controls">
      <button class="btn btn-secondary btn-sm" onclick="bwPrevTrack()">‚èÆ</button>
      <button class="btn btn-primary" id="bwPlayBtn" onclick="toggleBW()">‚ñ∂ Play</button>
      <button class="btn btn-secondary btn-sm" onclick="bwNextTrack()">‚è≠</button>
      <input type="range" class="bw-vol" id="bwVol" min="0" max="100" value="60" oninput="setBWVol(this.value)" title="Volume">
      <span style="font-size:16px">üîä</span>
      <span class="bw-timer" id="bwTimer">00:00</span>
    </div>

    <div style="font-size:12px;font-weight:700;color:var(--text2);margin-bottom:8px">Wave Type:</div>
    <div class="wave-type-btns">
      <button class="wave-btn active" onclick="setBWType('binaural',this)">üéß Binaural Beats</button>
      <button class="wave-btn" onclick="setBWType('isochronic',this)">üì≥ Isochronic</button>
      <button class="wave-btn" onclick="setBWType('solfeggio',this)">üéµ Solfeggio</button>
      <button class="wave-btn" onclick="setBWType('whitenoise',this)">üåä White Noise</button>
    </div>
    <div style="background:rgba(124,58,237,.08);border-radius:10px;padding:10px;font-size:12px;color:var(--text2);margin-top:8px">
      ‚ö†Ô∏è <strong>Use headphones</strong> for binaural beats to work properly. Each ear needs to hear a slightly different frequency.
    </div>
  </div>

  <div class="card">
    <div class="card-title"><span class="emoji">üß†</span> Brainwave Sessions</div>
    <div class="bw-grid" id="bwGrid"></div>
  </div>

  <div class="card">
    <div class="card-title"><span class="emoji">üìö</span> What Are Brainwaves?</div>
    <div id="bwEducation"></div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     TAB 3 ‚Äî AI HUB
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="tab-panel" id="tab-ai">
  <div class="section-header">ü§ñ AI Hub</div>

  <div class="card">
    <div class="card-title"><span class="emoji">üîÄ</span> Select AI Model</div>
    <div class="ai-models-bar" id="aiModelsBar"></div>
    <div style="font-size:11px;color:var(--text3)">
      üí° Different AI perspectives help reduce bias and give you multiple viewpoints.
    </div>
  </div>

  <div class="card">
    <div class="ai-tip-card" id="aiTipCard">
      üí° <strong>Daily Tip:</strong> <span id="aiDailyTip">Loading your personalized tip...</span>
    </div>
    <div class="chat-controls">
      <button class="btn btn-secondary btn-sm" onclick="clearAIChat()">üóë Clear</button>
      <button class="btn btn-secondary btn-sm" onclick="exportChat()">üíæ Export</button>
      <span style="flex:1"></span>
      <span style="font-size:11px;color:var(--text3)" id="aiStatusLabel">Ready</span>
    </div>
    <div class="chat-messages" id="chatMessages"></div>
    <div class="suggested-qs" id="suggestedQs"></div>
    <div class="chat-input-area">
      <textarea class="chat-input" id="chatInput" placeholder="Ask me anything about your consciousness, health, dreams..." onkeydown="handleChatKey(event)" rows="1"></textarea>
      <button class="btn btn-primary" onclick="sendChat()" id="chatSendBtn">‚û§</button>
    </div>
  </div>

  <div class="card" id="aiInsightsCard">
    <div class="card-title"><span class="emoji">üìä</span> AI Pattern Analysis</div>
    <div id="aiPatternDisplay"></div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     TAB 4 ‚Äî ANALYSIS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="tab-panel" id="tab-analysis">
  <div class="section-header">üìä Analysis Dashboard</div>

  <div class="stats-grid">
    <div class="stat-box"><div class="sv" id="statMood">‚Äî</div><div class="sl">Avg Mood</div></div>
    <div class="stat-box"><div class="sv" id="statFocus">‚Äî</div><div class="sl">Avg Focus</div></div>
    <div class="stat-box"><div class="sv" id="statScore">‚Äî</div><div class="sl">Avg Score</div></div>
    <div class="stat-box"><div class="sv" id="statEntries">0</div><div class="sl">Entries</div></div>
    <div class="stat-box"><div class="sv" id="statFlow">‚Äî</div><div class="sl">Avg Flow</div></div>
    <div class="stat-box"><div class="sv" id="statCreativity">‚Äî</div><div class="sl">Creativity</div></div>
  </div>

  <div class="card">
    <div class="card-title"><span class="emoji">üîÆ</span> Predictions</div>
    <div id="predictionsArea"></div>
  </div>

  <div class="card">
    <div class="card-title"><span class="emoji">üìà</span> Trends (Last 10 vs Previous 10)</div>
    <div id="trendsArea"></div>
  </div>

  <div class="card">
    <div class="card-title"><span class="emoji">üèÜ</span> Personal Records</div>
    <div id="recordsArea"></div>
  </div>

  <div class="card">
    <div class="card-title"><span class="emoji">üß©</span> Pattern Detection</div>
    <div id="patternsArea"></div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     TAB 5 ‚Äî HEALTH PROFILE
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="tab-panel" id="tab-health">
  <div class="section-header">‚ù§Ô∏è Health Profile</div>

  <div class="card">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
      <div style="font-size:13px;font-weight:700;color:var(--text2)">Section <span id="hsCurrent">1</span> of 18</div>
      <div style="font-size:12px;color:var(--text3)" id="hsSectionName">Demographics</div>
    </div>
    <div class="health-progress"><div class="health-progress-bar" id="hsProgressBar" style="width:5.5%"></div></div>
    <div style="font-size:11px;font-weight:700;color:var(--text2);margin-bottom:6px">Jump to section:</div>
    <div class="health-jump-bar" id="healthJumpBar"></div>
  </div>

  <div id="healthSectionsContainer"></div>

  <div class="health-nav-btns">
    <button class="btn btn-secondary" id="hsPrevBtn" onclick="hsPrev()" style="display:none">‚Üê Previous</button>
    <div style="flex:1"></div>
    <button class="btn btn-primary" id="hsNextBtn" onclick="hsNext()">Next ‚Üí</button>
  </div>

  <div class="card" id="aiDoctorCard" style="display:none;margin-top:14px">
    <div class="card-title"><span class="emoji">üë®‚Äç‚öïÔ∏è</span> AI Doctor Analysis</div>
    <div id="aiDoctorOutput"></div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     TAB 6 ‚Äî BRAIN GAMES
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="tab-panel" id="tab-games">
  <div class="section-header">üéÆ Brain Training</div>

  <div class="game-view active" id="gamesMenu">
    <div class="games-grid" id="gamesGrid"></div>
  </div>

  <!-- Game canvases will be injected here by JS -->
  <div id="gameContainer"></div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     TAB 7 ‚Äî LUCID DREAMS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="tab-panel" id="tab-dreams">
  <div class="section-header">üåô Lucid Dreams Lab</div>

  <div class="card">
    <div class="card-title"><span class="emoji">üìñ</span> Log a Dream</div>
    <div class="form-row">
      <div class="form-group"><label class="form-label">Date</label>
        <input type="date" class="form-input" id="dreamDate"></div>
      <div class="form-group"><label class="form-label">Dream Title</label>
        <input type="text" class="form-input" id="dreamTitle" placeholder="Give it a name..."></div>
    </div>
    <div class="form-group"><label class="form-label">Dream Type</label>
      <div class="dream-types">
        <button class="dream-type-btn active" onclick="setDreamType(this,'regular')">Regular</button>
        <button class="dream-type-btn" onclick="setDreamType(this,'lucid')">‚ú® Lucid</button>
        <button class="dream-type-btn" onclick="setDreamType(this,'vivid')">üåà Vivid</button>
        <button class="dream-type-btn" onclick="setDreamType(this,'nightmare')">üò± Nightmare</button>
        <button class="dream-type-btn" onclick="setDreamType(this,'recurring')">üîÑ Recurring</button>
        <button class="dream-type-btn" onclick="setDreamType(this,'prophetic')">üîÆ Prophetic</button>
      </div>
      <input type="hidden" id="dreamType" value="regular">
    </div>
    <div class="form-group"><label class="form-label">Dream Description</label>
      <textarea class="form-textarea" id="dreamDesc" style="min-height:100px" placeholder="Describe your dream in detail ‚Äî environments, characters, events, feelings..."></textarea></div>
    <div class="form-row">
      <div class="form-group"><label class="form-label">Vividness (0‚Äì10)</label>
        <div class="slider-group" style="margin:0">
          <input type="range" class="slider-track" id="dreamVividness" min="0" max="10" value="5" oninput="updateSimpleSlider(this)">
          <div style="text-align:right;font-size:12px;color:var(--primary);font-weight:700" id="dreamVividnessVal">5</div>
        </div></div>
      <div class="form-group"><label class="form-label">Lucidity (0‚Äì10)</label>
        <div class="slider-group" style="margin:0">
          <input type="range" class="slider-track" id="dreamLucidity" min="0" max="10" value="0" oninput="updateSimpleSlider(this)">
          <div style="text-align:right;font-size:12px;color:var(--primary);font-weight:700" id="dreamLucidityVal">0</div>
        </div></div>
    </div>
    <div class="form-group"><label class="form-label">Dream Signs (things that show you're dreaming)</label>
      <input type="text" class="form-input" id="dreamSigns" placeholder="e.g., flying, talking animals, familiar place distorted..."></div>
    <div class="form-group"><label class="form-label">Emotions felt</label>
      <input type="text" class="form-input" id="dreamEmotions" placeholder="e.g., joy, fear, wonder, confusion..."></div>
    <button class="btn btn-primary btn-block" onclick="saveDream()" style="margin-top:6px">üíæ Save Dream</button>
  </div>

  <div class="card">
    <div class="card-title"><span class="emoji">ü§ñ</span> AI Dream Analysis</div>
    <div style="font-size:13px;color:var(--text2);margin-bottom:10px">Save a dream above and get AI-powered analysis of symbols, themes, and lucid dreaming coaching.</div>
    <div id="dreamAIAnalysis">
      <div class="empty-state"><span class="es-icon">üåô</span><div class="es-text">Log a dream to get personalized analysis</div></div>
    </div>
  </div>

  <div class="card">
    <div class="card-title"><span class="emoji">üéØ</span> Lucid Dream Techniques</div>
    <div id="techniquesContainer"></div>
  </div>

  <div class="card">
    <div class="card-title"><span class="emoji">‚úã</span> Reality Check Tracker</div>
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px">
      <div style="font-size:13px;color:var(--text2)">Today's checks: <strong id="rcCount">0</strong> / 15</div>
      <button class="btn btn-secondary btn-sm" onclick="resetRC()">Reset Day</button>
    </div>
    <div class="progress-bar-wrap" style="margin-bottom:12px"><div class="progress-bar-fill" id="rcProgress" style="width:0%"></div></div>
    <div class="reality-check-grid" id="rcGrid"></div>
    <div style="font-size:12px;color:var(--text3);margin-top:10px;line-height:1.5">
      üîë <strong>What are reality checks?</strong> They are habits you do while awake to question if you're dreaming. Do them enough times while awake, and your brain will do them automatically in dreams ‚Äî triggering lucidity.
    </div>
  </div>

  <div class="card">
    <div class="card-title"><span class="emoji">üî¢</span> WBTB Sleep Calculator</div>
    <div class="form-row">
      <div class="form-group"><label class="form-label">Sleep Time</label>
        <input type="time" class="form-input" id="wbtbSleep" value="23:00"></div>
      <div class="form-group"><label class="form-label">Wake Time</label>
        <input type="time" class="form-input" id="wbtbWake" value="07:00"></div>
    </div>
    <button class="btn btn-secondary btn-sm btn-block" onclick="calcWBTB()">Calculate Optimal Times</button>
    <div id="wbtbResult" style="margin-top:10px"></div>
  </div>

  <div class="card">
    <div class="card-title"><span class="emoji">üìã</span> Dream Journal</div>
    <div id="dreamJournal"></div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     TAB 8 ‚Äî VOICE & MEDIA
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="tab-panel" id="tab-media">
  <div class="section-header">üéôÔ∏è Voice & Media Archive</div>

  <div class="card">
    <div class="card-title"><span class="emoji">üéôÔ∏è</span> Voice Recorder</div>
    <div class="recorder-visual" id="recorderBtn" onclick="toggleRecord()">üéôÔ∏è</div>
    <div style="text-align:center;margin-bottom:12px">
      <div style="font-size:14px;font-weight:700;color:var(--text2)" id="recStatus">Tap to Start Recording</div>
      <div style="font-size:12px;color:var(--text3);margin-top:3px" id="recTimer">00:00</div>
    </div>
    <div style="font-size:12px;color:var(--text2);margin-bottom:6px;font-weight:700">Live Transcript:</div>
    <div style="background:var(--bg3);border-radius:10px;padding:10px;min-height:60px;font-size:13px;color:var(--text2);margin-bottom:10px" id="liveTranscript">Speak to see transcript here...</div>
  </div>

  <div class="card">
    <div class="card-title"><span class="emoji">ü§ñ</span> AI Voice Insights</div>
    <div id="voiceAIInsights">
      <div class="empty-state"><span class="es-icon">üéôÔ∏è</span><div class="es-text">Record voice memos to get AI analysis of your patterns and suggestions for what to capture next.</div></div>
    </div>
    <button class="btn btn-secondary btn-sm" onclick="analyzeVoiceMemos()" style="margin-top:8px">üîç Analyze My Recordings</button>
  </div>

  <div class="card">
    <div class="card-title"><span class="emoji">üìº</span> Voice Memos</div>
    <div id="voiceMemos"></div>
  </div>

  <div class="card">
    <div class="card-title"><span class="emoji">üñºÔ∏è</span> Media Upload</div>
    <div onclick="document.getElementById('mediaInput').click()"
         style="border:2px dashed var(--border);border-radius:12px;padding:24px;text-align:center;cursor:pointer;transition:border .2s"
         onmouseenter="this.style.borderColor='var(--primary)'" onmouseleave="this.style.borderColor='var(--border)'">
      <div style="font-size:32px;margin-bottom:6px">üì∏</div>
      <div style="font-size:14px;color:var(--text2)">Tap to upload photos or videos</div>
      <div style="font-size:11px;color:var(--text3);margin-top:3px">Images & videos stored locally on your device</div>
    </div>
    <input type="file" id="mediaInput" accept="image/*,video/*" multiple style="display:none" onchange="uploadMedia(event)">
    <div class="card">
      <div class="card-title"><span class="emoji">ü§ñ</span> AI Media Insights</div>
      <div id="mediaAIInsights">
        <div class="empty-state"><span class="es-icon">üì∏</span><div class="es-text">Upload media to get AI suggestions on what to document for consciousness tracking.</div></div>
      </div>
      <button class="btn btn-secondary btn-sm" onclick="analyzeMedia()" style="margin-top:8px">üîç Analyze My Archive</button>
    </div>
    <div class="media-grid" id="mediaGrid"></div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     TAB 9 ‚Äî CALENDAR & ALARMS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="tab-panel" id="tab-calendar">
  <div class="section-header">üìÖ Calendar & Alarms</div>

  <div class="card">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
      <button class="btn btn-secondary btn-sm" onclick="calNav(-1)">‚óÄ</button>
      <div style="font-weight:800;font-family:Syne,sans-serif;font-size:17px" id="calTitle"></div>
      <button class="btn btn-secondary btn-sm" onclick="calNav(1)">‚ñ∂</button>
    </div>
    <div class="cal-grid" id="calGrid"></div>
  </div>

  <div class="card">
    <div class="card-title"><span class="emoji">‚è∞</span> Alarms & Reminders</div>
    <div class="form-row">
      <div class="form-group"><label class="form-label">Label</label>
        <input type="text" class="form-input" id="alarmLabel" placeholder="e.g., Reality Check, Meditation..."></div>
      <div class="form-group"><label class="form-label">Time</label>
        <input type="time" class="form-input" id="alarmTime"></div>
    </div>
    <div class="form-row">
      <div class="form-group"><label class="form-label">Sound</label>
        <select class="form-select" id="alarmSound">
          <option value="bell">üîî Bell</option>
          <option value="chime">üéµ Chime</option>
          <option value="pulse">üì≥ Pulse</option>
          <option value="om">üïâÔ∏è Om</option>
          <option value="birds">üê¶ Birds</option>
        </select></div>
      <div class="form-group"><label class="form-label">Repeat</label>
        <select class="form-select" id="alarmRepeat">
          <option value="once">Once</option>
          <option value="daily">Daily</option>
          <option value="weekdays">Weekdays</option>
          <option value="weekends">Weekends</option>
        </select></div>
    </div>
    <button class="btn btn-primary btn-sm btn-block" onclick="addAlarm()" style="margin-bottom:12px">+ Add Alarm</button>
    <div id="alarmsList"></div>
    <div style="font-size:11px;color:var(--text3);margin-top:8px;text-align:center">
      ‚ÑπÔ∏è Allow notifications when prompted for alarms to work. Alarms work when app is open in browser.
    </div>
  </div>

  <div class="card">
    <div class="card-title"><span class="emoji">üìù</span> Reminders</div>
    <div class="form-row">
      <div class="form-group"><label class="form-label">Reminder</label>
        <input type="text" class="form-input" id="reminderText" placeholder="Reminder text"></div>
      <div class="form-group"><label class="form-label">Date & Time</label>
        <input type="datetime-local" class="form-input" id="reminderDateTime"></div>
    </div>
    <button class="btn btn-secondary btn-sm" onclick="addReminder()">+ Add Reminder</button>
    <div id="remindersList" style="margin-top:10px"></div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     TAB 10 ‚Äî SETTINGS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="tab-panel" id="tab-settings">
  <div class="section-header">‚öôÔ∏è Settings</div>

  <div class="card">
    <div class="card-title"><span class="emoji">üé®</span> Appearance</div>
    <div class="setting-item">
      <div class="setting-info">
        <div class="setting-title">Dark Mode</div>
        <div class="setting-desc">Switch to dark theme for night use and reduced eye strain</div>
        <span class="setting-help" onclick="showSettingHelp('darkmode')">‚ùì What does this do?</span>
      </div>
      <div class="toggle" id="settingDark" onclick="toggleTheme()"></div>
    </div>
    <div class="setting-item">
      <div class="setting-info">
        <div class="setting-title">App Language</div>
        <div class="setting-desc">Choose your preferred language for the interface</div>
      </div>
      <select class="lang-sel" onchange="setLang(this.value)" id="settingLang">
        <option value="en">English</option>
        <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
        <option value="es">Espa√±ol</option>
        <option value="fr">Fran√ßais</option>
        <option value="de">Deutsch</option>
        <option value="pt">Portugu√™s</option>
        <option value="zh">‰∏≠Êñá</option>
        <option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
        <option value="ja">Êó•Êú¨Ë™û</option>
        <option value="ru">–†—É—Å—Å–∫–∏–π</option>
      </select>
    </div>
    <div class="setting-item">
      <div class="setting-info">
        <div class="setting-title">Show Slider Anchors</div>
        <div class="setting-desc">Show detailed descriptions for each slider value</div>
        <span class="setting-help" onclick="showSettingHelp('anchors')">‚ùì What does this do?</span>
      </div>
      <div class="toggle on" id="settingAnchors" onclick="toggleSetting('anchors')"></div>
    </div>
  </div>

  <div class="card">
    <div class="card-title"><span class="emoji">üîî</span> Notifications</div>
    <div class="setting-item">
      <div class="setting-info">
        <div class="setting-title">Enable Notifications</div>
        <div class="setting-desc">Allow alarms and reminders to notify you</div>
        <span class="setting-help" onclick="showSettingHelp('notif')">‚ùì What does this do?</span>
      </div>
      <div class="toggle" id="settingNotif" onclick="requestNotifPermission()"></div>
    </div>
    <div class="setting-item">
      <div class="setting-info">
        <div class="setting-title">Daily Log Reminder</div>
        <div class="setting-desc">Remind you to fill your consciousness log each day</div>
      </div>
      <div class="toggle" id="settingDailyReminder" onclick="toggleSetting('dailyReminder')"></div>
    </div>
    <div class="setting-item">
      <div class="setting-info">
        <div class="setting-title">Reality Check Alerts</div>
        <div class="setting-desc">Periodic reminders to do reality checks (every 2hrs)</div>
        <span class="setting-help" onclick="showSettingHelp('rc')">‚ùì What does this do?</span>
      </div>
      <div class="toggle" id="settingRC" onclick="toggleSetting('rc')"></div>
    </div>
  </div>

  <div class="card">
    <div class="card-title"><span class="emoji">üß†</span> AI Settings</div>
    <div class="setting-item">
      <div class="setting-info">
        <div class="setting-title">Auto-analyze on Save</div>
        <div class="setting-desc">Automatically generate AI insights when you save a log entry</div>
      </div>
      <div class="toggle on" id="settingAutoAnalyze" onclick="toggleSetting('autoAnalyze')"></div>
    </div>
    <div class="setting-item">
      <div class="setting-info">
        <div class="setting-title">Conversational AI Mode</div>
        <div class="setting-desc">AI checks in on your day with friendly questions</div>
      </div>
      <div class="toggle on" id="settingConvMode" onclick="toggleSetting('convMode')"></div>
    </div>
    <div class="setting-item">
      <div class="setting-info">
        <div class="setting-title">Auto-transcribe Voice</div>
        <div class="setting-desc">Automatically convert speech to text when recording</div>
      </div>
      <div class="toggle on" id="settingAutoTranscribe" onclick="toggleSetting('autoTranscribe')"></div>
    </div>
    <div class="setting-item">
      <div class="setting-info">
        <div class="setting-title">AI Prompt Enhancement</div>
        <div class="setting-desc">AI automatically improves your questions for better answers</div>
        <span class="setting-help" onclick="showSettingHelp('promptboost')">‚ùì What does this do?</span>
      </div>
      <div class="toggle" id="settingPromptBoost" onclick="toggleSetting('promptBoost')"></div>
    </div>
  </div>

  <div class="card">
    <div class="card-title"><span class="emoji">üóÑÔ∏è</span> Data Management</div>
    <button class="btn btn-secondary btn-block" onclick="exportData()" style="margin-bottom:8px">üì§ Export All Data (JSON)</button>
    <button class="btn btn-secondary btn-block" onclick="document.getElementById('importFile').click()" style="margin-bottom:8px">üì• Import Data</button>
    <input type="file" id="importFile" accept=".json" style="display:none" onchange="importData(event)">
    <button class="btn btn-danger btn-block" onclick="clearAllData()">üóë Clear All Data</button>
    <div style="font-size:11px;color:var(--text3);text-align:center;margin-top:10px">All data is stored locally on your device only. Nothing is sent to servers.</div>
  </div>

  <div class="card">
    <div class="card-title"><span class="emoji">‚ÑπÔ∏è</span> About</div>
    <div style="text-align:center">
      <div style="font-size:32px;margin-bottom:8px">üß†</div>
      <div style="font-family:Syne,sans-serif;font-weight:800;font-size:18px;margin-bottom:4px">Consciousness OS</div>
      <div style="font-size:13px;color:var(--text3);margin-bottom:12px">Version 6.0 ¬∑ Local-first ¬∑ Privacy-first</div>
      <div style="font-size:12px;color:var(--text2);line-height:1.6">Your personal mind enhancement and consciousness tracking system. All data stays on your device.</div>
    </div>
  </div>
</div>


<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     TAB 11 ‚Äî WORLD INTELLIGENCE
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="tab-panel" id="tab-world">
  <div class="section-header">üåç World Intelligence Panel</div>

  <div class="world-nav">
    <button class="world-nav-btn active" onclick="switchWorld('geopolitics',this)">üó∫Ô∏è Geopolitics</button>
    <button class="world-nav-btn" onclick="switchWorld('markets',this)">üìà Markets</button>
    <button class="world-nav-btn" onclick="switchWorld('commodities',this)">üõ¢Ô∏è Commodities</button>
    <button class="world-nav-btn" onclick="switchWorld('crypto',this)">‚Çø Crypto</button>
    <button class="world-nav-btn" onclick="switchWorld('rates',this)">üè¶ Rates</button>
  </div>

  <!-- AI Ask Box -->
  <div class="card">
    <div class="card-title"><span class="emoji">ü§ñ</span> 8D World Chess AI</div>
    <div style="font-size:13px;color:var(--text2);margin-bottom:8px">Ask any question about how world forces connect. Understand causal chains.</div>
    <div class="ai-ask-box">
      <div style="font-size:12px;font-weight:700;color:var(--text2);margin-bottom:6px">Try asking:</div>
      <div style="display:flex;gap:6px;flex-wrap:wrap;margin-bottom:8px">
        <span class="chip" onclick="setWorldQ('Will war increase gold price?')" style="cursor:pointer">Will war increase gold?</span>
        <span class="chip" onclick="setWorldQ('How does Fed rate hike affect crypto?')" style="cursor:pointer">Fed rates ‚Üí crypto?</span>
        <span class="chip" onclick="setWorldQ('What happens to markets if China invades Taiwan?')" style="cursor:pointer">China Taiwan ‚Üí markets?</span>
        <span class="chip" onclick="setWorldQ('Oil price rise ‚Üí inflation chain')" style="cursor:pointer">Oil ‚Üí inflation chain</span>
      </div>
      <div class="ai-ask-row">
        <input type="text" class="form-input" id="worldAskInput" placeholder="Ask about any geopolitical or economic force...">
        <button class="btn btn-primary btn-sm" onclick="askWorldAI()">üîç Analyze</button>
      </div>
    </div>
    <div id="worldAIResult" style="margin-top:10px"></div>
  </div>

  <!-- Geopolitics Panel -->
  <div class="world-panel active" id="wp-geopolitics">
    <div class="card">
      <div class="card-title"><span class="emoji">üó∫Ô∏è</span> Live Geopolitical Events</div>
      <div id="geoEventsList"></div>
    </div>
    <div class="card">
      <div class="card-title"><span class="emoji">üîó</span> Geopolitics ‚Üí Markets Links</div>
      <div id="geoMarketLinks"></div>
    </div>
  </div>

  <!-- Markets Panel -->
  <div class="world-panel" id="wp-markets">
    <div class="card">
      <div class="card-title"><span class="emoji">üìà</span> Key Market Indicators</div>
      <div id="marketsDisplay"></div>
    </div>
  </div>

  <!-- Commodities Panel -->
  <div class="world-panel" id="wp-commodities">
    <div class="card">
      <div class="card-title"><span class="emoji">üõ¢Ô∏è</span> Commodities Cycle Tracker</div>
      <div id="commoditiesDisplay"></div>
    </div>
    <div class="card">
      <div class="card-title"><span class="emoji">üìä</span> Commodities Cycle Phase</div>
      <div id="commoditiesCycle"></div>
    </div>
  </div>

  <!-- Crypto Panel -->
  <div class="world-panel" id="wp-crypto">
    <div class="card">
      <div class="card-title"><span class="emoji">‚Çø</span> Crypto Dynamics</div>
      <div id="cryptoDisplay"></div>
    </div>
    <div class="card">
      <div class="card-title"><span class="emoji">üîÑ</span> Market Cycle Phase</div>
      <div id="cryptoCycle"></div>
    </div>
  </div>

  <!-- Interest Rates Panel -->
  <div class="world-panel" id="wp-rates">
    <div class="card">
      <div class="card-title"><span class="emoji">üè¶</span> Central Bank Rates & Inflation</div>
      <div id="ratesDisplay"></div>
    </div>
    <div class="card">
      <div class="card-title"><span class="emoji">üí°</span> Rate Impact on Your Wealth</div>
      <div id="ratesImpact"></div>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     TAB 12 ‚Äî PATH (COMPREHENSIVE STUDY & CAREER AI)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="tab-panel" id="tab-path">
  <div class="section-header">üéì Study & Career Intelligence</div>

  <div class="card">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
      <div style="font-size:13px;font-weight:700;color:var(--text2)">Section <span id="studySectionNum">1</span> of 18</div>
      <div style="font-size:11px;color:var(--text3)" id="studySectionName">Identity & Academic Context</div>
    </div>
    <div class="study-progress"><div class="study-progress-bar" id="studyProgressBar" style="width:5.5%"></div></div>
    <div style="font-size:11px;font-weight:700;color:var(--text2);margin-bottom:6px">Jump to section:</div>
    <div class="study-jump-bar" id="studyJumpBar"></div>
  </div>

  <div id="studySectionsContainer"></div>

  <div style="display:flex;justify-content:space-between;margin-top:4px;margin-bottom:14px">
    <button class="btn btn-secondary" id="studyPrevBtn" onclick="studyPrev()" style="display:none">‚Üê Previous</button>
    <div style="flex:1"></div>
    <button class="btn btn-primary" id="studyNextBtn" onclick="studyNext()">Next ‚Üí</button>
  </div>

  <div id="studyResultContainer"></div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     TAB 13 ‚Äî SCIENCE (FRONTIER INTELLIGENCE)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="tab-panel" id="tab-science">
  <div class="section-header">üî¨ Frontier Intelligence Feed</div>

  <div class="science-nav">
    <button class="science-cat-btn active" onclick="switchSciCat('all',this)">üåê All</button>
    <button class="science-cat-btn" onclick="switchSciCat('neuro',this)">üß† Neuro</button>
    <button class="science-cat-btn" onclick="switchSciCat('ai',this)">ü§ñ AI</button>
    <button class="science-cat-btn" onclick="switchSciCat('physics',this)">‚öõÔ∏è Physics</button>
    <button class="science-cat-btn" onclick="switchSciCat('longevity',this)">üß¨ Longevity</button>
    <button class="science-cat-btn" onclick="switchSciCat('space',this)">üöÄ Space</button>
    <button class="science-cat-btn" onclick="switchSciCat('biotech',this)">üî≠ Biotech</button>
  </div>

  <div class="card">
    <div class="card-title"><span class="emoji">üí°</span> Super Facts ‚Äî Reality Expanders</div>
    <div id="superFactsDisplay"></div>
  </div>

  <div id="discoveriesDisplay"></div>

  <div class="card">
    <div class="card-title"><span class="emoji">ü§ñ</span> Ask Science AI</div>
    <div class="ai-ask-row">
      <input type="text" class="form-input" id="scienceAskInput" placeholder="Ask anything about frontier science...">
      <button class="btn btn-accent btn-sm" onclick="askScienceAI()">Explain</button>
    </div>
    <div id="scienceAIResult" style="margin-top:10px"></div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     TAB 14 ‚Äî SYSTEM (THEMES / ACCOUNT / LEGAL)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="tab-panel" id="tab-system">
  <div class="section-header">‚öôÔ∏è System Control</div>

  <div class="sys-tab-row">
    <button class="sys-tab-btn active" onclick="switchSysTab('themes',this)">üé® Themes</button>
    <button class="sys-tab-btn" onclick="switchSysTab('account',this)">üë§ Account</button>
    <button class="sys-tab-btn" onclick="switchSysTab('guide',this)">üìñ Guide</button>
    <button class="sys-tab-btn" onclick="switchSysTab('legal',this)">‚öñÔ∏è Legal</button>
    <button class="sys-tab-btn" onclick="switchSysTab('tracking',this)">üì° Telemetry</button>
  </div>

  <!-- THEMES -->
  <div class="sys-panel active" id="sysp-themes">
    <div class="card">
      <div class="card-title"><span class="emoji">üé®</span> Theme Engine</div>
      <div class="theme-grid" id="themeGrid"></div>
      <div style="font-size:12px;color:var(--text3);text-align:center">Theme changes background, accents, glow, and typography tone for full immersion</div>
    </div>
    <div class="card">
      <div class="card-title"><span class="emoji">üåô</span> Quick Toggles</div>
      <div class="setting-item">
        <div class="setting-info">
          <div class="setting-title">Dark Mode</div>
          <div class="setting-desc">Switch to dark for night use</div>
        </div>
        <div class="toggle" id="sys-darkToggle" onclick="toggleTheme();updateSysToggle()"></div>
      </div>
    </div>
  </div>

  <!-- ACCOUNT -->
  <div class="sys-panel" id="sysp-account">
    <div class="card">
      <div class="card-title"><span class="emoji">üë§</span> Identity Layer</div>
      <div style="font-size:13px;color:var(--text2);margin-bottom:14px;line-height:1.6">Sign in for cross-device cognition history, identity modeling, and personalized AI.</div>
      <div class="account-options">
        <div class="account-option" onclick="signInGoogle()">
          <div class="ao-icon">üîµ</div>
          <div><div class="ao-title">Continue with Google</div><div class="ao-desc">Sync across devices, cloud backup</div></div>
        </div>
        <div class="account-option" onclick="signInLocal()">
          <div class="ao-icon">üîí</div>
          <div><div class="ao-title">Stay Local (Private)</div><div class="ao-desc">No account, all data on device only</div></div>
        </div>
      </div>
      <div id="accountStatus" style="margin-top:14px;font-size:13px;color:var(--text3);text-align:center">Currently in local mode ¬∑ Data stays on your device</div>
    </div>
    <div class="card">
      <div class="card-title"><span class="emoji">üåê</span> Language System</div>
      <div class="form-group">
        <label class="form-label">Interface Language</label>
        <select class="form-select" onchange="setLang(this.value)" id="sysLangSel">
          <option value="en">üåê English</option>
          <option value="hi">üáÆüá≥ ‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
          <option value="es">üá™üá∏ Espa√±ol</option>
          <option value="fr">üá´üá∑ Fran√ßais</option>
          <option value="de">üá©üá™ Deutsch</option>
          <option value="pt">üáßüá∑ Portugu√™s</option>
          <option value="zh">üá®üá≥ ‰∏≠Êñá</option>
          <option value="ar">üá∏üá¶ ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
          <option value="ja">üáØüáµ Êó•Êú¨Ë™û</option>
          <option value="ru">üá∑üá∫ –†—É—Å—Å–∫–∏–π</option>
        </select>
      </div>
    </div>
  </div>

  <!-- GUIDE -->
  <div class="sys-panel" id="sysp-guide">
    <div class="consciousness-guide-card">
      <div style="font-size:32px;text-align:center;margin-bottom:10px">üß†</div>
      <div style="font-family:Syne,sans-serif;font-size:18px;font-weight:800;text-align:center;margin-bottom:6px">What is Consciousness OS?</div>
      <div style="font-size:13px;color:var(--text2);text-align:center;line-height:1.6;margin-bottom:16px">Consciousness OS helps users observe and shape cognitive states. It's your personal system for engineering your inner reality.</div>
    </div>

    <div class="card">
      <div class="card-title"><span class="emoji">üîç</span> The Fundamental Question</div>
      <div class="guide-section">
        <p style="font-size:14px;font-style:italic;color:var(--primary);line-height:1.7">"If my thoughts are mine, my body is mine, my brain is mine ‚Äî then what is 'me'?"</p>
      </div>
      <div class="guide-section">
        <h3>Observer vs Processes</h3>
        <p>Your thoughts, emotions, and sensations are processes ‚Äî like weather passing through. The 'me' is the sky that holds them. You are the observer, not the observed.</p>
      </div>
      <div class="guide-section">
        <h3>Cognition vs Identity</h3>
        <p>Cognition is the mechanism ‚Äî how your brain processes information. Identity is the story you tell about what those processes mean. Consciousness OS helps you see both separately.</p>
      </div>
      <div class="guide-section">
        <h3>States vs Self</h3>
        <p>A low mood state is not who you are ‚Äî it's a temporary configuration of your system. By tracking states, you learn to navigate rather than be defined by them.</p>
      </div>
      <div class="guide-section">
        <h3>The Awareness Layer</h3>
        <p>Pure awareness is the layer that knows all your states, but is none of them. This app trains you to access that layer ‚Äî the meta-cognitive observer that gives you real freedom.</p>
      </div>
    </div>

    <div class="card">
      <div class="card-title"><span class="emoji">üó∫Ô∏è</span> Feature Guide</div>
      <div id="featureGuideList"></div>
    </div>
  </div>

  <!-- LEGAL -->
  <div class="sys-panel" id="sysp-legal">
    <div class="card">
      <div class="card-title"><span class="emoji">‚öñÔ∏è</span> Legal & Policy</div>
      <div id="legalItemsList"></div>
    </div>
  </div>

  <!-- PASSIVE TELEMETRY -->
  <div class="sys-panel" id="sysp-tracking">
    <div class="card">
      <div class="card-title"><span class="emoji">üì°</span> Passive Cognition Telemetry</div>
      <div style="font-size:12px;color:var(--text3);margin-bottom:12px">Auto-tracked signals from your app behavior ‚Äî no manual input needed.</div>
      <div class="telemetry-grid" id="telemetryGrid"></div>
    </div>
    <div class="card">
      <div class="card-title"><span class="emoji">üîó</span> Detected Correlations</div>
      <div id="correlationsList"></div>
    </div>
    <div class="card">
      <div class="card-title"><span class="emoji">üìä</span> Interaction Speed History</div>
      <div style="font-size:13px;color:var(--text2)">Session response speed tracked over last 7 days. Slower = lower cognition. Faster = higher engagement.</div>
      <div id="speedHistory" style="margin-top:10px"></div>
    </div>
  </div>
</div>

</div><!-- /.main -->

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     BOTTOM NAVIGATION
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="bottom-nav" id="bottomNav"></div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     FOOTER (accessible from settings)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     TOAST
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="toast" id="toast"></div>

<!-- ‚ïê‚ïê‚ïê‚ïê NEWS DETAIL OVERLAY ‚ïê‚ïê‚ïê‚ïê -->
<div class="news-detail-overlay" id="newsDetailOverlay">
  <div class="news-detail-card">
    <div class="news-detail-header">
      <div>
        <div id="newsDetailCat" style="font-size:11px;font-weight:700;color:var(--accent);text-transform:uppercase;margin-bottom:6px"></div>
        <div id="newsDetailTitle" style="font-family:Syne,sans-serif;font-weight:800;font-size:20px;line-height:1.3"></div>
      </div>
      <button class="news-detail-close" onclick="closeNewsDetail()">‚úï</button>
    </div>
    <div id="newsDetailBody" class="news-detail-body"></div>
    <div style="margin-top:16px;padding-top:16px;border-top:1px solid var(--border)">
      <div style="font-size:12px;font-weight:700;color:var(--text2);margin-bottom:8px">ü§ñ AI Analysis: Ask about this story</div>
      <div style="display:flex;gap:8px">
        <input type="text" class="form-input" id="newsAskInput" placeholder="What are the implications? How does this affect me?">
        <button class="btn btn-primary btn-sm" onclick="askAboutNews()">Ask AI</button>
      </div>
      <div id="newsAIResponse" style="margin-top:10px"></div>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     MODALS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="modal-overlay" id="modalOverlay" onclick="closeModal(event)">
  <div class="modal" id="modal">
    <div class="modal-header">
      <div class="modal-title" id="modalTitle"></div>
      <button class="modal-close" onclick="closeAllModals()">‚úï</button>
    </div>
    <div id="modalBody"></div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     ONBOARDING
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="onboard-overlay" id="onboardOverlay" style="display:none">
  <div class="onboard-card">
    <div class="onboard-dots" id="onboardDots"></div>

    <div class="onboard-step active" id="oStep0">
      <span class="onboard-icon">üß†</span>
      <div class="onboard-title">Consciousness OS v6</div>
      <div class="onboard-text">Your complete mind enhancement and consciousness tracking system. Track 20+ dimensions of your consciousness, train your brain, and optimize your performance.</div>
      <div class="onboard-features">
        <div class="of-item"><div class="of-icon">üìù</div><div class="of-name">Daily Log</div></div>
        <div class="of-item"><div class="of-icon">üéµ</div><div class="of-name">Brainwave Audio</div></div>
        <div class="of-item"><div class="of-icon">ü§ñ</div><div class="of-name">AI Hub</div></div>
        <div class="of-item"><div class="of-icon">üìä</div><div class="of-name">Analysis</div></div>
        <div class="of-item"><div class="of-icon">‚ù§Ô∏è</div><div class="of-name">Health Profile</div></div>
        <div class="of-item"><div class="of-icon">üéÆ</div><div class="of-name">Brain Games</div></div>
        <div class="of-item"><div class="of-icon">üåô</div><div class="of-name">Lucid Dreams</div></div>
        <div class="of-item"><div class="of-icon">üéôÔ∏è</div><div class="of-name">Voice Archive</div></div>
      </div>
    </div>

    <div class="onboard-step" id="oStep1">
      <span class="onboard-icon">üìù</span>
      <div class="onboard-title">Daily Consciousness Log</div>
      <div class="onboard-text">Track 20 dimensions of your mind every day ‚Äî mood, focus, creativity, flow, and more. Visual dot sliders make rating easy and intuitive. Your AI twin learns your patterns over time.</div>
    </div>

    <div class="onboard-step" id="oStep2">
      <span class="onboard-icon">üéµ</span>
      <div class="onboard-title">Brainwave Audio Lab</div>
      <div class="onboard-text">Listen to binaural beats, isochronic tones, and solfeggio frequencies to shift your brain into optimal states for focus, creativity, sleep, and meditation. Use with headphones for best results.</div>
    </div>

    <div class="onboard-step" id="oStep3">
      <span class="onboard-icon">ü§ñ</span>
      <div class="onboard-title">Multi-AI Hub</div>
      <div class="onboard-text">Chat with different AI personalities that analyze your consciousness data. Get personalized tips, pattern analysis, and insights. Multiple AI perspectives for well-rounded answers.</div>
    </div>

    <div class="onboard-step" id="oStep4">
      <span class="onboard-icon">üåô</span>
      <div class="onboard-title">Lucid Dreaming Lab</div>
      <div class="onboard-text">Track your dreams, learn lucid dreaming techniques with simple explanations, do reality checks, and get AI analysis of your dream patterns and symbols.</div>
    </div>

    <div class="onboard-step" id="oStep5">
      <span class="onboard-icon">‚ú®</span>
      <div class="onboard-title">You're Ready!</div>
      <div class="onboard-text">Start by filling your first Daily Log to establish your baseline. The more you log, the smarter your AI becomes. You can always revisit this guide with the ‚ùì button.</div>
    </div>

    <div class="onboard-nav">
      <button class="btn btn-secondary btn-sm" id="oBtnPrev" onclick="onboardNav(-1)" style="display:none">‚Üê Back</button>
      <div style="flex:1"></div>
      <button class="btn btn-secondary btn-sm" onclick="closeOnboarding()">Skip</button>
      <button class="btn btn-primary btn-sm" id="oBtnNext" onclick="onboardNav(1)">Next ‚Üí</button>
    </div>
  </div>
</div>

<!-- Setting help modal -->
<div class="modal-overlay" id="settingHelpOverlay" onclick="this.classList.remove('open')">
  <div class="modal" style="max-width:360px">
    <div class="modal-header">
      <div class="modal-title" id="settingHelpTitle"></div>
      <button class="modal-close" onclick="document.getElementById('settingHelpOverlay').classList.remove('open')">‚úï</button>
    </div>
    <div id="settingHelpBody" style="font-size:14px;color:var(--text2);line-height:1.6"></div>
  </div>
</div>
<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CONSCIOUSNESS OS v6.0 ‚Äî JAVASCRIPT ENGINE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

// ‚îÄ‚îÄ‚îÄ TRANSLATIONS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const LANGS = {
  en:{
    // Nav
    nav_log:"Log",nav_waves:"Waves",nav_ai:"AI Hub",nav_analysis:"Analysis",nav_health:"Health",
    nav_games:"Games",nav_dreams:"Dreams",nav_media:"Media",nav_calendar:"Calendar",
    nav_settings:"Settings",nav_world:"World",nav_path:"Path",nav_science:"Science",nav_system:"System",
    // Daily Log
    daily_log:"Daily Consciousness Log",entry_info:"Entry Info",date:"Date",time_of_day:"Time of Day",
    activity:"Activity",consciousness_metrics:"Consciousness Metrics",save_entry:"Save Entry",
    inner_state:"Inner State",reflections:"Reflections",recent_entries:"Recent Entries",
    raw_thoughts:"Raw Thoughts / Stream of Consciousness",key_insight:"Key Insight Today",
    current_goal:"Current Goal",main_obstacle:"Main Obstacle",gratitude:"Gratitude",
    recurring_pattern:"Recurring Pattern / Observation",key_action:"Key Action to Take",
    brainwave_state:"Brainwave State",dominant_emotion:"Dominant Emotion",physical_sensation:"Physical Sensation",
    // Sections
    brainwave_audio:"Brainwave Audio Lab",now_playing:"Now Playing",brainwave_sessions:"Brainwave Sessions",
    what_are_brainwaves:"What Are Brainwaves?",select_ai_model:"Select AI Model",daily_tip:"Daily Tip",
    ai_pattern:"AI Pattern Analysis",analysis_dashboard:"Analysis Dashboard",predictions:"Predictions",
    trends:"Trends (Last 10 vs Previous 10)",personal_records:"Personal Records",pattern_detection:"Pattern Detection",
    health_profile:"Health Profile",brain_training:"Brain Training",lucid_dreams:"Lucid Dreams Lab",
    log_dream:"Log a Dream",ai_dream:"AI Dream Analysis",lucid_techniques:"Lucid Dream Techniques",
    reality_check:"Reality Check Tracker",voice_media:"Voice & Media Archive",voice_recorder:"Voice Recorder",
    ai_voice:"AI Voice Insights",voice_memos:"Voice Memos",media_upload:"Media Upload",
    calendar_alarms:"Calendar & Alarms",alarms_reminders:"Alarms & Reminders",reminders:"Reminders",
    settings:"Settings",appearance:"Appearance",dark_mode:"Dark Mode",app_language:"App Language",
    notifications:"Notifications",ai_settings:"AI Settings",data_management:"Data Management",
    about:"About",world_intel:"World Intelligence Panel",cognitive_path:"Study & Career Intelligence",
    frontier_science:"Frontier Intelligence Feed",system_control:"System Control",
    // Buttons
    save:"Save",cancel:"Cancel",close:"Close",next:"Next",previous:"Previous",back:"Back",
    play:"Play",pause:"Pause",analyze:"Analyze",generate:"Generate",export:"Export",import:"Import",
    clear:"Clear",add:"Add",delete:"Delete",reset:"Reset",start:"Start",stop:"Stop",
    // Status
    saved:"Entry saved!",cleared:"All cleared",loading:"Loading...",analyzing:"Analyzing...",
    tap_record:"Tap to Start Recording",live_transcript:"Live Transcript",
    // Time
    morning:"Morning",afternoon:"Afternoon",evening:"Evening",night:"Night",
    // Misc
    version:"Version",privacy:"Privacy",local_mode:"Local mode ‚Äî all data on your device",
    no_entries:"No entries yet",log_first:"Log your first entry to see analysis",
    theme_engine:"Theme Engine",account_identity:"Identity Layer",consciousness_guide:"Consciousness Guide",
    legal_policy:"Legal & Policy",passive_telemetry:"Passive Cognition Telemetry",
    deep_work:"Deep Work",exercise:"Exercise",rest:"Rest",social:"Social",learning:"Learning",
    creative:"Creative",meditation:"Meditation",entertainment:"Entertainment",
  },
  hi:{
    nav_log:"‡§≤‡•â‡§ó",nav_waves:"‡§§‡§∞‡§Ç‡§ó‡•á‡§Ç",nav_ai:"AI ‡§π‡§¨",nav_analysis:"‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£",nav_health:"‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø",
    nav_games:"‡§ñ‡•á‡§≤",nav_dreams:"‡§∏‡§™‡§®‡•á",nav_media:"‡§Æ‡•Ä‡§°‡§ø‡§Ø‡§æ",nav_calendar:"‡§ï‡•à‡§≤‡•á‡§Ç‡§°‡§∞",
    nav_settings:"‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏",nav_world:"‡§¶‡•Å‡§®‡§ø‡§Ø‡§æ",nav_path:"‡§™‡§•",nav_science:"‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§®",nav_system:"‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ",
    daily_log:"‡§¶‡•à‡§®‡§ø‡§ï ‡§ö‡•á‡§§‡§®‡§æ ‡§≤‡•â‡§ó",entry_info:"‡§™‡•ç‡§∞‡§µ‡§ø‡§∑‡•ç‡§ü‡§ø ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä",date:"‡§§‡§æ‡§∞‡•Ä‡§ñ",time_of_day:"‡§¶‡§ø‡§® ‡§ï‡§æ ‡§∏‡§Æ‡§Ø",
    activity:"‡§ó‡§§‡§ø‡§µ‡§ø‡§ß‡§ø",consciousness_metrics:"‡§ö‡•á‡§§‡§®‡§æ ‡§Æ‡•á‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏",save_entry:"‡§∏‡§π‡•á‡§ú‡•á‡§Ç",
    inner_state:"‡§Ü‡§Ç‡§§‡§∞‡§ø‡§ï ‡§Ö‡§µ‡§∏‡•ç‡§•‡§æ",reflections:"‡§µ‡§ø‡§ö‡§æ‡§∞",recent_entries:"‡§π‡§æ‡§≤ ‡§ï‡•Ä ‡§™‡•ç‡§∞‡§µ‡§ø‡§∑‡•ç‡§ü‡§ø‡§Ø‡§æ‡§Ç",
    raw_thoughts:"‡§ï‡§ö‡•ç‡§ö‡•á ‡§µ‡§ø‡§ö‡§æ‡§∞ / ‡§ö‡•á‡§§‡§®‡§æ ‡§ß‡§æ‡§∞‡§æ",key_insight:"‡§Ü‡§ú ‡§ï‡•Ä ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§Ö‡§Ç‡§§‡§∞‡•ç‡§¶‡•É‡§∑‡•ç‡§ü‡§ø",
    current_goal:"‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§≤‡§ï‡•ç‡§∑‡•ç‡§Ø",main_obstacle:"‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§¨‡§æ‡§ß‡§æ",gratitude:"‡§ï‡•É‡§§‡§ú‡•ç‡§û‡§§‡§æ",
    recurring_pattern:"‡§¨‡§æ‡§∞-‡§¨‡§æ‡§∞ ‡§¶‡•ã‡§π‡§∞‡§æ‡§®‡•á ‡§µ‡§æ‡§≤‡§æ ‡§™‡•à‡§ü‡§∞‡•ç‡§®",key_action:"‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§ï‡§æ‡§∞‡•ç‡§Ø",
    brainwave_state:"‡§Æ‡§∏‡•ç‡§§‡§ø‡§∑‡•ç‡§ï ‡§§‡§∞‡§Ç‡§ó ‡§Ö‡§µ‡§∏‡•ç‡§•‡§æ",dominant_emotion:"‡§™‡•ç‡§∞‡§Æ‡•Å‡§ñ ‡§≠‡§æ‡§µ‡§®‡§æ",physical_sensation:"‡§∂‡§æ‡§∞‡•Ä‡§∞‡§ø‡§ï ‡§Ö‡§®‡•Å‡§≠‡§µ",
    brainwave_audio:"‡§Æ‡§∏‡•ç‡§§‡§ø‡§∑‡•ç‡§ï ‡§§‡§∞‡§Ç‡§ó ‡§ë‡§°‡§ø‡§Ø‡•ã ‡§≤‡•à‡§¨",now_playing:"‡§Ö‡§≠‡•Ä ‡§ö‡§≤ ‡§∞‡§π‡§æ ‡§π‡•à",brainwave_sessions:"‡§∏‡§§‡•ç‡§∞",
    what_are_brainwaves:"‡§Æ‡§∏‡•ç‡§§‡§ø‡§∑‡•ç‡§ï ‡§§‡§∞‡§Ç‡§ó‡•á‡§Ç ‡§ï‡•ç‡§Ø‡§æ ‡§π‡•à‡§Ç?",select_ai_model:"AI ‡§Æ‡•â‡§°‡§≤ ‡§ö‡•Å‡§®‡•á‡§Ç",daily_tip:"‡§¶‡•à‡§®‡§ø‡§ï ‡§ü‡§ø‡§™",
    ai_pattern:"AI ‡§™‡•à‡§ü‡§∞‡•ç‡§® ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£",analysis_dashboard:"‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§°",predictions:"‡§≠‡§µ‡§ø‡§∑‡•ç‡§Ø‡§µ‡§æ‡§£‡§ø‡§Ø‡§æ‡§Ç",
    trends:"‡§∞‡•Å‡§ù‡§æ‡§®",personal_records:"‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø‡§ó‡§§ ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§°",pattern_detection:"‡§™‡•à‡§ü‡§∞‡•ç‡§® ‡§™‡§π‡§ö‡§æ‡§®",
    health_profile:"‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø ‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤",brain_training:"‡§Æ‡§∏‡•ç‡§§‡§ø‡§∑‡•ç‡§ï ‡§™‡•ç‡§∞‡§∂‡§ø‡§ï‡•ç‡§∑‡§£",lucid_dreams:"‡§∏‡•ç‡§™‡§∑‡•ç‡§ü ‡§∏‡•ç‡§µ‡§™‡•ç‡§® ‡§≤‡•à‡§¨",
    log_dream:"‡§∏‡•ç‡§µ‡§™‡•ç‡§® ‡§≤‡•â‡§ó ‡§ï‡§∞‡•á‡§Ç",ai_dream:"AI ‡§∏‡•ç‡§µ‡§™‡•ç‡§® ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£",lucid_techniques:"‡§∏‡•ç‡§™‡§∑‡•ç‡§ü ‡§∏‡•ç‡§µ‡§™‡•ç‡§® ‡§§‡§ï‡§®‡•Ä‡§ï",
    reality_check:"‡§µ‡§æ‡§∏‡•ç‡§§‡§µ‡§ø‡§ï‡§§‡§æ ‡§ú‡§æ‡§Ç‡§ö",voice_media:"‡§Ü‡§µ‡§æ‡§ú ‡§î‡§∞ ‡§Æ‡•Ä‡§°‡§ø‡§Ø‡§æ",voice_recorder:"‡§Ü‡§µ‡§æ‡§ú ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§°‡§∞",
    ai_voice:"AI ‡§Ü‡§µ‡§æ‡§ú ‡§Ö‡§Ç‡§§‡§∞‡•ç‡§¶‡•É‡§∑‡•ç‡§ü‡§ø",voice_memos:"‡§Ü‡§µ‡§æ‡§ú ‡§Æ‡•á‡§Æ‡•ã",media_upload:"‡§Æ‡•Ä‡§°‡§ø‡§Ø‡§æ ‡§Ö‡§™‡§≤‡•ã‡§°",
    calendar_alarms:"‡§ï‡•à‡§≤‡•á‡§Ç‡§°‡§∞ ‡§î‡§∞ ‡§Ö‡§≤‡§æ‡§∞‡•ç‡§Æ",alarms_reminders:"‡§Ö‡§≤‡§æ‡§∞‡•ç‡§Æ ‡§î‡§∞ ‡§∞‡§ø‡§Æ‡§æ‡§á‡§Ç‡§°‡§∞",reminders:"‡§∞‡§ø‡§Æ‡§æ‡§á‡§Ç‡§°‡§∞",
    settings:"‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏",appearance:"‡§∞‡•Ç‡§™-‡§∞‡§Ç‡§ó",dark_mode:"‡§°‡§æ‡§∞‡•ç‡§ï ‡§Æ‡•ã‡§°",app_language:"‡§ê‡§™ ‡§≠‡§æ‡§∑‡§æ",
    notifications:"‡§∏‡•Ç‡§ö‡§®‡§æ‡§è‡§Ç",ai_settings:"AI ‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏",data_management:"‡§°‡•á‡§ü‡§æ ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§®",
    about:"‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç",world_intel:"‡§µ‡§ø‡§∂‡•ç‡§µ ‡§¨‡•Å‡§¶‡•ç‡§ß‡§ø ‡§™‡•à‡§®‡§≤",cognitive_path:"‡§Ö‡§ß‡•ç‡§Ø‡§Ø‡§® ‡§î‡§∞ ‡§ï‡§∞‡§ø‡§Ø‡§∞ AI",
    frontier_science:"‡§∏‡•Ä‡§Æ‡§æ‡§Ç‡§§ ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§® ‡§´‡§º‡•Ä‡§°",system_control:"‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§£",
    save:"‡§∏‡§π‡•á‡§ú‡•á‡§Ç",cancel:"‡§∞‡§¶‡•ç‡§¶ ‡§ï‡§∞‡•á‡§Ç",close:"‡§¨‡§Ç‡§¶ ‡§ï‡§∞‡•á‡§Ç",next:"‡§Ö‡§ó‡§≤‡§æ",previous:"‡§™‡§ø‡§õ‡§≤‡§æ",back:"‡§µ‡§æ‡§™‡§∏",
    play:"‡§ö‡§≤‡§æ‡§è‡§Ç",pause:"‡§∞‡•ã‡§ï‡•á‡§Ç",analyze:"‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§ï‡§∞‡•á‡§Ç",generate:"‡§¨‡§®‡§æ‡§è‡§Ç",export:"‡§®‡§ø‡§∞‡•ç‡§Ø‡§æ‡§§",import:"‡§Ü‡§Ø‡§æ‡§§",
    clear:"‡§∏‡§æ‡§´ ‡§ï‡§∞‡•á‡§Ç",add:"‡§ú‡•ã‡§°‡§º‡•á‡§Ç",delete:"‡§π‡§ü‡§æ‡§è‡§Ç",reset:"‡§∞‡•Ä‡§∏‡•á‡§ü",start:"‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç",stop:"‡§∞‡•ã‡§ï‡•á‡§Ç",
    saved:"‡§∏‡§π‡•á‡§ú‡§æ ‡§ó‡§Ø‡§æ!",cleared:"‡§∏‡§æ‡§´ ‡§π‡•ã ‡§ó‡§Ø‡§æ",loading:"‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...",analyzing:"‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£...",
    tap_record:"‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§° ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ü‡•à‡§™ ‡§ï‡§∞‡•á‡§Ç",live_transcript:"‡§≤‡§æ‡§á‡§µ ‡§ü‡•ç‡§∞‡§æ‡§Ç‡§∏‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü",
    morning:"‡§∏‡•Å‡§¨‡§π",afternoon:"‡§¶‡•ã‡§™‡§π‡§∞",evening:"‡§∂‡§æ‡§Æ",night:"‡§∞‡§æ‡§§",
    version:"‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£",privacy:"‡§ó‡•ã‡§™‡§®‡•Ä‡§Ø‡§§‡§æ",local_mode:"‡§∏‡•ç‡§•‡§æ‡§®‡•Ä‡§Ø ‡§Æ‡•ã‡§° ‚Äî ‡§∏‡§≠‡•Ä ‡§°‡•á‡§ü‡§æ ‡§Ü‡§™‡§ï‡•á ‡§°‡§ø‡§µ‡§æ‡§á‡§∏ ‡§™‡§∞",
    no_entries:"‡§ï‡•ã‡§à ‡§™‡•ç‡§∞‡§µ‡§ø‡§∑‡•ç‡§ü‡§ø ‡§®‡§π‡•Ä‡§Ç",log_first:"‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§¶‡•á‡§ñ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡§π‡§≤‡§æ ‡§≤‡•â‡§ó ‡§≠‡§∞‡•á‡§Ç",
    theme_engine:"‡§•‡•Ä‡§Æ ‡§á‡§Ç‡§ú‡§®",account_identity:"‡§™‡§π‡§ö‡§æ‡§® ‡§™‡§∞‡§§",consciousness_guide:"‡§ö‡•á‡§§‡§®‡§æ ‡§ó‡§æ‡§á‡§°",
    legal_policy:"‡§ï‡§æ‡§®‡•Ç‡§®‡•Ä ‡§î‡§∞ ‡§®‡•Ä‡§§‡§ø",passive_telemetry:"‡§®‡§ø‡§∑‡•ç‡§ï‡•ç‡§∞‡§ø‡§Ø ‡§Ö‡§®‡•Å‡§≠‡•Ç‡§§‡§ø ‡§ü‡•á‡§≤‡•Ä‡§Æ‡•á‡§ü‡•ç‡§∞‡•Ä",
    deep_work:"‡§ó‡§π‡§∞‡§æ ‡§ï‡§æ‡§Æ",exercise:"‡§µ‡•ç‡§Ø‡§æ‡§Ø‡§æ‡§Æ",rest:"‡§Ü‡§∞‡§æ‡§Æ",social:"‡§∏‡§æ‡§Æ‡§æ‡§ú‡§ø‡§ï",learning:"‡§∏‡•Ä‡§ñ‡§®‡§æ",
    creative:"‡§∞‡§ö‡§®‡§æ‡§§‡•ç‡§Æ‡§ï",meditation:"‡§ß‡•ç‡§Ø‡§æ‡§®",entertainment:"‡§Æ‡§®‡•ã‡§∞‡§Ç‡§ú‡§®",
  },
  es:{
    nav_log:"Registro",nav_waves:"Ondas",nav_ai:"IA Hub",nav_analysis:"An√°lisis",nav_health:"Salud",
    nav_games:"Juegos",nav_dreams:"Sue√±os",nav_media:"Media",nav_calendar:"Calendario",
    nav_settings:"Ajustes",nav_world:"Mundo",nav_path:"Camino",nav_science:"Ciencia",nav_system:"Sistema",
    daily_log:"Registro de Conciencia",entry_info:"Info de Entrada",date:"Fecha",time_of_day:"Hora del D√≠a",
    activity:"Actividad",consciousness_metrics:"M√©tricas de Conciencia",save_entry:"Guardar",
    inner_state:"Estado Interior",reflections:"Reflexiones",recent_entries:"Entradas Recientes",
    raw_thoughts:"Pensamientos / Flujo de Conciencia",key_insight:"Insight Clave de Hoy",
    current_goal:"Meta Actual",main_obstacle:"Obst√°culo Principal",gratitude:"Gratitud",
    recurring_pattern:"Patr√≥n Recurrente",key_action:"Acci√≥n Clave",
    brainwave_state:"Estado de Ondas Cerebrales",dominant_emotion:"Emoci√≥n Dominante",physical_sensation:"Sensaci√≥n F√≠sica",
    brainwave_audio:"Lab de Audio Cerebral",now_playing:"Reproduciendo",brainwave_sessions:"Sesiones",
    what_are_brainwaves:"¬øQu√© son las Ondas Cerebrales?",select_ai_model:"Seleccionar Modelo IA",
    daily_tip:"Consejo Diario",ai_pattern:"An√°lisis de Patrones IA",analysis_dashboard:"Panel de An√°lisis",
    predictions:"Predicciones",trends:"Tendencias",personal_records:"R√©cords Personales",pattern_detection:"Detecci√≥n de Patrones",
    health_profile:"Perfil de Salud",brain_training:"Entrenamiento Cerebral",lucid_dreams:"Lab de Sue√±os L√∫cidos",
    log_dream:"Registrar Sue√±o",ai_dream:"An√°lisis IA de Sue√±os",lucid_techniques:"T√©cnicas de Sue√±o L√∫cido",
    reality_check:"Control de Realidad",voice_media:"Voz y Media",voice_recorder:"Grabador de Voz",
    ai_voice:"Perspectivas de Voz IA",voice_memos:"Memos de Voz",media_upload:"Subir Media",
    calendar_alarms:"Calendario y Alarmas",alarms_reminders:"Alarmas y Recordatorios",reminders:"Recordatorios",
    settings:"Ajustes",appearance:"Apariencia",dark_mode:"Modo Oscuro",app_language:"Idioma",
    notifications:"Notificaciones",ai_settings:"Ajustes IA",data_management:"Gesti√≥n de Datos",
    about:"Acerca de",world_intel:"Panel de Inteligencia Mundial",cognitive_path:"IA de Estudio y Carrera",
    frontier_science:"Feed de Ciencia Frontera",system_control:"Control del Sistema",
    save:"Guardar",cancel:"Cancelar",close:"Cerrar",next:"Siguiente",previous:"Anterior",back:"Volver",
    play:"Reproducir",pause:"Pausar",analyze:"Analizar",generate:"Generar",export:"Exportar",import:"Importar",
    clear:"Limpiar",add:"Agregar",delete:"Eliminar",reset:"Restablecer",start:"Iniciar",stop:"Detener",
    saved:"¬°Guardado!",cleared:"Limpiado",loading:"Cargando...",analyzing:"Analizando...",
    tap_record:"Toca para Grabar",live_transcript:"Transcripci√≥n en Vivo",
    morning:"Ma√±ana",afternoon:"Tarde",evening:"Tarde-Noche",night:"Noche",
    version:"Versi√≥n",privacy:"Privacidad",local_mode:"Modo local ‚Äî todos los datos en tu dispositivo",
    no_entries:"Sin entradas",log_first:"Registra tu primera entrada para ver an√°lisis",
    theme_engine:"Motor de Temas",account_identity:"Capa de Identidad",consciousness_guide:"Gu√≠a de Conciencia",
    legal_policy:"Legal y Pol√≠tica",passive_telemetry:"Telemetr√≠a Cognitiva Pasiva",
    deep_work:"Trabajo Profundo",exercise:"Ejercicio",rest:"Descanso",social:"Social",learning:"Aprendizaje",
    creative:"Creativo",meditation:"Meditaci√≥n",entertainment:"Entretenimiento",
  },
  fr:{
    nav_log:"Journal",nav_waves:"Ondes",nav_ai:"IA Hub",nav_analysis:"Analyse",nav_health:"Sant√©",
    nav_games:"Jeux",nav_dreams:"R√™ves",nav_media:"M√©dias",nav_calendar:"Calendrier",
    nav_settings:"Param√®tres",nav_world:"Monde",nav_path:"Chemin",nav_science:"Science",nav_system:"Syst√®me",
    daily_log:"Journal de Conscience",entry_info:"Info d'Entr√©e",date:"Date",time_of_day:"Moment",
    activity:"Activit√©",consciousness_metrics:"M√©triques de Conscience",save_entry:"Sauvegarder",
    inner_state:"√âtat Int√©rieur",reflections:"R√©flexions",recent_entries:"Entr√©es R√©centes",
    raw_thoughts:"Pens√©es / Flux de Conscience",key_insight:"Insight Cl√© du Jour",
    current_goal:"Objectif Actuel",main_obstacle:"Obstacle Principal",gratitude:"Gratitude",
    recurring_pattern:"Sch√©ma R√©current",key_action:"Action Cl√©",
    brainwave_state:"√âtat des Ondes C√©r√©brales",dominant_emotion:"√âmotion Dominante",physical_sensation:"Sensation Physique",
    brainwave_audio:"Lab Audio C√©r√©bral",now_playing:"En Cours",brainwave_sessions:"Sessions",
    what_are_brainwaves:"Que sont les Ondes C√©r√©brales?",select_ai_model:"S√©lectionner le Mod√®le IA",
    daily_tip:"Conseil du Jour",ai_pattern:"Analyse de Patterns IA",analysis_dashboard:"Tableau de Bord",
    predictions:"Pr√©dictions",trends:"Tendances",personal_records:"Records Personnels",pattern_detection:"D√©tection de Patterns",
    health_profile:"Profil de Sant√©",brain_training:"Entra√Ænement C√©r√©bral",lucid_dreams:"Lab de R√™ves Lucides",
    log_dream:"Enregistrer un R√™ve",ai_dream:"Analyse IA des R√™ves",lucid_techniques:"Techniques de R√™ve Lucide",
    reality_check:"V√©rification de R√©alit√©",voice_media:"Voix et M√©dias",voice_recorder:"Enregistreur Vocal",
    ai_voice:"Insights Vocaux IA",voice_memos:"M√©mos Vocaux",media_upload:"T√©l√©charger M√©dia",
    calendar_alarms:"Calendrier et Alarmes",alarms_reminders:"Alarmes et Rappels",reminders:"Rappels",
    settings:"Param√®tres",appearance:"Apparence",dark_mode:"Mode Sombre",app_language:"Langue",
    notifications:"Notifications",ai_settings:"Param√®tres IA",data_management:"Gestion des Donn√©es",
    about:"√Ä Propos",world_intel:"Panneau d'Intelligence Mondiale",cognitive_path:"IA √âtude et Carri√®re",
    frontier_science:"Feed Science Fronti√®re",system_control:"Contr√¥le Syst√®me",
    save:"Sauvegarder",cancel:"Annuler",close:"Fermer",next:"Suivant",previous:"Pr√©c√©dent",back:"Retour",
    play:"Lire",pause:"Pause",analyze:"Analyser",generate:"G√©n√©rer",export:"Exporter",import:"Importer",
    clear:"Effacer",add:"Ajouter",delete:"Supprimer",reset:"R√©initialiser",start:"D√©marrer",stop:"Arr√™ter",
    saved:"Sauvegard√©!",cleared:"Effac√©",loading:"Chargement...",analyzing:"Analyse...",
    tap_record:"Appuyer pour Enregistrer",live_transcript:"Transcription en Direct",
    morning:"Matin",afternoon:"Apr√®s-midi",evening:"Soir",night:"Nuit",
    version:"Version",privacy:"Confidentialit√©",local_mode:"Mode local ‚Äî toutes les donn√©es sur votre appareil",
    no_entries:"Aucune entr√©e",log_first:"Enregistrez votre premi√®re entr√©e pour voir l'analyse",
    theme_engine:"Moteur de Th√®mes",account_identity:"Couche d'Identit√©",consciousness_guide:"Guide de Conscience",
    legal_policy:"L√©gal et Politique",passive_telemetry:"T√©l√©m√©trie Cognitive Passive",
    deep_work:"Travail Profond",exercise:"Exercice",rest:"Repos",social:"Social",learning:"Apprentissage",
    creative:"Cr√©atif",meditation:"M√©ditation",entertainment:"Divertissement",
  },
  de:{
    nav_log:"Tagebuch",nav_waves:"Wellen",nav_ai:"KI Hub",nav_analysis:"Analyse",nav_health:"Gesundheit",
    nav_games:"Spiele",nav_dreams:"Tr√§ume",nav_media:"Medien",nav_calendar:"Kalender",
    nav_settings:"Einstellungen",nav_world:"Welt",nav_path:"Pfad",nav_science:"Wissenschaft",nav_system:"System",
    daily_log:"Bewusstseins-Tagebuch",entry_info:"Eintragsinfo",date:"Datum",time_of_day:"Tageszeit",
    activity:"Aktivit√§t",consciousness_metrics:"Bewusstseinsmetriken",save_entry:"Speichern",
    inner_state:"Innerer Zustand",reflections:"Reflexionen",recent_entries:"Letzte Eintr√§ge",
    raw_thoughts:"Gedanken / Bewusstseinsstrom",key_insight:"Heutige Erkenntnis",
    current_goal:"Aktuelles Ziel",main_obstacle:"Haupthindernis",gratitude:"Dankbarkeit",
    recurring_pattern:"Wiederkehrendes Muster",key_action:"Schl√ºsselaktion",
    brainwave_state:"Gehirnwellenzustand",dominant_emotion:"Dominante Emotion",physical_sensation:"K√∂rpergef√ºhl",
    brainwave_audio:"Gehirnwellen-Audio-Lab",now_playing:"Jetzt l√§uft",brainwave_sessions:"Sitzungen",
    what_are_brainwaves:"Was sind Gehirnwellen?",select_ai_model:"KI-Modell w√§hlen",
    daily_tip:"Tagstipp",ai_pattern:"KI-Musteranalyse",analysis_dashboard:"Analyse-Dashboard",
    predictions:"Vorhersagen",trends:"Trends",personal_records:"Pers√∂nliche Rekorde",pattern_detection:"Mustererkennung",
    health_profile:"Gesundheitsprofil",brain_training:"Gehirntraining",lucid_dreams:"Luzider Traum-Lab",
    log_dream:"Traum aufzeichnen",ai_dream:"KI-Traumanalyse",lucid_techniques:"Luzide Traumtechniken",
    reality_check:"Realit√§tspr√ºfung",voice_media:"Stimme und Medien",voice_recorder:"Sprachrekorder",
    ai_voice:"KI-Sprach-Einblicke",voice_memos:"Sprachnotizen",media_upload:"Medien hochladen",
    calendar_alarms:"Kalender und Alarme",alarms_reminders:"Alarme und Erinnerungen",reminders:"Erinnerungen",
    settings:"Einstellungen",appearance:"Erscheinungsbild",dark_mode:"Dunkelmodus",app_language:"Sprache",
    notifications:"Benachrichtigungen",ai_settings:"KI-Einstellungen",data_management:"Datenverwaltung",
    about:"√úber uns",world_intel:"Weltintelligenz-Panel",cognitive_path:"Studien- und Karriere-KI",
    frontier_science:"Grenzwissenschafts-Feed",system_control:"Systemsteuerung",
    save:"Speichern",cancel:"Abbrechen",close:"Schlie√üen",next:"Weiter",previous:"Zur√ºck",back:"Zur√ºck",
    play:"Abspielen",pause:"Pausieren",analyze:"Analysieren",generate:"Generieren",export:"Exportieren",import:"Importieren",
    clear:"L√∂schen",add:"Hinzuf√ºgen",delete:"Entfernen",reset:"Zur√ºcksetzen",start:"Starten",stop:"Stoppen",
    saved:"Gespeichert!",cleared:"Gel√∂scht",loading:"L√§dt...",analyzing:"Analysiert...",
    tap_record:"Tippen zum Aufnehmen",live_transcript:"Live-Transkription",
    morning:"Morgen",afternoon:"Nachmittag",evening:"Abend",night:"Nacht",
    version:"Version",privacy:"Datenschutz",local_mode:"Lokaler Modus ‚Äî alle Daten auf Ihrem Ger√§t",
    no_entries:"Keine Eintr√§ge",log_first:"Ersten Eintrag erstellen f√ºr Analyse",
    theme_engine:"Themen-Engine",account_identity:"Identit√§tsschicht",consciousness_guide:"Bewusstseinsf√ºhrer",
    legal_policy:"Rechtliches und Richtlinien",passive_telemetry:"Passive kognitive Telemetrie",
    deep_work:"Tiefarbeit",exercise:"√úbung",rest:"Ruhe",social:"Sozial",learning:"Lernen",
    creative:"Kreativ",meditation:"Meditation",entertainment:"Unterhaltung",
  },
  pt:{
    nav_log:"Di√°rio",nav_waves:"Ondas",nav_ai:"IA Hub",nav_analysis:"An√°lise",nav_health:"Sa√∫de",
    nav_games:"Jogos",nav_dreams:"Sonhos",nav_media:"M√≠dia",nav_calendar:"Calend√°rio",
    nav_settings:"Configura√ß√µes",nav_world:"Mundo",nav_path:"Caminho",nav_science:"Ci√™ncia",nav_system:"Sistema",
    daily_log:"Di√°rio de Consci√™ncia",entry_info:"Info da Entrada",date:"Data",time_of_day:"Hora do Dia",
    activity:"Atividade",consciousness_metrics:"M√©tricas de Consci√™ncia",save_entry:"Salvar",
    inner_state:"Estado Interior",reflections:"Reflex√µes",recent_entries:"Entradas Recentes",
    raw_thoughts:"Pensamentos / Fluxo de Consci√™ncia",key_insight:"Insight Principal de Hoje",
    current_goal:"Meta Atual",main_obstacle:"Principal Obst√°culo",gratitude:"Gratid√£o",
    recurring_pattern:"Padr√£o Recorrente",key_action:"A√ß√£o Principal",
    brainwave_state:"Estado de Ondas Cerebrais",dominant_emotion:"Emo√ß√£o Dominante",physical_sensation:"Sensa√ß√£o F√≠sica",
    saved:"Salvo!",cleared:"Limpo",save:"Salvar",morning:"Manh√£",afternoon:"Tarde",evening:"Tarde/Noite",night:"Noite",
  },
  zh:{
    nav_log:"Êó•Âøó",nav_waves:"ËÑëÊ≥¢",nav_ai:"AI‰∏≠ÂøÉ",nav_analysis:"ÂàÜÊûê",nav_health:"ÂÅ•Â∫∑",
    nav_games:"Ê∏∏Êàè",nav_dreams:"Ê¢¶Â¢É",nav_media:"Â™í‰Ωì",nav_calendar:"Êó•ÂéÜ",
    nav_settings:"ËÆæÁΩÆ",nav_world:"‰∏ñÁïå",nav_path:"Ë∑ØÂæÑ",nav_science:"ÁßëÂ≠¶",nav_system:"Á≥ªÁªü",
    daily_log:"ÊØèÊó•ÊÑèËØÜÊó•Âøó",entry_info:"Êù°ÁõÆ‰ø°ÊÅØ",date:"Êó•Êúü",time_of_day:"Êó∂Èó¥ÊÆµ",
    activity:"Ê¥ªÂä®",consciousness_metrics:"ÊÑèËØÜÊåáÊ†á",save_entry:"‰øùÂ≠ò",
    inner_state:"ÂÜÖÂøÉÁä∂ÊÄÅ",reflections:"ÂèçÊÄù",recent_entries:"ÊúÄËøëÊù°ÁõÆ",
    raw_thoughts:"ÂéüÂßãÊÉ≥Ê≥ï / ÊÑèËØÜÊµÅ",key_insight:"‰ªäÊó•ÂÖ≥ÈîÆÊ¥ûÂØü",
    current_goal:"ÂΩìÂâçÁõÆÊ†á",main_obstacle:"‰∏ªË¶ÅÈöúÁ¢ç",gratitude:"ÊÑüÊÅ©",
    recurring_pattern:"ÈáçÂ§çÊ®°Âºè",key_action:"ÂÖ≥ÈîÆË°åÂä®",
    brainwave_state:"ËÑëÊ≥¢Áä∂ÊÄÅ",dominant_emotion:"‰∏ªÂØºÊÉÖÁª™",physical_sensation:"Ë∫´‰ΩìÊÑüËßâ",
    saved:"Â∑≤‰øùÂ≠òÔºÅ",cleared:"Â∑≤Ê∏ÖÈô§",save:"‰øùÂ≠ò",morning:"Êó©Êô®",afternoon:"‰∏ãÂçà",evening:"ÂÇçÊôö",night:"Â§úÊôö",
  },
  ar:{
    nav_log:"ÿ≥ÿ¨ŸÑ",nav_waves:"ŸÖŸàÿ¨ÿßÿ™",nav_ai:"ŸÖÿ±ŸÉÿ≤ AI",nav_analysis:"ÿ™ÿ≠ŸÑŸäŸÑ",nav_health:"ÿµÿ≠ÿ©",
    nav_games:"ÿ£ŸÑÿπÿßÿ®",nav_dreams:"ÿ£ÿ≠ŸÑÿßŸÖ",nav_media:"Ÿàÿ≥ÿßÿ¶ÿ∑",nav_calendar:"ÿ™ŸÇŸàŸäŸÖ",
    nav_settings:"ÿ•ÿπÿØÿßÿØÿßÿ™",nav_world:"ÿπÿßŸÑŸÖ",nav_path:"ŸÖÿ≥ÿßÿ±",nav_science:"ÿπŸÑŸàŸÖ",nav_system:"ŸÜÿ∏ÿßŸÖ",
    daily_log:"ÿ≥ÿ¨ŸÑ ÿßŸÑŸàÿπŸä ÿßŸÑŸäŸàŸÖŸä",entry_info:"ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿ•ÿØÿÆÿßŸÑ",date:"ÿßŸÑÿ™ÿßÿ±ŸäÿÆ",time_of_day:"ŸàŸÇÿ™ ÿßŸÑŸäŸàŸÖ",
    activity:"ÿßŸÑŸÜÿ¥ÿßÿ∑",consciousness_metrics:"ŸÖŸÇÿßŸäŸäÿ≥ ÿßŸÑŸàÿπŸä",save_entry:"ÿ≠ŸÅÿ∏",
    inner_state:"ÿßŸÑÿ≠ÿßŸÑÿ© ÿßŸÑÿØÿßÿÆŸÑŸäÿ©",reflections:"ÿ™ÿ£ŸÖŸÑÿßÿ™",recent_entries:"ÿßŸÑÿ•ÿØÿÆÿßŸÑÿßÿ™ ÿßŸÑÿ£ÿÆŸäÿ±ÿ©",
    raw_thoughts:"ÿ£ŸÅŸÉÿßÿ± ÿÆÿßŸÖ / ÿ™Ÿäÿßÿ± ÿßŸÑŸàÿπŸä",key_insight:"ÿßŸÑÿ±ÿ§Ÿäÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© ÿßŸÑŸäŸàŸÖ",
    current_goal:"ÿßŸÑŸáÿØŸÅ ÿßŸÑÿ≠ÿßŸÑŸä",main_obstacle:"ÿßŸÑÿπŸÇÿ®ÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©",gratitude:"ÿßŸÖÿ™ŸÜÿßŸÜ",
    recurring_pattern:"ŸÜŸÖÿ∑ ŸÖÿ™ŸÉÿ±ÿ±",key_action:"ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ° ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä",
    brainwave_state:"ÿ≠ÿßŸÑÿ© ŸÖŸàÿ¨ÿßÿ™ ÿßŸÑÿØŸÖÿßÿ∫",dominant_emotion:"ÿßŸÑÿπÿßÿ∑ŸÅÿ© ÿßŸÑÿ≥ÿßÿ¶ÿØÿ©",physical_sensation:"ÿßŸÑÿ•ÿ≠ÿ≥ÿßÿ≥ ÿßŸÑÿ¨ÿ≥ÿØŸä",
    saved:"ÿ™ŸÖ ÿßŸÑÿ≠ŸÅÿ∏!",cleared:"ÿ™ŸÖ ÿßŸÑŸÖÿ≥ÿ≠",save:"ÿ≠ŸÅÿ∏",morning:"ÿµÿ®ÿßÿ≠",afternoon:"ÿ®ÿπÿØ ÿßŸÑÿ∏Ÿáÿ±",evening:"ŸÖÿ≥ÿßÿ°",night:"ŸÑŸäŸÑ",
  },
  ja:{
    nav_log:"„É≠„Ç∞",nav_waves:"Ê≥¢Âãï",nav_ai:"AI„Éè„Éñ",nav_analysis:"ÂàÜÊûê",nav_health:"ÂÅ•Â∫∑",
    nav_games:"„Ç≤„Éº„É†",nav_dreams:"Â§¢",nav_media:"„É°„Éá„Ç£„Ç¢",nav_calendar:"„Ç´„É¨„É≥„ÉÄ„Éº",
    nav_settings:"Ë®≠ÂÆö",nav_world:"‰∏ñÁïå",nav_path:"„Éë„Çπ",nav_science:"ÁßëÂ≠¶",nav_system:"„Ç∑„Çπ„ÉÜ„É†",
    daily_log:"Êó•Ê¨°ÊÑèË≠ò„É≠„Ç∞",entry_info:"„Ç®„É≥„Éà„É™„ÉºÊÉÖÂ†±",date:"Êó•‰ªò",time_of_day:"ÊôÇÈñìÂ∏Ø",
    activity:"Ê¥ªÂãï",consciousness_metrics:"ÊÑèË≠òÊåáÊ®ô",save_entry:"‰øùÂ≠ò",
    inner_state:"ÂÜÖÁöÑÁä∂ÊÖã",reflections:"ÂèçÁúÅ",recent_entries:"ÊúÄËøë„ÅÆ„Ç®„É≥„Éà„É™„Éº",
    raw_thoughts:"Áîü„ÅÆÊÄùËÄÉ / ÊÑèË≠ò„ÅÆÊµÅ„Çå",key_insight:"‰ªäÊó•„ÅÆ‰∏ªË¶Å„Å™Ê¥ûÂØü",
    current_goal:"ÁèæÂú®„ÅÆÁõÆÊ®ô",main_obstacle:"‰∏ª„Å™ÈöúÂÆ≥",gratitude:"ÊÑüË¨ù",
    recurring_pattern:"Áπ∞„ÇäËøî„Åó„Éë„Çø„Éº„É≥",key_action:"‰∏ªË¶Å„Å™„Ç¢„ÇØ„Ç∑„Éß„É≥",
    brainwave_state:"ËÑ≥Ê≥¢Áä∂ÊÖã",dominant_emotion:"ÊîØÈÖçÁöÑ„Å™ÊÑüÊÉÖ",physical_sensation:"Ë∫´‰ΩìÊÑüË¶ö",
    saved:"‰øùÂ≠òÊ∏à„ÅøÔºÅ",cleared:"„ÇØ„É™„Ç¢Ê∏à„Åø",save:"‰øùÂ≠ò",morning:"Êúù",afternoon:"ÂçàÂæå",evening:"Â§ïÊñπ",night:"Â§ú",
  },
  ru:{
    nav_log:"–ñ—É—Ä–Ω–∞–ª",nav_waves:"–í–æ–ª–Ω—ã",nav_ai:"–ò–ò –•–∞–±",nav_analysis:"–ê–Ω–∞–ª–∏–∑",nav_health:"–ó–¥–æ—Ä–æ–≤—å–µ",
    nav_games:"–ò–≥—Ä—ã",nav_dreams:"–°–Ω—ã",nav_media:"–ú–µ–¥–∏–∞",nav_calendar:"–ö–∞–ª–µ–Ω–¥–∞—Ä—å",
    nav_settings:"–ù–∞—Å—Ç—Ä–æ–π–∫–∏",nav_world:"–ú–∏—Ä",nav_path:"–ü—É—Ç—å",nav_science:"–ù–∞—É–∫–∞",nav_system:"–°–∏—Å—Ç–µ–º–∞",
    daily_log:"–ñ—É—Ä–Ω–∞–ª –°–æ–∑–Ω–∞–Ω–∏—è",entry_info:"–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è",date:"–î–∞—Ç–∞",time_of_day:"–í—Ä–µ–º—è —Å—É—Ç–æ–∫",
    activity:"–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å",consciousness_metrics:"–ú–µ—Ç—Ä–∏–∫–∏ –°–æ–∑–Ω–∞–Ω–∏—è",save_entry:"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å",
    inner_state:"–í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ",reflections:"–†–∞–∑–º—ã—à–ª–µ–Ω–∏—è",recent_entries:"–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–ø–∏—Å–∏",
    raw_thoughts:"–ú—ã—Å–ª–∏ / –ü–æ—Ç–æ–∫ —Å–æ–∑–Ω–∞–Ω–∏—è",key_insight:"–ö–ª—é—á–µ–≤–æ–µ –æ–∑–∞—Ä–µ–Ω–∏–µ –¥–Ω—è",
    current_goal:"–¢–µ–∫—É—â–∞—è —Ü–µ–ª—å",main_obstacle:"–ì–ª–∞–≤–Ω–æ–µ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–µ",gratitude:"–ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å",
    recurring_pattern:"–ü–æ–≤—Ç–æ—Ä—è—é—â–∏–π—Å—è –ø–∞—Ç—Ç–µ—Ä–Ω",key_action:"–ö–ª—é—á–µ–≤–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ",
    brainwave_state:"–°–æ—Å—Ç–æ—è–Ω–∏–µ –º–æ–∑–≥–æ–≤—ã—Ö –≤–æ–ª–Ω",dominant_emotion:"–î–æ–º–∏–Ω–∏—Ä—É—é—â–∞—è —ç–º–æ—Ü–∏—è",physical_sensation:"–§–∏–∑–∏—á–µ—Å–∫–∏–µ –æ—â—É—â–µ–Ω–∏—è",
    saved:"–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ!",cleared:"–û—á–∏—â–µ–Ω–æ",save:"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å",morning:"–£—Ç—Ä–æ",afternoon:"–î–µ–Ω—å",evening:"–í–µ—á–µ—Ä",night:"–ù–æ—á—å",
  }
};
let curLang=localStorage.getItem('cos_lang')||'en';
function t(key){return(LANGS[curLang]||LANGS.en)[key]||LANGS.en[key]||key;}
function setLang(lang){
  curLang=lang;localStorage.setItem('cos_lang',lang);
  applyFullTranslation(lang);
  buildNav();
}

// ‚îÄ‚îÄ COMPREHENSIVE TRANSLATION ENGINE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// Maps exact English text ‚Üí translation key (for DOM text walker)
const TEXT_MAP_EN={
  "Daily Consciousness Log":"daily_log","Entry Info":"entry_info","Date":"date",
  "Time of Day":"time_of_day","Activity":"activity","Consciousness Metrics":"consciousness_metrics",
  "Save Entry":"save_entry","Brainwave Audio Lab":"brainwave_audio",
  "AI Hub":"ai_hub","Analysis Dashboard":"analysis","Health Profile":"health_profile",
  "Brain Training":"brain_training","Lucid Dreams Lab":"lucid_dreams",
  "Voice & Media Archive":"voice_media","Calendar & Alarms":"calendar_alarms",
  "World Intelligence Panel":"world_intel","Study & Career Intelligence":"study_career",
  "Frontier Intelligence Feed":"frontier_science","System Control":"system_control",
  "Now Playing":"lbl_now_playing","Dark Mode":"lbl_dark_mode","App Language":"lbl_language",
  "Predictions":"lbl_predictions","Trends":"lbl_trends","Personal Records":"lbl_records",
  "Pattern Detection":"lbl_patterns","Dream Journal":"lbl_dream_journal",
  "Voice Memos":"lbl_voice_memos","Alarms & Reminders":"lbl_alarms",
  "Appearance":"lbl_appearance","Notifications":"lbl_notifications","About":"lbl_about",
  "Themes":"lbl_themes","Account":"lbl_account","Guide":"lbl_guide","Legal":"lbl_legal","Telemetry":"lbl_telemetry",
};
// Expanded LANGS with all keys for all languages
const LANGS_EXTRA={
  en:{
    lbl_now_playing:"Now Playing",lbl_dark_mode:"Dark Mode",lbl_language:"App Language",
    lbl_predictions:"Predictions",lbl_trends:"Trends",lbl_records:"Personal Records",
    lbl_patterns:"Pattern Detection",lbl_dream_journal:"Dream Journal",lbl_voice_memos:"Voice Memos",
    lbl_alarms:"Alarms & Reminders",lbl_appearance:"Appearance",lbl_notifications:"Notifications",
    lbl_about:"About",lbl_themes:"Themes",lbl_account:"Account",lbl_guide:"Guide",
    lbl_legal:"Legal",lbl_telemetry:"Telemetry",lbl_analysis_ai:"AI Pattern Analysis",
    brainwave_audio:"Brainwave Audio Lab",ai_hub:"AI Hub",analysis:"Analysis Dashboard",
    health_profile:"Health Profile",brain_training:"Brain Training",lucid_dreams:"Lucid Dreams Lab",
    voice_media:"Voice & Media Archive",calendar_alarms:"Calendar & Alarms",
    world_intel:"World Intelligence Panel",study_career:"Study & Career Intelligence",
    frontier_science:"Frontier Intelligence Feed",system_control:"System Control",
    placeholder_thoughts:"What's on your mind right now?",placeholder_insight:"What did you realize?",
    placeholder_goal:"What are you working toward?",placeholder_obstacle:"What's blocking you?",
    placeholder_gratitude:"3 things you're grateful for...",placeholder_dream_name:"Give it a name...",
    placeholder_chat:"Ask me anything about your consciousness, health, dreams...",
    placeholder_world_ask:"Ask about any geopolitical or economic force...",
    placeholder_science_ask:"Ask anything about frontier science...",
  },
  hi:{
    lbl_now_playing:"‡§Ö‡§≠‡•Ä ‡§¨‡§ú ‡§∞‡§π‡§æ ‡§π‡•à",lbl_dark_mode:"‡§°‡§æ‡§∞‡•ç‡§ï ‡§Æ‡•ã‡§°",lbl_language:"‡§ê‡§™ ‡§≠‡§æ‡§∑‡§æ",
    lbl_predictions:"‡§≠‡§µ‡§ø‡§∑‡•ç‡§Ø‡§µ‡§æ‡§£‡§ø‡§Ø‡§æ‡§Å",lbl_trends:"‡§™‡•ç‡§∞‡§µ‡•É‡§§‡•ç‡§§‡§ø‡§Ø‡§æ‡§Å",lbl_records:"‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø‡§ó‡§§ ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§°",
    lbl_patterns:"‡§™‡•à‡§ü‡§∞‡•ç‡§® ‡§™‡§π‡§ö‡§æ‡§®",lbl_dream_journal:"‡§∏‡§™‡§®‡§æ ‡§°‡§æ‡§Ø‡§∞‡•Ä",lbl_voice_memos:"‡§µ‡•â‡§Ø‡§∏ ‡§Æ‡•á‡§Æ‡•ã",
    lbl_alarms:"‡§Ö‡§≤‡§æ‡§∞‡•ç‡§Æ ‡§î‡§∞ ‡§∞‡§ø‡§Æ‡§æ‡§á‡§Ç‡§°‡§∞",lbl_appearance:"‡§∞‡•Ç‡§™-‡§∞‡§Ç‡§ó",lbl_notifications:"‡§∏‡•Ç‡§ö‡§®‡§æ‡§è‡§Å",
    lbl_about:"‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç",lbl_themes:"‡§•‡•Ä‡§Æ",lbl_account:"‡§ñ‡§æ‡§§‡§æ",lbl_guide:"‡§ó‡§æ‡§á‡§°",
    lbl_legal:"‡§ï‡§æ‡§®‡•Ç‡§®‡•Ä",lbl_telemetry:"‡§ü‡•á‡§≤‡•Ä‡§Æ‡•á‡§ü‡•ç‡§∞‡•Ä",lbl_analysis_ai:"AI ‡§™‡•à‡§ü‡§∞‡•ç‡§® ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£",
    brainwave_audio:"‡§¨‡•ç‡§∞‡•á‡§®‡§µ‡•á‡§µ ‡§ë‡§°‡§ø‡§Ø‡•ã ‡§≤‡•à‡§¨",ai_hub:"AI ‡§π‡§¨",analysis:"‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§°",
    health_profile:"‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø ‡§™‡•ç‡§∞‡•ã‡§´‡§º‡§æ‡§á‡§≤",brain_training:"‡§Æ‡§∏‡•ç‡§§‡§ø‡§∑‡•ç‡§ï ‡§™‡•ç‡§∞‡§∂‡§ø‡§ï‡•ç‡§∑‡§£",lucid_dreams:"‡§≤‡•ç‡§Ø‡•Ç‡§∏‡§ø‡§° ‡§°‡•ç‡§∞‡•Ä‡§Æ‡•ç‡§∏ ‡§≤‡•à‡§¨",
    voice_media:"‡§µ‡•â‡§Ø‡§∏ ‡§î‡§∞ ‡§Æ‡•Ä‡§°‡§ø‡§Ø‡§æ ‡§Ü‡§∞‡•ç‡§ï‡§æ‡§á‡§µ",calendar_alarms:"‡§ï‡•à‡§≤‡•á‡§Ç‡§°‡§∞ ‡§î‡§∞ ‡§Ö‡§≤‡§æ‡§∞‡•ç‡§Æ",
    world_intel:"‡§µ‡§ø‡§∂‡•ç‡§µ ‡§¨‡•Å‡§¶‡•ç‡§ß‡§ø ‡§™‡•à‡§®‡§≤",study_career:"‡§Ö‡§ß‡•ç‡§Ø‡§Ø‡§® ‡§î‡§∞ ‡§ï‡§∞‡§ø‡§Ø‡§∞ AI",
    frontier_science:"‡§´‡•ç‡§∞‡§Ç‡§ü‡§ø‡§Ø‡§∞ ‡§á‡§Ç‡§ü‡•á‡§≤‡§ø‡§ú‡•á‡§Ç‡§∏ ‡§´‡•Ä‡§°",system_control:"‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§ï‡§Ç‡§ü‡•ç‡§∞‡•ã‡§≤",
    placeholder_thoughts:"‡§Ö‡§≠‡•Ä ‡§Ü‡§™‡§ï‡•á ‡§¶‡§ø‡§Æ‡§æ‡§ó ‡§Æ‡•á‡§Ç ‡§ï‡•ç‡§Ø‡§æ ‡§π‡•à?",placeholder_insight:"‡§Ü‡§™‡§®‡•á ‡§ï‡•ç‡§Ø‡§æ ‡§Æ‡§π‡§∏‡•Ç‡§∏ ‡§ï‡§ø‡§Ø‡§æ?",
    placeholder_goal:"‡§Ü‡§™ ‡§ï‡§ø‡§∏ ‡§¶‡§ø‡§∂‡§æ ‡§Æ‡•á‡§Ç ‡§ï‡§æ‡§Æ ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç?",placeholder_obstacle:"‡§Ü‡§™‡§ï‡•ã ‡§ï‡•ç‡§Ø‡§æ ‡§∞‡•ã‡§ï ‡§∞‡§π‡§æ ‡§π‡•à?",
    placeholder_gratitude:"3 ‡§ö‡•Ä‡§ú‡•á‡§Ç ‡§ú‡§ø‡§®‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§™ ‡§Ü‡§≠‡§æ‡§∞‡•Ä ‡§π‡•à‡§Ç...",placeholder_dream_name:"‡§®‡§æ‡§Æ ‡§¶‡•á‡§Ç...",
    placeholder_chat:"‡§Ö‡§™‡§®‡•Ä ‡§ö‡•á‡§§‡§®‡§æ, ‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø, ‡§∏‡§™‡§®‡•ã‡§Ç ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§ï‡•Å‡§õ ‡§≠‡•Ä ‡§™‡•Ç‡§õ‡•á‡§Ç...",
    placeholder_world_ask:"‡§ï‡§ø‡§∏‡•Ä ‡§≠‡•Ä ‡§≠‡•Ç-‡§∞‡§æ‡§ú‡§®‡•Ä‡§§‡§ø‡§ï ‡§Ø‡§æ ‡§Ü‡§∞‡•ç‡§•‡§ø‡§ï ‡§∂‡§ï‡•ç‡§§‡§ø ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§™‡•Ç‡§õ‡•á‡§Ç...",
  },
  es:{
    lbl_now_playing:"Reproduciendo Ahora",lbl_dark_mode:"Modo Oscuro",lbl_language:"Idioma de la App",
    lbl_predictions:"Predicciones",lbl_trends:"Tendencias",lbl_records:"R√©cords Personales",
    lbl_patterns:"Detecci√≥n de Patrones",lbl_dream_journal:"Diario de Sue√±os",lbl_voice_memos:"Memos de Voz",
    lbl_alarms:"Alarmas y Recordatorios",lbl_appearance:"Apariencia",lbl_notifications:"Notificaciones",
    lbl_about:"Acerca de",lbl_themes:"Temas",lbl_account:"Cuenta",lbl_guide:"Gu√≠a",lbl_legal:"Legal",lbl_telemetry:"Telemetr√≠a",
    brainwave_audio:"Lab de Audio Cerebral",ai_hub:"Hub de IA",analysis:"Panel de An√°lisis",
    health_profile:"Perfil de Salud",brain_training:"Entrenamiento Mental",lucid_dreams:"Lab de Sue√±os L√∫cidos",
    world_intel:"Panel de Inteligencia Mundial",placeholder_thoughts:"¬øQu√© hay en tu mente?",
    placeholder_chat:"Preg√∫ntame cualquier cosa sobre tu conciencia...",
  },
  fr:{
    lbl_now_playing:"Lecture en cours",lbl_dark_mode:"Mode Sombre",lbl_language:"Langue de l'App",
    lbl_predictions:"Pr√©dictions",lbl_trends:"Tendances",lbl_records:"Records Personnels",
    lbl_patterns:"D√©tection de Patterns",lbl_dream_journal:"Journal des R√™ves",lbl_voice_memos:"M√©mos Vocaux",
    lbl_alarms:"Alarmes et Rappels",lbl_appearance:"Apparence",lbl_notifications:"Notifications",
    lbl_about:"√Ä propos",lbl_themes:"Th√®mes",lbl_account:"Compte",lbl_guide:"Guide",lbl_legal:"L√©gal",lbl_telemetry:"T√©l√©m√©trie",
    brainwave_audio:"Lab Audio C√©r√©bral",ai_hub:"Hub IA",analysis:"Tableau de Bord",
    health_profile:"Profil Sant√©",placeholder_thoughts:"Qu'est-ce qui vous pr√©occupe?",
    placeholder_chat:"Posez-moi des questions sur votre conscience...",
  },
  de:{
    lbl_dark_mode:"Dunkelmodus",lbl_language:"App-Sprache",lbl_predictions:"Vorhersagen",
    lbl_trends:"Trends",lbl_records:"Pers√∂nliche Rekorde",lbl_patterns:"Mustererkennung",
    lbl_now_playing:"Jetzt l√§uft",lbl_dream_journal:"Traumtagebuch",lbl_voice_memos:"Sprachnotizen",
    lbl_alarms:"Alarme & Erinnerungen",lbl_appearance:"Darstellung",lbl_notifications:"Benachrichtigungen",
    lbl_about:"√úber",lbl_themes:"Themen",lbl_account:"Konto",lbl_guide:"Leitfaden",lbl_legal:"Rechtliches",lbl_telemetry:"Telemetrie",
    brainwave_audio:"Gehirnwellen Audio Lab",ai_hub:"KI Hub",analysis:"Analyse-Dashboard",
    health_profile:"Gesundheitsprofil",brain_training:"Gehirntraining",lucid_dreams:"Klartraum Lab",
    world_intel:"Weltintelligenz-Panel",study_career:"Studium & Karriere KI",
    frontier_science:"Grenzwissenschaft Feed",system_control:"Systemsteuerung",
    save:"Speichern",cancel:"Abbrechen",close:"Schlie√üen",next:"Weiter",previous:"Zur√ºck",back:"Zur√ºck",
    play:"Abspielen",pause:"Pause",analyze:"Analysieren",generate:"Erstellen",export:"Exportieren",
    clear:"L√∂schen",add:"Hinzuf√ºgen",delete:"Entfernen",reset:"Zur√ºcksetzen",start:"Starten",stop:"Stoppen",
    morning:"Morgen",afternoon:"Nachmittag",evening:"Abend",night:"Nacht",
    daily_log:"T√§gliches Bewusstseinsprotokoll",entry_info:"Eintragsinformation",date:"Datum",time_of_day:"Tageszeit",
    activity:"Aktivit√§t",save_entry:"Eintrag speichern",
    inner_state:"Innerer Zustand",reflections:"Reflexionen",recent_entries:"Letzte Eintr√§ge",
    raw_thoughts:"Gedankenfluss / Bewusstseinsstrom",key_insight:"Heutiger Schl√ºssel-Einblick",
    current_goal:"Aktuelles Ziel",main_obstacle:"Haupthindernis",gratitude:"Dankbarkeit",
    placeholder_thoughts:"Was besch√§ftigt Sie gerade?",placeholder_insight:"Was haben Sie erkannt?",
    placeholder_goal:"Woran arbeiten Sie?",placeholder_obstacle:"Was h√§lt Sie auf?",
    placeholder_gratitude:"3 Dinge, f√ºr die Sie dankbar sind...",placeholder_dream_name:"Gib ihm einen Namen...",
    placeholder_chat:"Stellen Sie Fragen zu Ihrem Bewusstsein...",
    placeholder_world_ask:"Fragen Sie zu geopolitischen oder wirtschaftlichen Kr√§ften...",
    placeholder_science_ask:"Fragen Sie alles √ºber Grenzwissenschaft...",
  },
  pt:{
    lbl_dark_mode:"Modo Escuro",lbl_language:"Idioma do App",lbl_now_playing:"Tocando Agora",
    lbl_predictions:"Previs√µes",lbl_trends:"Tend√™ncias",lbl_records:"Recordes Pessoais",
    lbl_patterns:"Detec√ß√£o de Padr√µes",lbl_dream_journal:"Di√°rio de Sonhos",lbl_voice_memos:"Notas de Voz",
    lbl_alarms:"Alarmes e Lembretes",lbl_appearance:"Apar√™ncia",lbl_notifications:"Notifica√ß√µes",
    lbl_about:"Sobre",lbl_themes:"Temas",lbl_account:"Conta",lbl_guide:"Guia",lbl_legal:"Legal",lbl_telemetry:"Telemetria",
    brainwave_audio:"Lab de √Åudio de Ondas Cerebrais",ai_hub:"Hub de IA",analysis:"Painel de An√°lise",
    health_profile:"Perfil de Sa√∫de",brain_training:"Treinamento Mental",lucid_dreams:"Lab de Sonhos L√∫cidos",
    world_intel:"Painel de Intelig√™ncia Mundial",study_career:"IA de Estudo e Carreira",
    frontier_science:"Feed de Ci√™ncia de Fronteira",system_control:"Controle do Sistema",
    save:"Salvar",cancel:"Cancelar",close:"Fechar",next:"Pr√≥ximo",previous:"Anterior",back:"Voltar",
    morning:"Manh√£",afternoon:"Tarde",evening:"Noite",night:"Madrugada",
    daily_log:"Di√°rio de Consci√™ncia",date:"Data",time_of_day:"Hora do Dia",activity:"Atividade",save_entry:"Salvar Entrada",
    inner_state:"Estado Interior",reflections:"Reflex√µes",recent_entries:"Entradas Recentes",
    current_goal:"Meta Atual",gratitude:"Gratid√£o",
    placeholder_thoughts:"O que est√° em sua mente agora?",placeholder_chat:"Pergunte sobre sua consci√™ncia...",
    placeholder_world_ask:"Pergunte sobre for√ßas geopol√≠ticas...",
  },
  zh:{
    lbl_dark_mode:"Ê∑±Ëâ≤Ê®°Âºè",lbl_language:"Â∫îÁî®ËØ≠Ë®Ä",lbl_now_playing:"Ê≠£Âú®Êí≠Êîæ",
    lbl_predictions:"È¢ÑÊµã",lbl_trends:"Ë∂ãÂäø",lbl_records:"‰∏™‰∫∫ËÆ∞ÂΩï",
    lbl_patterns:"Ê®°ÂºèÊ£ÄÊµã",lbl_dream_journal:"Ê¢¶Â¢ÉÊó•ËÆ∞",lbl_voice_memos:"ËØ≠Èü≥Â§áÂøòÂΩï",
    lbl_alarms:"ÈóπÈíüÂíåÊèêÈÜí",lbl_appearance:"Â§ñËßÇ",lbl_notifications:"ÈÄöÁü•",
    lbl_about:"ÂÖ≥‰∫é",lbl_themes:"‰∏ªÈ¢ò",lbl_account:"Ë¥¶Êà∑",lbl_guide:"ÊåáÂçó",lbl_legal:"Ê≥ïÂæã",lbl_telemetry:"ÈÅ•Êµã",
    brainwave_audio:"ËÑëÊ≥¢Èü≥È¢ëÂÆûÈ™åÂÆ§",ai_hub:"AI‰∏≠ÂøÉ",analysis:"ÂàÜÊûê‰ª™Ë°®Êùø",
    health_profile:"ÂÅ•Â∫∑Ê°£Ê°à",brain_training:"Â§ßËÑëËÆ≠ÁªÉ",lucid_dreams:"Ê∏ÖÈÜíÊ¢¶ÂÆûÈ™åÂÆ§",
    world_intel:"‰∏ñÁïåÊÉÖÊä•Èù¢Êùø",study_career:"Â≠¶‰π†‰∏éËÅå‰∏öAI",
    frontier_science:"ÂâçÊ≤øÁßëÂ≠¶ËµÑËÆØ",system_control:"Á≥ªÁªüÊéßÂà∂",
    save:"‰øùÂ≠ò",cancel:"ÂèñÊ∂à",close:"ÂÖ≥Èó≠",next:"‰∏ã‰∏ÄÊ≠•",previous:"‰∏ä‰∏ÄÊ≠•",back:"ËøîÂõû",
    morning:"Êó©Êô®",afternoon:"‰∏ãÂçà",evening:"ÂÇçÊôö",night:"Ê∑±Â§ú",
    daily_log:"ÊØèÊó•ÊÑèËØÜÊó•Âøó",date:"Êó•Êúü",time_of_day:"‰∏ÄÂ§©‰∏≠ÁöÑÊó∂Èó¥",activity:"Ê¥ªÂä®",save_entry:"‰øùÂ≠òÊù°ÁõÆ",
    inner_state:"ÂÜÖÂøÉÁä∂ÊÄÅ",reflections:"ÂèçÊÄù",recent_entries:"ÊúÄËøëÊù°ÁõÆ",
    current_goal:"ÂΩìÂâçÁõÆÊ†á",gratitude:"ÊÑüÊÅ©",
    placeholder_thoughts:"ÊÇ®Áé∞Âú®Âú®ÊÉ≥‰ªÄ‰πà?",placeholder_chat:"ËØ¢ÈóÆÂÖ≥‰∫éÊÇ®ÊÑèËØÜÁöÑ‰ªª‰ΩïÈóÆÈ¢ò...",
    placeholder_world_ask:"ËØ¢ÈóÆ‰ªª‰ΩïÂú∞ÁºòÊîøÊ≤ªÊàñÁªèÊµéÂäõÈáè...",
  },
  ar:{
    lbl_dark_mode:"ÿßŸÑŸàÿ∂ÿπ ÿßŸÑÿØÿßŸÉŸÜ",lbl_language:"ŸÑÿ∫ÿ© ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ",lbl_now_playing:"Ÿäÿπÿ≤ŸÅ ÿßŸÑÿ¢ŸÜ",
    lbl_predictions:"ÿ™ŸÜÿ®ÿ§ÿßÿ™",lbl_trends:"ÿßŸÑÿßÿ™ÿ¨ÿßŸáÿßÿ™",lbl_records:"ÿ≥ÿ¨ŸÑÿßÿ™ ÿ¥ÿÆÿµŸäÿ©",
    lbl_patterns:"ÿßŸÑŸÉÿ¥ŸÅ ÿπŸÜ ÿßŸÑÿ£ŸÜŸÖÿßÿ∑",lbl_dream_journal:"ŸÖÿ¨ŸÑÿ© ÿßŸÑÿ£ÿ≠ŸÑÿßŸÖ",lbl_voice_memos:"ŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™ ÿµŸàÿ™Ÿäÿ©",
    lbl_alarms:"ÿßŸÑŸÖŸÜÿ®Ÿáÿßÿ™ ŸàÿßŸÑÿ™ÿ∞ŸÉŸäÿ±ÿßÿ™",lbl_appearance:"ÿßŸÑŸÖÿ∏Ÿáÿ±",lbl_notifications:"ÿ•ÿ¥ÿπÿßÿ±ÿßÿ™",
    lbl_about:"ÿ≠ŸàŸÑ",lbl_themes:"ÿßŸÑŸÖÿ∏ÿßŸáÿ±",lbl_account:"ÿ≠ÿ≥ÿßÿ®",lbl_guide:"ÿØŸÑŸäŸÑ",lbl_legal:"ŸÇÿßŸÜŸàŸÜŸä",lbl_telemetry:"ÿßŸÑŸÇŸäÿßÿ≥ ÿπŸÜ ÿ®ŸèÿπÿØ",
    brainwave_audio:"ŸÖÿÆÿ™ÿ®ÿ± ÿµŸàÿ™ ŸÖŸàÿ¨ÿßÿ™ ÿßŸÑÿØŸÖÿßÿ∫",ai_hub:"ŸÖÿ±ŸÉÿ≤ ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä",analysis:"ŸÑŸàÿ≠ÿ© ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑ",
    health_profile:"ÿßŸÑŸÖŸÑŸÅ ÿßŸÑÿµÿ≠Ÿä",brain_training:"ÿ™ÿØÿ±Ÿäÿ® ÿßŸÑÿØŸÖÿßÿ∫",lucid_dreams:"ŸÖÿÆÿ™ÿ®ÿ± ÿßŸÑÿ£ÿ≠ŸÑÿßŸÖ ÿßŸÑŸàÿßÿ∂ÿ≠ÿ©",
    world_intel:"ŸÑŸàÿ≠ÿ© ÿßŸÑÿßÿ≥ÿ™ÿÆÿ®ÿßÿ±ÿßÿ™ ÿßŸÑÿπÿßŸÑŸÖŸäÿ©",study_career:"ÿ∞ŸÉÿßÿ° ÿßŸÑÿØÿ±ÿßÿ≥ÿ© ŸàÿßŸÑŸÖŸáŸÜÿ©",
    frontier_science:"ÿ™ÿ∫ÿ∞Ÿäÿ© ÿßŸÑÿπŸÑŸàŸÖ ÿßŸÑÿ≠ÿØŸäÿ©",system_control:"ÿßŸÑÿ™ÿ≠ŸÉŸÖ ŸÅŸä ÿßŸÑŸÜÿ∏ÿßŸÖ",
    save:"ÿ≠ŸÅÿ∏",cancel:"ÿ•ŸÑÿ∫ÿßÿ°",close:"ÿ•ÿ∫ŸÑÿßŸÇ",next:"ÿßŸÑÿ™ÿßŸÑŸä",previous:"ÿßŸÑÿ≥ÿßÿ®ŸÇ",back:"ÿ±ÿ¨Ÿàÿπ",
    morning:"ÿµÿ®ÿßÿ≠",afternoon:"ÿ∏Ÿáÿ±",evening:"ŸÖÿ≥ÿßÿ°",night:"ŸÑŸäŸÑ",
    daily_log:"ÿ≥ÿ¨ŸÑ ÿßŸÑŸàÿπŸä ÿßŸÑŸäŸàŸÖŸä",date:"ÿ™ÿßÿ±ŸäÿÆ",time_of_day:"ŸàŸÇÿ™ ÿßŸÑŸäŸàŸÖ",activity:"ŸÜÿ¥ÿßÿ∑",save_entry:"ÿ≠ŸÅÿ∏ ÿßŸÑŸÖÿØÿÆŸÑ",
    inner_state:"ÿßŸÑÿ≠ÿßŸÑÿ© ÿßŸÑÿØÿßÿÆŸÑŸäÿ©",reflections:"ÿ™ÿ£ŸÖŸÑÿßÿ™",recent_entries:"ÿßŸÑŸÖÿØÿÆŸÑÿßÿ™ ÿßŸÑÿ£ÿÆŸäÿ±ÿ©",
    current_goal:"ÿßŸÑŸáÿØŸÅ ÿßŸÑÿ≠ÿßŸÑŸä",gratitude:"ÿßŸÖÿ™ŸÜÿßŸÜ",
    placeholder_thoughts:"ŸÖÿß ÿßŸÑÿ∞Ÿä Ÿäÿ¥ÿ∫ŸÑ ÿ∞ŸáŸÜŸÉ ÿßŸÑÿ¢ŸÜÿü",placeholder_chat:"ÿßÿ≥ÿ£ŸÑŸÜŸä ÿ£Ÿä ÿ¥Ÿäÿ° ÿπŸÜ ŸàÿπŸäŸÉ...",
    placeholder_world_ask:"ÿßÿ≥ÿ£ŸÑ ÿπŸÜ ÿ£Ÿä ŸÇŸàÿ© ÿ¨ŸäŸàÿ≥Ÿäÿßÿ≥Ÿäÿ© ÿ£Ÿà ÿßŸÇÿ™ÿµÿßÿØŸäÿ©...",
  },
  ja:{
    lbl_dark_mode:"„ÉÄ„Éº„ÇØ„É¢„Éº„Éâ",lbl_language:"„Ç¢„Éó„É™„ÅÆË®ÄË™û",lbl_now_playing:"ÂÜçÁîü‰∏≠",
    lbl_predictions:"‰∫àÊ∏¨",lbl_trends:"„Éà„É¨„É≥„Éâ",lbl_records:"ÂÄã‰∫∫Ë®òÈå≤",
    lbl_patterns:"„Éë„Çø„Éº„É≥Ê§úÂá∫",lbl_dream_journal:"Â§¢Êó•Ë®ò",lbl_voice_memos:"„Éú„Ç§„Çπ„É°„É¢",
    lbl_alarms:"„Ç¢„É©„Éº„É†„Å®„É™„Éû„Ç§„É≥„ÉÄ„Éº",lbl_appearance:"Â§ñË¶≥",lbl_notifications:"ÈÄöÁü•",
    lbl_about:"„Å´„Å§„ÅÑ„Å¶",lbl_themes:"„ÉÜ„Éº„Éû",lbl_account:"„Ç¢„Ç´„Ç¶„É≥„Éà",lbl_guide:"„Ç¨„Ç§„Éâ",lbl_legal:"Ê≥ïÂæã",lbl_telemetry:"„ÉÜ„É¨„É°„Éà„É™„Éº",
    brainwave_audio:"ËÑ≥Ê≥¢„Ç™„Éº„Éá„Ç£„Ç™„É©„Éú",ai_hub:"AI„Éè„Éñ",analysis:"ÂàÜÊûê„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ",
    health_profile:"ÂÅ•Â∫∑„Éó„É≠„Éï„Ç£„Éº„É´",brain_training:"ËÑ≥„Éà„É¨„Éº„Éã„É≥„Ç∞",lucid_dreams:"ÊòéÊô∞Â§¢„É©„Éú",
    world_intel:"‰∏ñÁïåÊÉÖÂ†±„Éë„Éç„É´",study_career:"Â≠¶Áøí„Éª„Ç≠„É£„É™„Ç¢AI",
    frontier_science:"„Éï„É≠„É≥„ÉÜ„Ç£„Ç¢ÁßëÂ≠¶„Éï„Ç£„Éº„Éâ",system_control:"„Ç∑„Çπ„ÉÜ„É†Âà∂Âæ°",
    save:"‰øùÂ≠ò",cancel:"„Ç≠„É£„É≥„Çª„É´",close:"Èñâ„Åò„Çã",next:"Ê¨°„Å∏",previous:"Ââç„Å∏",back:"Êàª„Çã",
    morning:"Êúù",afternoon:"ÂçàÂæå",evening:"Â§ïÊñπ",night:"Â§ú",
    daily_log:"ÊØéÊó•„ÅÆÊÑèË≠ò„É≠„Ç∞",date:"Êó•‰ªò",time_of_day:"ÊôÇÈñìÂ∏Ø",activity:"Ê¥ªÂãï",save_entry:"„Ç®„É≥„Éà„É™„Éº„Çí‰øùÂ≠ò",
    inner_state:"ÂÜÖ„Å™„ÇãÁä∂ÊÖã",reflections:"ÊåØ„ÇäËøî„Çä",recent_entries:"ÊúÄËøë„ÅÆ„Ç®„É≥„Éà„É™„Éº",
    current_goal:"ÁèæÂú®„ÅÆÁõÆÊ®ô",gratitude:"ÊÑüË¨ù",
    placeholder_thoughts:"‰ªä„ÄÅ‰Ωï„ÇíËÄÉ„Åà„Å¶„ÅÑ„Åæ„Åô„ÅãÔºü",placeholder_chat:"ÊÑèË≠ò„Å´„Å§„ÅÑ„Å¶‰Ωï„Åß„ÇÇËÅû„ÅÑ„Å¶„Åè„Å†„Åï„ÅÑ...",
    placeholder_world_ask:"Âú∞ÊîøÂ≠¶ÁöÑ„ÉªÁµåÊ∏àÁöÑ„Å™Âäõ„Å´„Å§„ÅÑ„Å¶ËÅû„ÅÑ„Å¶„Åè„Å†„Åï„ÅÑ...",
  },
  ru:{
    lbl_dark_mode:"–¢—ë–º–Ω—ã–π —Ä–µ–∂–∏–º",lbl_language:"–Ø–∑—ã–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è",lbl_now_playing:"–°–µ–π—á–∞—Å –∏–≥—Ä–∞–µ—Ç",
    lbl_predictions:"–ü—Ä–æ–≥–Ω–æ–∑—ã",lbl_trends:"–¢–µ–Ω–¥–µ–Ω—Ü–∏–∏",lbl_records:"–õ–∏—á–Ω—ã–µ —Ä–µ–∫–æ—Ä–¥—ã",
    lbl_patterns:"–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤",lbl_dream_journal:"–î–Ω–µ–≤–Ω–∏–∫ —Å–Ω–æ–≤",lbl_voice_memos:"–ì–æ–ª–æ—Å–æ–≤—ã–µ –∑–∞–º–µ—Ç–∫–∏",
    lbl_alarms:"–ë—É–¥–∏–ª—å–Ω–∏–∫–∏ –∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è",lbl_appearance:"–í–Ω–µ—à–Ω–∏–π –≤–∏–¥",lbl_notifications:"–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è",
    lbl_about:"–û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏",lbl_themes:"–¢–µ–º—ã",lbl_account:"–ê–∫–∫–∞—É–Ω—Ç",lbl_guide:"–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ",lbl_legal:"–ü—Ä–∞–≤–æ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã",lbl_telemetry:"–¢–µ–ª–µ–º–µ—Ç—Ä–∏—è",
    brainwave_audio:"–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è –∑–≤—É–∫–∞ –º–æ–∑–≥–æ–≤—ã—Ö –≤–æ–ª–Ω",ai_hub:"–¶–µ–Ω—Ç—Ä –ò–ò",analysis:"–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∞—è –ø–∞–Ω–µ–ª—å",
    health_profile:"–ü—Ä–æ—Ñ–∏–ª—å –∑–¥–æ—Ä–æ–≤—å—è",brain_training:"–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –º–æ–∑–≥–∞",lucid_dreams:"–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è –æ—Å–æ–∑–Ω–∞–Ω–Ω—ã—Ö —Å–Ω–æ–≤",
    world_intel:"–ü–∞–Ω–µ–ª—å –º–∏—Ä–æ–≤–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞",study_career:"–ò–ò –¥–ª—è —É—á—ë–±—ã –∏ –∫–∞—Ä—å–µ—Ä—ã",
    frontier_science:"–õ–µ–Ω—Ç–∞ –ø–µ—Ä–µ–¥–æ–≤–æ–π –Ω–∞—É–∫–∏",system_control:"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–æ–π",
    save:"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å",cancel:"–û—Ç–º–µ–Ω–∞",close:"–ó–∞–∫—Ä—ã—Ç—å",next:"–î–∞–ª–µ–µ",previous:"–ù–∞–∑–∞–¥",back:"–ù–∞–∑–∞–¥",
    morning:"–£—Ç—Ä–æ",afternoon:"–î–µ–Ω—å",evening:"–í–µ—á–µ—Ä",night:"–ù–æ—á—å",
    daily_log:"–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –∂—É—Ä–Ω–∞–ª —Å–æ–∑–Ω–∞–Ω–∏—è",date:"–î–∞—Ç–∞",time_of_day:"–í—Ä–µ–º—è —Å—É—Ç–æ–∫",activity:"–î–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å",save_entry:"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∑–∞–ø–∏—Å—å",
    inner_state:"–í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ",reflections:"–†–∞–∑–º—ã—à–ª–µ–Ω–∏—è",recent_entries:"–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–ø–∏—Å–∏",
    current_goal:"–¢–µ–∫—É—â–∞—è —Ü–µ–ª—å",gratitude:"–ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å",
    placeholder_thoughts:"–û —á—ë–º –≤—ã –¥—É–º–∞–µ—Ç–µ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å?",placeholder_chat:"–°–ø—Ä–æ—Å–∏—Ç–µ –º–µ–Ω—è –æ –≤–∞—à–µ–º —Å–æ–∑–Ω–∞–Ω–∏–∏...",
    placeholder_world_ask:"–°–ø—Ä–æ—Å–∏—Ç–µ –æ –ª—é–±–æ–π –≥–µ–æ–ø–æ–ª–∏—Ç–∏—á–µ—Å–∫–æ–π –∏–ª–∏ —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–π —Å–∏–ª–µ...",
  },
};
// Merge LANGS_EXTRA into LANGS
Object.keys(LANGS_EXTRA).forEach(lang=>{if(LANGS[lang])Object.assign(LANGS[lang],LANGS_EXTRA[lang]);});

function applyFullTranslation(lang){
  const dict=LANGS[lang]||LANGS.en;
  // 1. Apply data-t attributes
  document.querySelectorAll('[data-t]').forEach(el=>{
    const k=el.getAttribute('data-t');const v=dict[k];if(v)el.textContent=v;
  });
  // 2. Apply placeholders by element ID
  const phMap={
    logThought:'placeholder_thoughts',logInsight:'placeholder_insight',
    logGoal:'placeholder_goal',logObstacle:'placeholder_obstacle',
    logGratitude:'placeholder_gratitude',chatInput:'placeholder_chat',
    worldAskInput:'placeholder_world_ask',scienceAskInput:'placeholder_science_ask',
    dreamTitle:'placeholder_dream_name',
  };
  Object.entries(phMap).forEach(([id,key])=>{
    const el=document.getElementById(id);if(el&&dict[key])el.placeholder=dict[key];
  });
  // 3. Walk ALL text nodes in the visible DOM and translate known English strings
  walkAndTranslate(document.body,dict);
  // 4. Translate form labels that contain only text (not in data-t)
  translateFormLabels(dict);
  // 5. Sync all language selectors
  ['langSel','settingLang','sysLangSel'].forEach(id=>{try{document.getElementById(id).value=lang;}catch(e){}});
  // 6. Set document direction for Arabic
  document.documentElement.dir=lang==='ar'?'rtl':'ltr';
  document.documentElement.lang=lang;
}

function walkAndTranslate(root,dict){
  // Build reverse lookup: English value ‚Üí key
  const enDict=LANGS.en;
  const reverseLookup={};
  Object.entries(enDict).forEach(([k,v])=>{if(typeof v==='string')reverseLookup[v]=k;});
  // Also add direct TEXT_MAP_EN entries
  Object.entries(TEXT_MAP_EN).forEach(([enText,key])=>{reverseLookup[enText]=key;});

  const walker=document.createTreeWalker(root,NodeFilter.SHOW_TEXT,{
    acceptNode:(node)=>{
      const p=node.parentElement;
      if(!p)return NodeFilter.FILTER_REJECT;
      const tag=p.tagName;
      if(['SCRIPT','STYLE','OPTION'].includes(tag))return NodeFilter.FILTER_REJECT;
      if(p.closest('input,textarea,select'))return NodeFilter.FILTER_REJECT;
      return NodeFilter.FILTER_ACCEPT;
    }
  });
  const updates=[];
  let node;
  while(node=walker.nextNode()){
    const raw=node.textContent;
    const text=raw.trim();
    if(!text||text.length<2||text.length>120)continue;
    // Direct lookup
    if(reverseLookup[text]){
      const key=reverseLookup[text];
      const translated=dict[key];
      if(translated&&translated!==text){
        updates.push({node,raw,text,translated});
        continue;
      }
    }
    // Try stripping leading emoji/symbol
    const stripped=text.replace(/^[\u{1F300}-\u{1FFFF}\u{2600}-\u{27BF}\s]+/gu,'').trim();
    if(stripped&&reverseLookup[stripped]){
      const key=reverseLookup[stripped];
      const translated=dict[key];
      if(translated&&translated!==stripped){
        const prefix=raw.substring(0,raw.indexOf(stripped));
        updates.push({node,raw,text:stripped,translated:prefix+translated});
      }
    }
  }
  // Apply all updates (outside walker loop to avoid invalidation)
  updates.forEach(({node,translated})=>{node.textContent=translated;});
}

function translateFormLabels(dict){
  const enDict=LANGS.en;
  const allKeys=Object.keys(enDict);
  // Build fast lookup: english text ‚Üí translated text
  const lookup={};
  allKeys.forEach(k=>{if(enDict[k]&&dict[k]&&dict[k]!==enDict[k])lookup[enDict[k]]=dict[k];});
  // Also add TEXT_MAP_EN entries
  Object.entries(TEXT_MAP_EN).forEach(([enText,key])=>{if(dict[key]&&dict[key]!==enText)lookup[enText]=dict[key];});
  
  const selectors='.form-label,.card-title,.section-header,.tab-section-title,.sub-label,.settings-label,.stat-label,h3,h4,label:not([for=""],.btn)';
  document.querySelectorAll(selectors).forEach(el=>{
    if(el.closest('script,style'))return;
    const childEls=[...el.children].filter(c=>c.tagName!=='SPAN'&&c.tagName!=='I'&&c.tagName!=='SVG');
    if(childEls.length>0)return; // skip complex elements
    const text=el.textContent.trim();
    // Direct lookup
    if(lookup[text]){el.textContent=lookup[text];return;}
    // Try stripping emoji prefix
    const stripped=text.replace(/^[\u{1F300}-\u{1FFFF}\u{2600}-\u{27BF}\u2702-\u27B0\s]+/gu,'').trim();
    if(stripped&&lookup[stripped]){
      const prefix=text.substring(0,text.indexOf(stripped));
      el.textContent=prefix+lookup[stripped];
    }
  });
}
const NAV_ITEMS=[
  {id:'log',icon:'üìù',key:'nav_log'},{id:'waves',icon:'üéµ',key:'nav_waves'},
  {id:'ai',icon:'ü§ñ',key:'nav_ai'},{id:'analysis',icon:'üìä',key:'nav_analysis'},
  {id:'health',icon:'‚ù§Ô∏è',key:'nav_health'},{id:'games',icon:'üéÆ',key:'nav_games'},
  {id:'dreams',icon:'üåô',key:'nav_dreams'},{id:'media',icon:'üéôÔ∏è',key:'nav_media'},
  {id:'calendar',icon:'üìÖ',key:'nav_calendar'},{id:'settings',icon:'‚öôÔ∏è',key:'nav_settings'},
  {id:'world',icon:'üåç',key:'nav_world'},{id:'path',icon:'üõ§Ô∏è',key:'nav_path'},
  {id:'science',icon:'üî¨',key:'nav_science'},{id:'system',icon:'üß©',key:'nav_system'},
];
let activeTab='log';
function buildNav(){
  const nav=document.getElementById('bottomNav');if(!nav)return;
  nav.innerHTML=NAV_ITEMS.map(n=>`<button class="nav-tab${activeTab===n.id?' active':''}" onclick="switchTab('${n.id}')"><span class="ni">${n.icon}</span><span>${t(n.key)}</span></button>`).join('');
}
function switchTab(id){
  document.querySelectorAll('.tab-panel').forEach(p=>p.classList.remove('active'));
  const panel=document.getElementById('tab-'+id);if(panel)panel.classList.add('active');
  activeTab=id;buildNav();
  if(id==='analysis')refreshAnalysis();
  if(id==='calendar')renderCalendar();
  if(id==='dreams')renderDreamJournal();
  if(id==='media'){renderVoiceMemos();renderMediaGrid();}
  if(id==='ai'){refreshAIInsights();loadDailyTip();}
  if(id==='world'){buildWorldPanel();buildClickableNews();}
  if(id==='science')buildScienceDisplay();
  if(id==='system'){buildThemeGrid();updateTelemetry();}
}

// ‚îÄ‚îÄ‚îÄ THEME ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function toggleTheme(){
  const isDark=document.documentElement.getAttribute('data-theme')==='dark';
  const next=isDark?'light':'dark';
  document.documentElement.setAttribute('data-theme',next);
  localStorage.setItem('cos_theme',next);
  document.getElementById('themeBtn').textContent=isDark?'üåô':'‚òÄÔ∏è';
  const s=document.getElementById('settingDark');if(s)s.classList.toggle('on',!isDark);
  SETTINGS_STATE.darkMode=!isDark;
}

// ‚îÄ‚îÄ‚îÄ TOAST ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function showToast(msg,dur=2400){
  const el=document.getElementById('toast');
  el.textContent=msg;el.classList.add('show');
  setTimeout(()=>el.classList.remove('show'),dur);
}

// ‚îÄ‚îÄ‚îÄ MODALS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function openModal(title,html){
  document.getElementById('modalTitle').textContent=title;
  document.getElementById('modalBody').innerHTML=html;
  document.getElementById('modalOverlay').classList.add('open');
}
function closeModal(e){if(e.target===document.getElementById('modalOverlay'))closeAllModals();}
function closeAllModals(){document.getElementById('modalOverlay').classList.remove('open');}

// ‚îÄ‚îÄ‚îÄ SETTING HELP ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const SETTING_HELP={
  darkmode:{title:'üåô Dark Mode',text:'Switches the app to a dark color scheme. Great for night use and reduces eye strain.'},
  anchors:{title:'üéöÔ∏è Slider Anchors',text:'Shows detailed descriptions for each slider value. Instead of guessing what "7" means, you see exactly what that score feels like.'},
  notif:{title:'üîî Notifications',text:'Allows the app to send browser notifications for alarms and reminders.'},
  rc:{title:'‚úã Reality Check Alerts',text:'Sends reminders every 2 hours to do a reality check. Building this habit while awake makes you do it in dreams too ‚Äî triggering lucid dreaming.'},
  promptboost:{title:'‚ú® AI Prompt Enhancement',text:'AI automatically rewrites your questions to be more specific before processing ‚Äî giving you better, more actionable answers.'},
};
function showSettingHelp(key){
  const info=SETTING_HELP[key]||{title:'Help',text:'Information coming soon.'};
  document.getElementById('settingHelpTitle').textContent=info.title;
  document.getElementById('settingHelpBody').innerHTML=info.text;
  document.getElementById('settingHelpOverlay').classList.add('open');
}

// ‚îÄ‚îÄ‚îÄ SETTINGS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const SETTINGS_STATE={};
function loadSettings(){
  const saved=JSON.parse(localStorage.getItem('cos_settings')||'{}');
  Object.assign(SETTINGS_STATE,{anchors:true,autoAnalyze:true,convMode:true,autoTranscribe:true,darkMode:false,notif:false,dailyReminder:false,rc:false,promptBoost:false,...saved});
  ['anchors','autoAnalyze','convMode','autoTranscribe','darkMode','notif','dailyReminder','rc','promptBoost'].forEach(k=>{
    const el=document.getElementById('setting'+k.charAt(0).toUpperCase()+k.slice(1));
    if(el)el.classList.toggle('on',!!SETTINGS_STATE[k]);
  });
  if(SETTINGS_STATE.darkMode){document.documentElement.setAttribute('data-theme','dark');document.getElementById('themeBtn').textContent='‚òÄÔ∏è';}
}
function toggleSetting(key){
  SETTINGS_STATE[key]=!SETTINGS_STATE[key];
  const el=document.getElementById('setting'+key.charAt(0).toUpperCase()+key.slice(1));
  if(el)el.classList.toggle('on',SETTINGS_STATE[key]);
  localStorage.setItem('cos_settings',JSON.stringify(SETTINGS_STATE));
}
function requestNotifPermission(){
  if(Notification.permission==='granted'){toggleSetting('notif');}
  else{Notification.requestPermission().then(p=>{if(p==='granted'){toggleSetting('notif');}else{showToast('Notifications denied');}})}
}

// ‚îÄ‚îÄ‚îÄ SLIDERS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const SLIDERS=[
  {id:'sleep',label:'üò¥ Sleep Quality',low:'No sleep',high:'Perfect sleep',anchors:['Catastrophic‚Äîno sleep/terrible','Very poor‚Äîbarely functional','Below average‚Äîdragging','Slightly below normal','Acceptable‚Äîgetting by','Good‚Äîrested and okay','Very good‚Äîrefreshed','Excellent‚Äîwoke naturally','Outstanding‚Äîbest in days','Perfect‚Äîcompletely restored']},
  {id:'mood',label:'üòä Mood',low:'Severe distress',high:'Peak euphoria',anchors:['Severe distress or crisis','Very low‚Äîstruggling to function','Low‚Äîgloomy and unmotivated','Below baseline‚Äîslightly down','Neutral‚Äîneither good nor bad','Okay‚Äîmild positivity','Good‚Äîgenuinely happy','Great‚Äîenergized and upbeat','Excellent‚Äîvery high spirits','Euphoric‚Äîpeak joy and bliss']},
  {id:'physicalEnergy',label:'‚ö° Physical Energy',low:'Completely depleted',high:'Peak vitality',anchors:['Completely depleted‚Äîbedridden','Barely able to do basics','Low‚Äîeverything takes effort','Below normal‚Äîsluggish body','Manageable‚Äîroutine possible','Good‚Äînormal activities easy','High‚Äîbody feels strong','Very high‚Äîwant to exercise','Excellent‚Äîathletic and vibrant','Peak‚Äîlimitless physical vitality']},
  {id:'mentalEnergy',label:'üß† Mental Energy',low:'Mental blackout',high:'Peak mental power',anchors:['Mental blackout‚Äîcannot think','Barely processing anything','Mental fog‚Äîvery slow thoughts','Below baseline‚Äîsluggish thinking','Normal‚Äîthinking is okay','Good‚Äîthoughts flow well','Sharp‚Äîquick and clear thinking','Very sharp‚Äîideas generating fast','Excellent‚Äîtop cognitive function','Peak‚Äîextraordinary mental clarity']},
  {id:'focus',label:'üéØ Focus',low:'Completely scattered',high:'Hyperfocus',anchors:['Completely scattered‚Äîzero attention','Barely present‚Äîmind everywhere','Poor focus‚Äîconstant distractions','Somewhat distracted','Moderate‚Äîcan focus with effort','Decent focus‚Äîmanageable','Good‚Äîsustained concentration','Strong‚Äîdeep work possible','Excellent‚Äîlaser-like attention','Hyperfocus‚Äîcomplete absorption']},
  {id:'stress',label:'üò∞ Stress',low:'No stress (calm)',high:'Crisis panic',anchors:['Completely calm‚Äîzero stress','Barely any tension‚Äîvery peaceful','Low stress‚Äîminor background worry','Slightly elevated‚Äîmanageable','Moderate‚Äînoticeable but okay','Elevated‚Äîaffecting performance','High‚Äîimpacting wellbeing','Very high‚Äîhard to function','Severe‚Äînear breaking point','Crisis‚Äîoverwhelming panic']},
  {id:'creativity',label:'üé® Creativity',low:'Completely blocked',high:'Genius inspiration',anchors:['Completely blocked‚Äîno ideas','Almost no creative thought','Low‚Äîvery few original ideas','Below average creativity','Some creativity‚Äîstandard ideas','Good creative flow','High‚Äîgenerating novel concepts','Excellent‚Äîideas pouring out','Outstanding‚Äîhighly original','Peak‚Äîgenius-level inspiration']},
  {id:'motivation',label:'üî• Motivation',low:'No drive',high:'Unstoppable',anchors:['No drive whatsoever','Almost impossible to start','Very low‚Äîmajor procrastination','Below normal drive','Some motivation‚Äîbasics done','Good‚Äîwant to make progress','High‚Äîexcited to work','Very high‚Äîon a mission','Excellent‚Äîunstoppable drive','Peak‚Äîextraordinary purpose']},
  {id:'clarity',label:'üíé Mental Clarity',low:'Complete fog',high:'Crystal clear',anchors:['Complete fog‚Äîcannot think straight','Extremely cloudy and confused','Very foggy‚Äîslow processing','Below normal clarity','Moderate‚Äîsomewhat clear','Good clarity‚Äîthinking straight','Clear‚Äîthoughts well organized','Very clear‚Äîsharp and precise','Excellent‚Äîcrystal clear thinking','Perfect‚Äîtotal mental transparency']},
  {id:'flow',label:'üåä Flow State',low:'Not in flow',high:'Transcendent flow',anchors:['Not in flow‚Äîcompletely distracted','Very far from flow','Mostly distracted‚Äîbarely present','Occasional moments of presence','Intermittent flow‚Äîfleeting','Some flow‚Äîpartially engaged','Good flow‚Äîdeep engagement','Strong flow‚Äîtime dissolving','Excellent flow‚Äîfully absorbed','Peak flow‚Äîtranscendent performance']},
  {id:'anxiety',label:'üò¨ Anxiety',low:'No anxiety (calm)',high:'Extreme panic',anchors:['Zero anxiety‚Äîperfectly calm','Barely any‚Äîvery serene','Minimal‚Äîslight background hum','Low‚Äîminor worry present','Moderate‚Äînoticeable anxiety','Elevated‚Äîaffecting thoughts','High‚Äîhard to stay focused','Severe‚Äîphysical symptoms','Very severe‚Äîpanic territory','Extreme‚Äîfull panic state']},
  {id:'stability',label:'üèîÔ∏è Emotional Stability',low:'Falling apart',high:'Unshakeable',anchors:['Completely unstable‚Äîcrisis mode','Very reactive‚Äîfalling apart','Easily overwhelmed','Somewhat unstable‚Äîwobbling','Moderate‚Äîsome up/down swings','Fairly stable‚Äîgenerally okay','Good‚Äîmostly centered','Very stable‚Äîgrounded','Excellent‚Äîunshakeable','Perfect‚Äîabsolute inner peace']},
  {id:'social',label:'üë• Social Energy',low:'Social exhaustion',high:'Love connection',anchors:['Complete social exhaustion','Deeply introverted‚Äîneed isolation','Very low social battery','Prefer solitude heavily','Moderate‚Äîshort interactions okay','Normal social energy','Good‚Äîenjoy being with others','High‚Äîenergized by people','Very high‚Äîthrive in groups','Peak social energy']},
  {id:'mindfulness',label:'üßò Mindfulness',low:'Autopilot',high:'Full presence',anchors:['Completely on autopilot','Almost no present-moment awareness','Very little mindfulness','Below average presence','Some awareness‚Äîoccasional pauses','Moderate mindfulness','Good‚Äîregularly present','Strong‚Äîsustained awareness','Excellent‚Äîdeeply present','Perfect‚Äîfull enlightened presence']},
  {id:'willpower',label:'üí™ Willpower',low:'Zero willpower',high:'Iron discipline',anchors:['Zero willpower‚Äîno resistance possible','Almost all impulses win','Very weak‚Äîdiscipline failing','Below average self-control','Moderate‚Äîmaking some choices','Good willpower‚Äîholding choices','Strong‚Äîresisting temptations','Very strong‚Äîhigh discipline','Excellent‚Äîexceptional self-mastery','Absolute willpower‚Äîiron discipline']},
  {id:'intuition',label:'üîÆ Intuition',low:'No gut sense',high:'Psychic knowing',anchors:['No intuitive hits‚Äîfully logical','Almost no gut sense','Rarely getting intuitive signals','Weak intuition‚Äîoccasional feeling','Moderate‚Äîsome gut feelings','Decent intuition‚Äîtrusting hunches','Good‚Äîregularly accurate gut sense','Strong intuition‚Äîmostly right','Excellent‚Äîhighly accurate','Peak‚Äîpsychic-level knowing']},
  {id:'cogLoad',label:'üñ•Ô∏è Cognitive Load',low:'Empty mind',high:'Overloaded',anchors:['Empty mind‚Äînothing to process','Almost no mental burden','Very light load‚Äîeasy day','Light‚Äîmanaging comfortably','Moderate‚Äînormal workday','Noticeable load‚Äîsomewhat taxed','High load‚Äîbrain working hard','Very high‚Äîapproaching limit','Overwhelming‚Äînearly saturated','Cognitive overload‚Äîsystem crash']},
  {id:'resilience',label:'üõ°Ô∏è Resilience',low:'Shattered by anything',high:'Thrives in chaos',anchors:['Completely shattered by anything','Falls apart very easily','Very fragile‚Äîbounce back slowly','Below normal recovery','Moderate‚Äîeventually recovers','Good‚Äîbouncing back okay','Strong‚Äîquickly recovers','Very strong‚Äîadversity makes stronger','Excellent‚Äîrobust and adaptive','Unbreakable‚Äîthrives in chaos']},
  {id:'presence',label:'‚ú® Presence / Vitality',low:'Absent',high:'Fully alive',anchors:['Non-existent‚Äîcompletely absent','Barely present‚Äîgoing through motions','Very low vitality','Below normal aliveness','Some sense of being alive','Good presence‚Äîengaged','High vitality‚Äîfeeling alive','Very high‚Äîglowing with life','Excellent‚Äîradiant presence','Peak vitality‚Äîfully embodied']},
  {id:'executiveFn',label:'üìã Executive Function',low:'Cannot plan',high:'Master-level management',anchors:['Cannot plan or organize anything','Barely able to make decisions','Very poor planning','Below normal executive control','Moderate‚Äîmanaging basic tasks','Good‚Äîplanning and executing okay','Strong‚Äîeffective task management','Excellent‚Äîstrategic and organized','Outstanding‚Äîexecutive excellence','Peak‚Äîmaster-level management']},
];

function buildSliders(){
  const container=document.getElementById('slidersContainer');if(!container)return;
  container.innerHTML=SLIDERS.map(s=>`
    <div class="slider-group" id="sg_${s.id}">
      <div class="slider-header">
        <span class="slider-label">${s.label}</span>
        <span class="slider-value-badge" id="val_${s.id}">5</span>
      </div>
      <input type="range" class="slider-track" id="sl_${s.id}" min="0" max="10" value="5" oninput="onSliderMove('${s.id}',this.value)" style="--pct:50%">
      <div class="slider-dots" id="dots_${s.id}">
        ${[0,1,2,3,4,5,6,7,8,9,10].map(n=>`<div class="slider-dot" id="dot_${s.id}_${n}" onclick="setSliderVal('${s.id}',${n})">${n}</div>`).join('')}
      </div>
      <div class="slider-pair-labels"><span>${s.low||''}</span><span>${s.high||''}</span></div>
      <div class="slider-anchor-text" id="anchor_${s.id}"></div>
    </div>`).join('');
  SLIDERS.forEach(s=>onSliderMove(s.id,5));
}
function onSliderMove(id,val){
  val=parseInt(val);
  const sl=document.getElementById('sl_'+id);
  if(sl){sl.value=val;sl.style.setProperty('--pct',(val/10*100)+'%');}
  const badge=document.getElementById('val_'+id);if(badge)badge.textContent=val;
  const slider=SLIDERS.find(s=>s.id===id);
  for(let i=0;i<=10;i++){
    const dot=document.getElementById('dot_'+id+'_'+i);if(!dot)continue;
    dot.classList.remove('active','near');
    if(i===val)dot.classList.add('active');
    else if(Math.abs(i-val)===1)dot.classList.add('near');
  }
  const anchor=document.getElementById('anchor_'+id);
  if(anchor&&slider){
    const idx=Math.min(val,9);
    anchor.textContent=val+' ‚Äî '+(slider.anchors[idx]||'');
    anchor.style.display=SETTINGS_STATE.anchors?'block':'none';
  }
  updateScore();
}
function setSliderVal(id,val){const sl=document.getElementById('sl_'+id);if(sl){sl.value=val;onSliderMove(id,val);}}
function updateSimpleSlider(el){el.style.setProperty('--pct',(el.value/10*100)+'%');const v=document.getElementById(el.id+'Val');if(v)v.textContent=el.value;}
function getSliderVal(id){return parseInt(document.getElementById('sl_'+id)?.value||5);}
function updateScore(){
  const f=getSliderVal('focus'),me=getSliderVal('mentalEnergy'),pe=getSliderVal('physicalEnergy'),
        mo=getSliderVal('mood'),sl=getSliderVal('sleep'),cr=getSliderVal('creativity'),
        mt=getSliderVal('motivation'),fl=getSliderVal('flow'),cl=getSliderVal('clarity'),
        mf=getSliderVal('mindfulness'),wp=getSliderVal('willpower'),st=getSliderVal('stress'),
        rs=getSliderVal('resilience'),pr=getSliderVal('presence'),ef=getSliderVal('executiveFn');
  const raw=(f*2.5+me*2.2+pe*1.5+mo*1.8+sl*1.8+cr*1.3+mt*1.2+fl*1.5+cl*1.8+mf+wp+rs*1.2+pr+ef*1.2+(10-st)*1.5)/25;
  const score=Math.max(0,Math.min(10,raw));
  const sv=document.getElementById('scoreValue');if(sv)sv.textContent=score.toFixed(1);
  const circle=document.getElementById('scoreCircle');
  if(circle){circle.style.strokeDashoffset=213.6-(213.6*score/10);
    const hue=score<4?0:score<6?40:score<8?120:270;circle.style.stroke=`hsl(${hue},70%,50%)`;}
  return score;
}

// ‚îÄ‚îÄ‚îÄ LOG ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function saveLog(){
  const score=updateScore();
  const entry={id:Date.now(),ts:new Date().toISOString(),
    date:document.getElementById('logDate')?.value||new Date().toISOString().split('T')[0],
    timeOfDay:document.getElementById('logTime')?.value,activity:document.getElementById('logActivity')?.value,
    brainwave:document.getElementById('logBrainwave')?.value,emotion:document.getElementById('logEmotion')?.value,
    sensation:document.getElementById('logSensation')?.value,thought:document.getElementById('logThought')?.value,
    insight:document.getElementById('logInsight')?.value,goal:document.getElementById('logGoal')?.value,
    obstacle:document.getElementById('logObstacle')?.value,gratitude:document.getElementById('logGratitude')?.value,
    pattern:document.getElementById('logPattern')?.value,action:document.getElementById('logAction')?.value,
    score:parseFloat(score.toFixed(2))};
  SLIDERS.forEach(s=>{entry[s.id]=getSliderVal(s.id);});
  const logs=getLogs();logs.unshift(entry);
  localStorage.setItem('cos_logs',JSON.stringify(logs));
  showToast('‚ú® '+t('saved'));renderRecentLogs();
}
function getLogs(){return JSON.parse(localStorage.getItem('cos_logs')||'[]');}
function renderRecentLogs(){
  const el=document.getElementById('recentLogs');if(!el)return;
  const logs=getLogs().slice(0,5);
  if(!logs.length){el.innerHTML='<div class="empty-state"><span class="es-icon">üìù</span><div class="es-text">No entries yet. Save your first log!</div></div>';return;}
  el.innerHTML=logs.map(e=>`
    <div style="display:flex;justify-content:space-between;align-items:center;padding:10px 0;border-bottom:1px solid var(--border)">
      <div><div style="font-weight:700;font-size:13px">${e.date} <span style="font-size:10px;color:var(--text3)">${e.timeOfDay||''}</span></div>
        <div style="font-size:11px;color:var(--text3);margin-top:2px">${e.emotion||''} ¬∑ ${e.activity||''}</div></div>
      <div style="text-align:right"><div style="font-family:Syne,sans-serif;font-weight:800;font-size:18px;color:var(--primary)">${e.score}</div><div style="font-size:10px;color:var(--text3)">score</div></div>
    </div>`).join('');
}

// ‚îÄ‚îÄ‚îÄ BRAINWAVE AUDIO ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
let audioCtx=null,bwOscL=null,bwOscR=null,bwGain=null,bwIsPlaying=false,bwCurrentTrack=0,bwTimer=null,bwSeconds=0,bwType='binaural';
const BW_TRACKS=[
  {name:'Deep Focus',desc:'Eliminate distractions, enter deep work',freq:'40 Hz Gamma',emoji:'üéØ',base:200,beat:40},
  {name:'Study Mode',desc:'Enhanced memory and learning',freq:'14 Hz Beta',emoji:'üìö',base:200,beat:14},
  {name:'Creative Flow',desc:'Unlock imagination and innovation',freq:'10 Hz Alpha',emoji:'üé®',base:200,beat:10},
  {name:'Deep Sleep',desc:'Fall asleep faster, sleep deeper',freq:'3 Hz Delta',emoji:'üò¥',base:150,beat:3},
  {name:'Meditation',desc:'Calm mind, expanded awareness',freq:'7 Hz Theta',emoji:'üßò',base:200,beat:7},
  {name:'Stress Relief',desc:'Melt away anxiety and tension',freq:'8 Hz Alpha',emoji:'üåä',base:180,beat:8},
  {name:'Memory Boost',desc:'Strengthen recall and retention',freq:'12 Hz Beta',emoji:'üîÆ',base:200,beat:12},
  {name:'Mood Lift',desc:'Elevate emotional state naturally',freq:'10 Hz Alpha',emoji:'‚òÄÔ∏è',base:220,beat:10},
  {name:'Brain Sync',desc:'Balance left and right hemispheres',freq:'20 Hz Beta',emoji:'üîó',base:200,beat:20},
  {name:'Super Learning',desc:'Optimal state for absorbing information',freq:'40 Hz Gamma',emoji:'‚ö°',base:210,beat:40},
  {name:'Lucid Dreams',desc:'Enhanced dream awareness and control',freq:'5 Hz Theta',emoji:'üåô',base:180,beat:5},
  {name:'Energy Boost',desc:'Natural mental and physical energy',freq:'30 Hz Beta',emoji:'üîã',base:200,beat:30},
];
function buildBWGrid(){
  const grid=document.getElementById('bwGrid');if(!grid)return;
  grid.innerHTML=BW_TRACKS.map((tr,i)=>`<div class="bw-card" id="bwCard_${i}" onclick="selectBWTrack(${i})"><span class="bw-emoji">${tr.emoji}</span><div class="bw-name">${tr.name}</div><div class="bw-desc">${tr.desc}</div><div class="bw-freq">${tr.freq}</div></div>`).join('');
  buildBWEducation();
}
function selectBWTrack(i){
  bwCurrentTrack=i;document.querySelectorAll('.bw-card').forEach((c,j)=>c.classList.toggle('playing',j===i));
  const tr=BW_TRACKS[i];
  document.getElementById('bwNowName').textContent=tr.name;
  document.getElementById('bwNowDesc').textContent=tr.desc;
  document.getElementById('bwNowFreq').textContent=tr.freq;
  if(bwIsPlaying)startBW();
}
function toggleBW(){if(bwIsPlaying)stopBW();else startBW();}
function startBW(){
  stopBW();
  try{
    audioCtx=new(window.AudioContext||window.webkitAudioContext)();
    const tr=BW_TRACKS[bwCurrentTrack];
    const vol=parseInt(document.getElementById('bwVol').value)/100;
    if(bwType==='binaural'){
      const merger=audioCtx.createChannelMerger(2);
      bwGain=audioCtx.createGain();bwGain.gain.value=vol*0.3;
      bwOscL=audioCtx.createOscillator();bwOscL.frequency.value=tr.base;bwOscL.type='sine';
      bwOscR=audioCtx.createOscillator();bwOscR.frequency.value=tr.base+tr.beat;bwOscR.type='sine';
      const gL=audioCtx.createGain(),gR=audioCtx.createGain();
      bwOscL.connect(gL);bwOscR.connect(gR);gL.connect(merger,0,0);gR.connect(merger,0,1);
      merger.connect(bwGain);bwGain.connect(audioCtx.destination);
      bwOscL.start();bwOscR.start();
    }else if(bwType==='whitenoise'){
      const bufSize=audioCtx.sampleRate*2;const buf=audioCtx.createBuffer(1,bufSize,audioCtx.sampleRate);
      const data=buf.getChannelData(0);for(let i=0;i<bufSize;i++)data[i]=(Math.random()*2-1)*0.3;
      const src=audioCtx.createBufferSource();src.buffer=buf;src.loop=true;
      bwGain=audioCtx.createGain();bwGain.gain.value=vol*0.3;src.connect(bwGain);bwGain.connect(audioCtx.destination);src.start();bwOscL=src;
    }else{
      bwGain=audioCtx.createGain();bwGain.gain.value=vol*0.25;
      bwOscL=audioCtx.createOscillator();bwOscL.frequency.value=528;bwOscL.type='sine';
      bwOscL.connect(bwGain);bwGain.connect(audioCtx.destination);bwOscL.start();
    }
    bwIsPlaying=true;document.getElementById('bwPlayBtn').textContent='‚è∏ Pause';
    buildBWVisualizer();bwSeconds=0;clearInterval(bwTimer);
    bwTimer=setInterval(()=>{bwSeconds++;const m=Math.floor(bwSeconds/60),s=bwSeconds%60;document.getElementById('bwTimer').textContent=(m<10?'0':'')+m+':'+(s<10?'0':'')+s;},1000);
  }catch(e){showToast('Audio requires interaction or unsupported browser');}
}
function stopBW(){
  if(bwOscL)try{bwOscL.stop&&bwOscL.stop();}catch(e){}
  if(bwOscR)try{bwOscR.stop&&bwOscR.stop();}catch(e){}
  if(audioCtx)try{audioCtx.close();}catch(e){}
  bwOscL=bwOscR=bwGain=audioCtx=null;bwIsPlaying=false;
  document.getElementById('bwPlayBtn').textContent='‚ñ∂ Play';clearInterval(bwTimer);resetBWVisualizer();
}
function setBWVol(v){if(bwGain)bwGain.gain.value=v/100*0.3;}
function setBWType(type,btn){bwType=type;document.querySelectorAll('.wave-btn').forEach(b=>b.classList.remove('active'));btn.classList.add('active');if(bwIsPlaying)startBW();}
function bwNextTrack(){selectBWTrack((bwCurrentTrack+1)%BW_TRACKS.length);if(bwIsPlaying)startBW();}
function bwPrevTrack(){selectBWTrack((bwCurrentTrack-1+BW_TRACKS.length)%BW_TRACKS.length);if(bwIsPlaying)startBW();}
function buildBWVisualizer(){
  document.getElementById('bwVisualizer').innerHTML=Array.from({length:24},(_,i)=>`<div class="bw-bar animating" style="height:50px;--dur:${0.3+Math.random()*0.5}s;animation-delay:${i*0.03}s"></div>`).join('');
}
function resetBWVisualizer(){document.getElementById('bwVisualizer').innerHTML='<div style="color:var(--text3);font-size:12px">‚ñ∂ Press Play to begin</div>';}
function buildBWEducation(){
  const el=document.getElementById('bwEducation');if(!el)return;
  const waves=[{name:'Delta (0.5‚Äì4 Hz)',emoji:'üò¥',desc:'Deep sleep and healing. Body repairs itself. Dreamless sleep.'},{name:'Theta (4‚Äì8 Hz)',emoji:'üåÄ',desc:'Drowsiness, creativity, REM sleep, lucid dreaming, deep meditation.'},{name:'Alpha (8‚Äì14 Hz)',emoji:'üòå',desc:'Relaxed focus, light meditation, calm alertness. Bridge between conscious and subconscious.'},{name:'Beta (14‚Äì30 Hz)',emoji:'üí°',desc:'Active thinking, focus, problem solving, normal waking consciousness.'},{name:'Gamma (30‚Äì100 Hz)',emoji:'‚ö°',desc:'Peak cognition, insight, high-level information processing.'}];
  el.innerHTML=waves.map(w=>`<div style="display:flex;gap:10px;padding:10px 0;border-bottom:1px solid var(--border)"><span style="font-size:24px">${w.emoji}</span><div><div style="font-weight:700;font-size:13px">${w.name}</div><div style="font-size:12px;color:var(--text2);margin-top:3px">${w.desc}</div></div></div>`).join('');
}

// ‚îÄ‚îÄ‚îÄ AI HUB ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const AI_MODELS=[
  {id:'twin',name:'Your Twin',emoji:'üß†',persona:'You are the user\'s AI Digital Twin. You have deeply analyzed their consciousness data and know their patterns. Be warm, insightful, and deeply personal.'},
  {id:'coach',name:'Mind Coach',emoji:'üèÜ',persona:'You are an elite performance coach and neuroscientist. Give direct, actionable advice for peak mental performance.'},
  {id:'sage',name:'Sage',emoji:'üîÆ',persona:'You are a wise sage combining ancient wisdom with modern psychology. Use metaphors and philosophical insights.'},
  {id:'doctor',name:'Dr. Mind',emoji:'üë®‚Äç‚öïÔ∏è',persona:'You are a cognitive neuroscientist. Analyze mental health patterns objectively. Be clinical but empathetic.'},
  {id:'friend',name:'Friend',emoji:'üòä',persona:'You are a supportive best friend who is very smart. Be casual, encouraging, real. Use simple language. Care deeply.'},
];
let curAIModel='twin',chatHistory=[];
const SUGGESTED_QS=['How\'s my mental performance trending?','What\'s my best time of day?','How do I enter flow state?','What patterns do you see in my stress?','Why does my creativity spike sometimes?','How is my sleep affecting my focus?','What habits should I build?','Am I improving over time?','How\'s my day going today?','What should I focus on right now?','What\'s blocking my peak performance?','Predict my energy tomorrow','Am I close to burnout?','Give me a personal insight','What do my dreams reveal?','How\'s my emotional stability?'];
const DAILY_TIPS=['Start with your hardest task when your brain is in Beta state ‚Äî usually 2-4 hours after waking.','Gamma brainwaves peak during moments of insight. Try a 20-minute Alpha meditation before creative work.','The brain consolidates memories during NREM sleep. 7-9 hours is optimal for learning retention.','Stress below 3 is optimal for creativity. Above 7 shrinks the hippocampus over time.','Dopamine is triggered by achieving small goals. Break large tasks into wins every 25 minutes.','Walking 10 minutes increases BDNF (brain fertilizer) and improves mood and focus for 2-3 hours.','Gratitude practice activates the prefrontal cortex and reduces amygdala reactivity.','Your HRV (heart rate variability) reflects nervous system health. High HRV = high resilience.','Dehydration of just 2% impairs cognitive performance by up to 20%. Keep drinking water!','Flow state is 3-5% more activated than your normal baseline. Track when you enter it most.'];
function buildAIModelsBar(){
  const bar=document.getElementById('aiModelsBar');if(!bar)return;
  bar.innerHTML=AI_MODELS.map(m=>`<div class="ai-model-btn${m.id===curAIModel?' active':''}" onclick="selectAIModel('${m.id}')"><span class="ai-logo">${m.emoji}</span><span class="ai-name">${m.name}</span></div>`).join('');
}
function selectAIModel(id){
  curAIModel=id;document.querySelectorAll('.ai-model-btn').forEach((b,i)=>b.classList.toggle('active',AI_MODELS[i].id===id));
  const m=AI_MODELS.find(m=>m.id===id);
  addChatMsg('ai',`Switched to ${m.name} mode. ${m.id==='friend'?'Hey! What\'s up? üòä':m.id==='sage'?'Seek and you shall find. What wisdom do you seek?':'How can I help you today?'}`,id);
}
function loadDailyTip(){const el=document.getElementById('aiDailyTip');if(el)el.textContent=DAILY_TIPS[new Date().getDate()%DAILY_TIPS.length];}
function buildSuggestedQs(){
  const el=document.getElementById('suggestedQs');if(!el)return;
  const shuffled=[...SUGGESTED_QS].sort(()=>Math.random()-.5).slice(0,6);
  el.innerHTML=shuffled.map(q=>`<button class="sq-btn" onclick="askSuggested('${q.replace(/'/g,"\\'")}')">${q}</button>`).join('');
}
function askSuggested(q){document.getElementById('chatInput').value=q;sendChat();}
function addChatMsg(role,text,modelId){
  const msgs=document.getElementById('chatMessages');if(!msgs)return;
  const model=AI_MODELS.find(m=>m.id===(modelId||curAIModel));
  const div=document.createElement('div');div.className='chat-msg '+role;
  if(role==='ai')div.innerHTML=`<div class="ai-tag">${model?model.emoji+' '+model.name:'AI'}</div>${text}`;
  else div.textContent=text;
  msgs.appendChild(div);msgs.scrollTop=msgs.scrollHeight;
  chatHistory.push({role,content:text,model:modelId||curAIModel});
}
function clearAIChat(){chatHistory=[];document.getElementById('chatMessages').innerHTML='';showToast('Chat cleared');}
function exportChat(){
  const text=chatHistory.map(m=>`[${m.role.toUpperCase()}]: ${m.content}`).join('\n\n');
  const blob=new Blob([text],{type:'text/plain'});
  const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download='consciousness_chat.txt';a.click();
}
function handleChatKey(e){if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();sendChat();}}
async function sendChat(){
  const input=document.getElementById('chatInput');
  let msg=input.value.trim();if(!msg)return;
  input.value='';addChatMsg('user',msg);
  const model=AI_MODELS.find(m=>m.id===curAIModel);
  const msgs=document.getElementById('chatMessages');
  const loadDiv=document.createElement('div');loadDiv.className='chat-msg ai';
  loadDiv.innerHTML=`<div class="ai-tag">${model.emoji} ${model.name}</div><div class="ai-loading"><span></span><span></span><span></span></div>`;
  msgs.appendChild(loadDiv);msgs.scrollTop=msgs.scrollHeight;

  const logs=getLogs().slice(0,30);
  const dreams=getDreams().slice(0,10);
  const healthData=JSON.parse(localStorage.getItem('cos_health_profile')||'{}');
  
  // Build rich context about the user
  let userContext='';
  if(logs.length){
    const avg=key=>(logs.reduce((s,e)=>s+(e[k]||e[key]||0),0)/logs.length).toFixed(1);
    const avk=key=>(logs.reduce((s,e)=>s+(e[key]||0),0)/logs.length).toFixed(1);
    const emotions={};logs.forEach(e=>{if(e.emotion)emotions[e.emotion]=(emotions[e.emotion]||0)+1;});
    const topEmo=Object.entries(emotions).sort((a,b)=>b[1]-a[1]).slice(0,3).map(([e])=>e).join(', ');
    const recent=logs.slice(0,7);const ravg=k=>(recent.reduce((s,e)=>s+(e[k]||0),0)/recent.length).toFixed(1);
    userContext+=`\n\nUSER CONSCIOUSNESS DATA (${logs.length} entries tracked):
- 7-day averages: mood=${ravg('mood')}/10, focus=${ravg('focus')}/10, energy=${ravg('physicalEnergy')}/10, stress=${ravg('stress')}/10, creativity=${ravg('creativity')}/10, flow=${ravg('flow')}/10, sleep=${ravg('sleep')}/10
- All-time averages: mood=${avk('mood')}, focus=${avk('focus')}, stress=${avk('stress')}, clarity=${avk('clarity')}
- Dominant emotions: ${topEmo||'not tracked yet'}
- Latest entry: score=${logs[0].score||'?'}, emotion=${logs[0].emotion||'?'}, time=${logs[0].time||'?'}, activity=${logs[0].activity||'?'}
${logs[0].thought?'- Latest thought: "'+logs[0].thought.slice(0,200)+'"':''}
${logs[0].insight?'- Latest insight: "'+logs[0].insight.slice(0,150)+'"':''}`;
  }
  if(dreams.length){
    const avgLucidity=(dreams.reduce((s,d)=>s+(d.lucidity||0),0)/dreams.length).toFixed(1);
    userContext+=`\n\nDREAM JOURNAL (${dreams.length} dreams): avg lucidity=${avgLucidity}/10, types=${[...new Set(dreams.map(d=>d.type))].join(', ')}`;
  }
  if(Object.keys(healthData).length>2){
    userContext+=`\n\nHEALTH PROFILE: sleep=${healthData.hSleepDur||'?'}, exercise=${healthData.hExerciseFreq||'?'}, diet=${healthData.hDiet||'?'}, mood_baseline=${healthData.hMoodBaseline||'?'}`;
  }

  // Study profile if available
  const studyData=JSON.parse(localStorage.getItem('cos_study_profile')||'{}');
  if(studyData.stField||studyData.stTargetCareer){
    userContext+=`\n\nSTUDY/CAREER PROFILE: field=${studyData.stField||'?'}, target=${studyData.stTargetCareer||'?'}, exam=${studyData.stTargetExam||'?'}`;
  }

  const systemPrompt=`${model.persona}

You are an advanced AI consciousness coach built into Consciousness OS ‚Äî a personal cognitive intelligence platform. You have deep knowledge of:
- Neuroscience, cognitive science, psychology, psychiatry
- Meditation, mindfulness, consciousness studies
- Peak performance, flow states, habit formation
- Sleep science, dream research, lucid dreaming
- Nutrition, exercise physiology, longevity research
- Career development, learning science, study optimization
- Philosophy of mind, existentialism, meaning-making
- World affairs, finance, technology trends

CRITICAL RULES:
1. You have REAL access to this user's data ‚Äî reference it naturally and specifically
2. Give SPECIFIC, ACTIONABLE advice ‚Äî not generic platitudes
3. Be GENUINELY insightful ‚Äî say things the user hasn't heard before
4. Match the conversation style ‚Äî be warm and personal, not clinical
5. If the user's data shows a pattern, POINT IT OUT directly
6. Always ground your response in their actual numbers and entries
7. Keep responses 150-250 words ‚Äî substantive but readable
${userContext}

CONVERSATION STYLE FOR THIS PERSONA: ${model.id==='friend'?'Warm, casual, use "you know", empathetic, like a brilliant friend who cares':model.id==='sage'?'Philosophical, Socratic, draw out deeper wisdom, quote thinkers, invite reflection':'Professional, data-focused, structured insights, specific protocols and recommendations'}`;

  const recentHistory=chatHistory.filter(m=>m.role==='user'||m.role==='ai').slice(-12);
  
  try{
    const resp=await fetch('https://api.anthropic.com/v1/messages',{
      method:'POST',
      headers:{'Content-Type':'application/json','anthropic-version':'2023-06-01','anthropic-dangerous-direct-browser-access':'true'},
      body:JSON.stringify({
        model:'claude-sonnet-4-20250514',
        max_tokens:800,
        system:systemPrompt,
        messages:[
          ...recentHistory.map(m=>({role:m.role==='ai'?'assistant':'user',content:m.content})),
          {role:'user',content:msg}
        ]
      })
    });
    if(!resp.ok){const err=await resp.json().catch(()=>({}));throw new Error(err.error?.message||`HTTP ${resp.status}`);}
    const data=await resp.json();
    const text=data.content?.[0]?.text;
    if(text){
      loadDiv.remove();
      // Typewriter effect for premium feel
      const aiDiv=document.createElement('div');aiDiv.className='chat-msg ai';
      aiDiv.innerHTML=`<div class="ai-tag">${model.emoji} ${model.name}</div><span id="typeTarget"></span>`;
      msgs.appendChild(aiDiv);
      const target=document.getElementById('typeTarget');
      let i=0;const speed=12;
      const type=()=>{if(i<text.length){target.textContent+=text[i++];msgs.scrollTop=msgs.scrollHeight;setTimeout(type,speed);}};
      type();
      chatHistory.push({role:'ai',content:text,model:curAIModel});
    }else{
      throw new Error('No content');
    }
  }catch(e){
    loadDiv.remove();
    addChatMsg('ai',localAIResponse(msg));
  }
  buildSuggestedQs();
}
function localAIResponse(msg){
  const logs=getLogs();if(!logs.length)return "I need your consciousness data first! Fill out your Daily Log to get personalized insights.";
  const avg=key=>(logs.reduce((s,e)=>s+(e[key]||0),0)/logs.length).toFixed(1);
  const lower=msg.toLowerCase();
  if(lower.includes('mood'))return `Your avg mood is ${avg('mood')}/10. ${parseFloat(avg('mood'))>6?'Great foundation! Keep doing what works.':'Morning sunlight, exercise, and gratitude journaling can lift it significantly.'}`;
  if(lower.includes('focus'))return `Focus avg: ${avg('focus')}/10. ${parseFloat(avg('focus'))>6?'Strong concentration!':'Try 25-min Pomodoros and no-phone zones during deep work.'}`;
  if(lower.includes('stress'))return `Stress avg: ${avg('stress')}/10. ${parseFloat(avg('stress'))>6?'High! Try 4-7-8 breathing and daily walks.':'Well managed ‚Äî this is your superpower.'}`;
  return `From your ${logs.length} entries: Best area is ${getBestDim(logs)}, growth opportunity is ${getWeakDim(logs)}. Keep logging daily for deeper patterns!`;
}
function getBestDim(logs){const dims=['mood','focus','physicalEnergy','creativity','flow'];let b=dims[0],bv=0;dims.forEach(d=>{const a=logs.reduce((s,e)=>s+(e[d]||0),0)/logs.length;if(a>bv){bv=a;b=d;}});return b+'('+bv.toFixed(1)+')';}
function getWeakDim(logs){const dims=['mood','focus','physicalEnergy','creativity','flow'];let w=dims[0],wv=10;dims.forEach(d=>{const a=logs.reduce((s,e)=>s+(e[d]||0),0)/logs.length;if(a<wv){wv=a;w=d;}});return w+'('+wv.toFixed(1)+')';}
function refreshAIInsights(){
  const el=document.getElementById('aiPatternDisplay');if(!el)return;
  const logs=getLogs();
  if(logs.length<3){el.innerHTML='<div style="font-size:13px;color:var(--text2)">Log at least 3 entries to see pattern analysis.</div>';return;}
  const avg=key=>(logs.reduce((s,e)=>s+(e[key]||0),0)/logs.length).toFixed(1);
  const recent=logs.slice(0,7),prev=logs.slice(7,14);
  const trend=key=>{if(!prev.length)return '‚û°Ô∏è';const d=recent.reduce((s,e)=>s+(e[key]||0),0)/recent.length-prev.reduce((s,e)=>s+(e[key]||0),0)/prev.length;return d>0.5?'üìà':d<-0.5?'üìâ':'‚û°Ô∏è';};
  el.innerHTML=`<div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:6px">
    ${['mood','focus','stress','creativity','sleep','flow'].map(k=>`<div style="background:var(--bg3);border-radius:10px;padding:10px;text-align:center"><div style="font-size:18px;font-weight:800;color:var(--primary)">${avg(k)}</div><div style="font-size:10px;color:var(--text3)">${k} ${trend(k)}</div></div>`).join('')}
  </div>
  <div style="margin-top:10px;font-size:13px;color:var(--text2);background:var(--bg3);border-radius:10px;padding:10px">üí° <strong>AI Insight:</strong> Based on ${logs.length} entries, strongest: ${getBestDim(logs)}, growth opportunity: ${getWeakDim(logs)}.</div>`;
}

// ‚îÄ‚îÄ‚îÄ ANALYSIS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function refreshAnalysis(){
  const logs=getLogs();
  const avg=key=>logs.length?(logs.reduce((s,e)=>s+(e[key]||0),0)/logs.length).toFixed(1):'‚Äî';
  document.getElementById('statMood').textContent=avg('mood');
  document.getElementById('statFocus').textContent=avg('focus');
  document.getElementById('statScore').textContent=avg('score');
  document.getElementById('statFlow').textContent=avg('flow');
  document.getElementById('statCreativity').textContent=avg('creativity');
  document.getElementById('statEntries').textContent=logs.length;
  buildPredictions(logs);buildTrends(logs);buildRecords(logs);buildPatterns(logs);
}
function buildPredictions(logs){
  const el=document.getElementById('predictionsArea');
  if(!logs.length){el.innerHTML='<div class="empty-state"><span class="es-icon">üîÆ</span><div class="es-text">Log 7+ entries to unlock predictions</div></div>';return;}
  const recent=logs.slice(0,7);const ar=key=>recent.reduce((s,e)=>s+(e[key]||0),0)/recent.length;
  const moodTrend=logs.length>1?logs[0].mood-logs[1].mood:0;
  el.innerHTML=`<div class="form-row">
    <div class="comparison-box"><div class="cv" style="color:var(--success)">${Math.min(10,Math.max(0,ar('focus')+moodTrend*0.5)).toFixed(1)}</div><div class="cl">Tomorrow's Focus</div></div>
    <div class="comparison-box"><div class="cv" style="color:var(--primary)">${Math.min(10,Math.max(0,ar('score')+moodTrend*0.3)).toFixed(1)}</div><div class="cl">Tomorrow's Score</div></div>
  </div>
  <div style="font-size:12px;color:var(--text2);background:var(--bg3);border-radius:10px;padding:10px">
    ${moodTrend>0.5?'‚úÖ Mood is rising ‚Äî expect better performance tomorrow!':moodTrend<-0.5?'‚ö†Ô∏è Mood is dipping ‚Äî focus on recovery tonight.':'üìä Stable trajectory. Maintain your routines.'}
  </div>`;
}
function buildTrends(logs){
  const el=document.getElementById('trendsArea');
  if(logs.length<5){el.innerHTML='<div style="font-size:13px;color:var(--text3)">Need 10+ entries for trend analysis.</div>';return;}
  const r=logs.slice(0,Math.min(10,logs.length)),p=logs.slice(10,20);
  ['mood','focus','stress','creativity','flow','sleep','motivation','clarity'].forEach(k=>{
    const ra=r.reduce((s,e)=>s+(e[k]||0),0)/r.length;const pa=p.length?p.reduce((s,e)=>s+(e[k]||0),0)/p.length:ra;
    const d=(ra-pa).toFixed(1);const icon=parseFloat(d)>0.3?'üìà +':parseFloat(d)<-0.3?'üìâ ':'‚û°Ô∏è ';
    const color=parseFloat(d)>0.3?'var(--success)':parseFloat(d)<-0.3?'var(--danger)':'var(--text3)';
    el.innerHTML+='';
  });
  el.innerHTML=['mood','focus','stress','creativity','flow','sleep','motivation','clarity'].map(k=>{
    const ra=r.reduce((s,e)=>s+(e[k]||0),0)/r.length;const pa=p.length?p.reduce((s,e)=>s+(e[k]||0),0)/p.length:ra;
    const d=(ra-pa).toFixed(1);const icon=parseFloat(d)>0.3?'üìà +':parseFloat(d)<-0.3?'üìâ ':'‚û°Ô∏è ';
    const color=parseFloat(d)>0.3?'var(--success)':parseFloat(d)<-0.3?'var(--danger)':'var(--text3)';
    return `<div class="trend-item"><span>${k}</span><span style="color:${color};font-weight:700">${icon}${Math.abs(d)}</span></div>`;
  }).join('');
}
function buildRecords(logs){
  const el=document.getElementById('recordsArea');if(!logs.length){el.innerHTML='<div class="empty-state"><span class="es-icon">üèÜ</span><div class="es-text">Start logging to track records</div></div>';return;}
  const max=key=>logs.reduce((m,e)=>Math.max(m,e[key]||0),0);
  el.innerHTML=`<div class="stats-grid"><div class="stat-box"><div class="sv">${max('score').toFixed(1)}</div><div class="sl">Best Score</div></div><div class="stat-box"><div class="sv">${max('focus')}</div><div class="sl">Peak Focus</div></div><div class="stat-box"><div class="sv">${max('flow')}</div><div class="sl">Peak Flow</div></div><div class="stat-box"><div class="sv">${max('creativity')}</div><div class="sl">Peak Creativity</div></div><div class="stat-box"><div class="sv">${max('mood')}</div><div class="sl">Best Mood</div></div><div class="stat-box"><div class="sv">${max('sleep')}</div><div class="sl">Best Sleep</div></div></div>`;
}
function buildPatterns(logs){
  const el=document.getElementById('patternsArea');
  if(logs.length<5){el.innerHTML='<div class="empty-state"><span class="es-icon">üß©</span><div class="es-text">Log 5+ entries to detect patterns</div></div>';return;}
  const emotions={};logs.forEach(e=>{if(e.emotion)emotions[e.emotion]=(emotions[e.emotion]||0)+1;});
  const top=Object.entries(emotions).sort((a,b)=>b[1]-a[1]).slice(0,6);
  el.innerHTML=`<div style="margin-bottom:10px"><div style="font-weight:700;font-size:13px;margin-bottom:6px">Dominant Emotions:</div>${top.map(([em,n])=>`<span class="chip">${em} √ó${n}</span>`).join('')}</div>`;
}

// ‚îÄ‚îÄ‚îÄ HEALTH ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const HEALTH_SECTIONS=[
  {name:'Demographics',icon:'üë§',fields:[{type:'text',id:'hAge',label:'Age'},{type:'radio',id:'hSex',label:'Biological Sex',options:['Male','Female','Intersex','Prefer not to say']},{type:'height',id:'hHeight',label:'Height'},{type:'weight',id:'hWeight',label:'Weight'},{type:'text',id:'hWaist',label:'Waist (cm)'},{type:'select',id:'hOccupation',label:'Occupation Type',options:['Sedentary (desk work)','Light activity','Moderate activity','Active (physical labor)','Very active (athlete/trainer)']},{type:'select',id:'hEnvironment',label:'Environment',options:['Urban','Suburban','Rural','Remote']}]},
  {name:'Medical History',icon:'üè•',fields:[{type:'checkbox',id:'hConditions',label:'Existing Conditions',options:['Diabetes','Hypertension','Heart Disease','Asthma','Thyroid','Arthritis','Depression','Anxiety','ADHD','None']},{type:'textarea',id:'hMeds',label:'Current Medications / Supplements'},{type:'radio',id:'hHosp',label:'Hospitalized in last 2 years?',options:['Yes','No']},{type:'textarea',id:'hAllergies',label:'Known Allergies'}]},
  {name:'Family History',icon:'üß¨',fields:[{type:'checkbox',id:'hFamily',label:'Family History of:',options:['Heart Disease','Diabetes','Cancer','Stroke','Alzheimer\'s','Mental Illness','Autoimmune','Longevity (90+ years)','None']}]},
  {name:'Diet & Nutrition',icon:'ü•ó',fields:[{type:'select',id:'hMeals',label:'Meals per day',options:['1','2','3','4','5+','Intermittent Fasting']},{type:'select',id:'hDiet',label:'Dietary Pattern',options:['Omnivore','Vegetarian','Vegan','Keto','Paleo','Mediterranean','Carnivore','Other']},{type:'select',id:'hWater',label:'Daily Water',options:['<1L','1-2L','2-3L','3-4L','>4L']},{type:'select',id:'hProcessed',label:'Processed Food',options:['Never','Rarely','Sometimes','Often','Daily']},{type:'textarea',id:'hIntolerances',label:'Food Intolerances'}]},
  {name:'Substance Use',icon:'‚òï',fields:[{type:'radio',id:'hSmoking',label:'Smoking',options:['Never','Former','Current']},{type:'select',id:'hAlcohol',label:'Alcohol',options:['Never','Rarely','1-3/week','4-7/week','Daily','Heavy (>14/week)']},{type:'select',id:'hCaffeine',label:'Caffeine',options:['None','1 cup/day','2-3 cups/day','4+ cups/day']}]},
  {name:'Physical Activity',icon:'üèÉ',fields:[{type:'select',id:'hExerciseFreq',label:'Exercise Frequency',options:['Never','1-2x/week','3-4x/week','5-6x/week','Daily','Twice daily']},{type:'checkbox',id:'hExTypes',label:'Exercise Types',options:['Cardio','Strength','Yoga','Martial Arts','Swimming','Cycling','Running','Walking']},{type:'number',id:'hSteps',label:'Avg Daily Steps'},{type:'number',id:'hHR',label:'Resting Heart Rate (bpm)'},{type:'number',id:'hVO2',label:'VO2 Max (if known)'}]},
  {name:'Sleep Health',icon:'üò¥',fields:[{type:'select',id:'hSleepDur',label:'Average Sleep Duration',options:['<5h','5-6h','6-7h','7-8h','8-9h','>9h']},{type:'time',id:'hBedtime',label:'Usual Bedtime'},{type:'time',id:'hWakeTime',label:'Usual Wake Time'},{type:'checkbox',id:'hSleepIssues',label:'Sleep Issues',options:['Insomnia','Sleep Apnea','Snoring','Restless Legs','Night Sweats','Sleepwalking','None']}]},
  {name:'Mental Health',icon:'üß†',fields:[{type:'select',id:'hMoodBaseline',label:'Mood Baseline',options:['Very low','Low','Neutral','Good','Excellent']},{type:'select',id:'hAnxiety',label:'Anxiety Level',options:['None','Mild','Moderate','Severe']},{type:'radio',id:'hDepression',label:'History of Depression?',options:['Yes (current)','Yes (past)','No']},{type:'radio',id:'hADHD',label:'ADHD?',options:['Yes','No','Suspected']},{type:'select',id:'hBurnout',label:'Current Burnout',options:['None','Mild','Moderate','Severe']},{type:'select',id:'hLifeSat',label:'Life Satisfaction',options:['Very unsatisfied','Unsatisfied','Neutral','Satisfied','Very satisfied']}]},
  {name:'Hormonal Health',icon:'‚öóÔ∏è',fields:[{type:'select',id:'hEnergyPatt',label:'Daily Energy Pattern',options:['Morning person','Evening person','Consistent','Variable']},{type:'select',id:'hLibido',label:'Libido',options:['Very low','Low','Normal','High']},{type:'radio',id:'hThyroid',label:'Thyroid issues?',options:['Yes','No','Unknown']}]},
  {name:'Cardiometabolic',icon:'‚ù§Ô∏è',fields:[{type:'text',id:'hBP',label:'Blood Pressure (e.g. 120/80)'},{type:'text',id:'hHbA1c',label:'HbA1c % (if known)'},{type:'select',id:'hCholesterol',label:'Cholesterol',options:['Optimal','Borderline','High','Unknown']},{type:'checkbox',id:'hHeartSymp',label:'Heart Symptoms',options:['Chest pain','Palpitations','Shortness of breath','Swollen ankles','None']}]},
  {name:'Digestive Health',icon:'ü´Å',fields:[{type:'select',id:'hDigestion',label:'General Digestion',options:['Excellent','Good','Fair','Poor']},{type:'checkbox',id:'hGutIssues',label:'Gut Issues',options:['Bloating','Gas','Acid Reflux','IBS','IBD','Constipation','Diarrhea','None']},{type:'select',id:'hBowel',label:'Bowel Frequency',options:['Multiple/day','Once/day','Every 2-3 days','Less frequent']}]},
  {name:'Immune & Inflammation',icon:'üõ°Ô∏è',fields:[{type:'select',id:'hImmune',label:'How often sick?',options:['Rarely (<1/year)','Occasionally (1-2/year)','Sometimes (3-4/year)','Frequently (>4/year)']},{type:'checkbox',id:'hInflam',label:'Inflammation Signs',options:['Joint Pain','Skin Issues','Chronic Fatigue','Brain Fog','Autoimmune','None']}]},
  {name:'Neurology & Pain',icon:'‚ö°',fields:[{type:'select',id:'hHeadaches',label:'Headaches',options:['Never','Rarely','Monthly','Weekly','Daily']},{type:'checkbox',id:'hNeuro',label:'Neurological',options:['Dizziness','Memory Issues','Neuropathy','Vision Problems','None']},{type:'select',id:'hPain',label:'Chronic Pain',options:['None','Mild (1-3)','Moderate (4-6)','Severe (7-10)']}]},
  {name:'Environment',icon:'üåç',fields:[{type:'select',id:'hAirQ',label:'Air Quality',options:['Excellent','Good','Moderate','Poor']},{type:'select',id:'hScreenTime',label:'Daily Screen Time',options:['<2h','2-4h','4-6h','6-8h','>8h']},{type:'checkbox',id:'hEnvExp',label:'Exposures',options:['Traffic Pollution','Chemical Exposure','Noise Pollution','Poor Ergonomics','Excessive Blue Light','None']}]},
  {name:'Preventive Health',icon:'üî¨',fields:[{type:'select',id:'hBloodTest',label:'Last Blood Work',options:['Within 6 months','6-12 months ago','1-2 years ago','2+ years ago','Never']},{type:'select',id:'hDental',label:'Last Dental Checkup',options:['Within 6 months','6-12 months','1-2 years','2+ years','Never']},{type:'text',id:'hBioAge',label:'Biological Age Test Result (if done)'}]},
  {name:'Functional Capacity',icon:'üèãÔ∏è',fields:[{type:'select',id:'hStairs',label:'Climb 3 flights easily?',options:['Easily','Yes with effort','With difficulty','No']},{type:'select',id:'hBalance',label:'Balance',options:['Excellent','Good','Fair','Poor']},{type:'select',id:'hEnergyDay',label:'Energy throughout day',options:['Consistent','Morning peaks','Afternoon crashes','Evening peaks','Very variable']}]},
  {name:'Longevity Markers',icon:'‚è≥',fields:[{type:'text',id:'hEpigenetic',label:'Epigenetic Clock Result (if known)'},{type:'text',id:'hHormones',label:'Hormone Panel (if known)'},{type:'select',id:'hGrip',label:'Grip Strength',options:['Very strong','Strong','Average','Weak']}]},
  {name:'Health Goals',icon:'üéØ',fields:[{type:'checkbox',id:'hGoals',label:'My Health Priorities',options:['Longevity','Peak Performance','Mental Health','Weight Management','Disease Prevention','Energy & Vitality','Better Sleep','Strength & Fitness','Stress Reduction']},{type:'textarea',id:'hMainConcern',label:'Main Health Concern'},{type:'textarea',id:'hHealthNotes',label:'Anything else?'}]},
];
let hsCurrent=0;
function buildHealthSections(){
  const jumpBar=document.getElementById('healthJumpBar');const container=document.getElementById('healthSectionsContainer');
  if(!jumpBar||!container)return;
  jumpBar.innerHTML=HEALTH_SECTIONS.map((s,i)=>`<button class="section-jump${i===0?' active':''}" onclick="jumpToSection(${i})" title="${s.name}">${s.icon} ${i+1}</button>`).join('');
  container.innerHTML=HEALTH_SECTIONS.map((s,i)=>`<div class="health-section card${i===0?' active':''}" id="hSection_${i}"><div class="card-title"><span class="emoji">${s.icon}</span> ${s.name}</div>${buildHFields(s.fields)}</div>`).join('');
}
function buildHFields(fields){
  return fields.map(f=>{
    if(f.type==='height')return `<div class="form-group"><label class="form-label">${f.label}</label><div style="display:flex;gap:6px;align-items:center"><input type="number" class="form-input" id="${f.id}_cm" placeholder="cm" style="flex:1" oninput="syncH('cm')"><span style="font-size:12px;color:var(--text3)">cm</span><input type="number" class="form-input" id="${f.id}_ft" placeholder="ft" style="flex:.7" oninput="syncH('ft')"><span style="font-size:12px;color:var(--text3)">ft</span><input type="number" class="form-input" id="${f.id}_in" placeholder="in" style="flex:.7" oninput="syncH('ft')"><span style="font-size:12px;color:var(--text3)">in</span></div></div>`;
    if(f.type==='weight')return `<div class="form-group"><label class="form-label">${f.label}</label><div style="display:flex;gap:6px;align-items:center"><input type="number" class="form-input" id="${f.id}_kg" placeholder="kg" style="flex:1" oninput="syncW('kg')"><span style="font-size:12px;color:var(--text3)">kg</span><input type="number" class="form-input" id="${f.id}_lb" placeholder="lbs" style="flex:1" oninput="syncW('lb')"><span style="font-size:12px;color:var(--text3)">lbs</span></div></div>`;
    if(f.type==='radio')return `<div class="form-group"><label class="form-label">${f.label}</label><div style="display:flex;gap:8px;flex-wrap:wrap">${f.options.map(o=>`<label style="display:flex;align-items:center;gap:4px;font-size:13px;cursor:pointer"><input type="radio" name="${f.id}" value="${o}"> ${o}</label>`).join('')}</div></div>`;
    if(f.type==='checkbox')return `<div class="form-group"><label class="form-label">${f.label}</label><div style="display:flex;gap:6px;flex-wrap:wrap">${f.options.map(o=>`<label style="display:flex;align-items:center;gap:4px;font-size:12px;cursor:pointer;background:var(--bg);border:1px solid var(--border);padding:4px 8px;border-radius:8px"><input type="checkbox" name="${f.id}" value="${o}"> ${o}</label>`).join('')}</div></div>`;
    if(f.type==='textarea')return `<div class="form-group"><label class="form-label">${f.label}</label><textarea class="form-textarea" id="${f.id}" style="min-height:60px"></textarea></div>`;
    if(f.type==='select')return `<div class="form-group"><label class="form-label">${f.label}</label><select class="form-select" id="${f.id}">${f.options.map(o=>`<option>${o}</option>`).join('')}</select></div>`;
    return `<div class="form-group"><label class="form-label">${f.label}</label><input type="${f.type||'text'}" class="form-input" id="${f.id}"></div>`;
  }).join('');
}
function syncH(from){
  const cm=parseFloat(document.getElementById('hHeight_cm')?.value)||0;const ft=parseFloat(document.getElementById('hHeight_ft')?.value)||0;const inc=parseFloat(document.getElementById('hHeight_in')?.value)||0;
  if(from==='cm'&&cm){const totalIn=cm/2.54;document.getElementById('hHeight_ft').value=Math.floor(totalIn/12);document.getElementById('hHeight_in').value=Math.round(totalIn%12);}
  else if(from==='ft'){const totalCm=(ft*12+inc)*2.54;if(document.getElementById('hHeight_cm'))document.getElementById('hHeight_cm').value=Math.round(totalCm);}
}
function syncW(from){
  const kg=parseFloat(document.getElementById('hWeight_kg')?.value)||0;const lb=parseFloat(document.getElementById('hWeight_lb')?.value)||0;
  if(from==='kg'&&kg)document.getElementById('hWeight_lb').value=(kg*2.20462).toFixed(1);
  else if(from==='lb'&&lb)document.getElementById('hWeight_kg').value=(lb/2.20462).toFixed(1);
}
function jumpToSection(i){
  document.querySelectorAll('.health-section').forEach((s,j)=>s.classList.toggle('active',j===i));
  document.querySelectorAll('.section-jump').forEach((b,j)=>b.classList.toggle('active',j===i));
  hsCurrent=i;
  document.getElementById('hsCurrent').textContent=i+1;
  document.getElementById('hsSectionName').textContent=HEALTH_SECTIONS[i].name;
  document.getElementById('hsProgressBar').style.width=((i+1)/18*100)+'%';
  document.getElementById('hsPrevBtn').style.display=i>0?'':'none';
  document.getElementById('hsNextBtn').textContent=i===17?'‚ú® Get AI Analysis':'Next ‚Üí';
}
function hsPrev(){if(hsCurrent>0)jumpToSection(hsCurrent-1);}
function hsNext(){if(hsCurrent<17)jumpToSection(hsCurrent+1);else generateHealthAnalysis();}
async function generateHealthAnalysis(){
  const card=document.getElementById('aiDoctorCard');const output=document.getElementById('aiDoctorOutput');
  card.style.display='block';
  output.innerHTML='<div class="ai-loading"><span></span><span></span><span></span></div> <span style="font-size:13px;color:var(--text2)">AI Doctor analyzing...</span>';
  card.scrollIntoView({behavior:'smooth'});
  const kg=document.getElementById('hWeight_kg')?.value||0;const cm=document.getElementById('hHeight_cm')?.value||0;
  const bmi=kg&&cm?(kg/((cm/100)**2)).toFixed(1):'Unknown';
  const age=document.getElementById('hAge')?.value||'Unknown';
  await new Promise(r=>setTimeout(r,1500));
  output.innerHTML=`<div style="background:linear-gradient(135deg,rgba(124,58,237,.1),rgba(16,185,129,.1));border-radius:12px;padding:14px;margin-bottom:12px">
    <div style="font-weight:800;font-family:Syne,sans-serif;font-size:16px;margin-bottom:8px">üìä Health Summary</div>
    <div class="stats-grid"><div class="stat-box"><div class="sv">${bmi}</div><div class="sl">BMI</div></div><div class="stat-box"><div class="sv">${age}</div><div class="sl">Age</div></div></div>
  </div>
  <div style="font-size:13px;color:var(--text2);line-height:1.7">
    <p><strong>üéØ AI Doctor Recommendations:</strong></p>
    <p>‚Ä¢ <strong>Sleep optimization</strong> is the foundational pillar ‚Äî every other metric improves when sleep quality exceeds 7.</p>
    <p>‚Ä¢ <strong>Omega-3 rich foods</strong> (salmon, flaxseed, walnuts) significantly improve cognitive function and reduce inflammation.</p>
    <p>‚Ä¢ <strong>7,000-10,000 daily steps</strong> improves cardiovascular, cognitive, and mental health simultaneously.</p>
    <p>‚Ä¢ Schedule a <strong>comprehensive blood panel</strong> ‚Äî thyroid, vitamin D, B12, ferritin, CRP, testosterone.</p>
    <p>‚Ä¢ Consider a <strong>30-day elimination diet</strong> to identify food sensitivities affecting your energy and cognition.</p>
    <p>‚Ä¢ Daily <strong>cold exposure</strong> (2-min cold shower) boosts dopamine 250% and norepinephrine 300% for up to 3 hours.</p>
    <p style="margin-top:10px;font-size:11px;color:var(--text3)">‚öïÔ∏è Educational only. Always consult a qualified physician for medical decisions.</p>
  </div>`;
}

// ‚îÄ‚îÄ‚îÄ BRAIN GAMES ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const GAMES_LIST=[
  {id:'memory',name:'Memory Match',emoji:'üÉè',desc:'Find matching pairs',tag:'Working Memory'},
  {id:'reaction',name:'Reaction Time',emoji:'‚ö°',desc:'How fast are you?',tag:'Processing Speed'},
  {id:'stroop',name:'Stroop Challenge',emoji:'üé®',desc:'Name the ink color',tag:'Cognitive Control'},
  {id:'nback',name:'N-Back Memory',emoji:'üî¢',desc:'2-back working memory',tag:'Working Memory'},
  {id:'math',name:'Math Blitz',emoji:'‚ûï',desc:'Mental arithmetic speed',tag:'Numerical Cognition'},
  {id:'word',name:'Word Chain',emoji:'üí¨',desc:'Word association chain',tag:'Language'},
  {id:'color',name:'Color Sequence',emoji:'üåà',desc:'Remember the pattern',tag:'Sequential Memory'},
  {id:'sudoku',name:'Sudoku',emoji:'üß©',desc:'Logic and deduction',tag:'Logical Reasoning'},
  {id:'pattern',name:'Pattern Recognition',emoji:'üëÅÔ∏è',desc:'Find the odd one out',tag:'Visual Intelligence'},
  {id:'typing',name:'Speed Typing',emoji:'‚å®Ô∏è',desc:'Type fast and accurately',tag:'Processing Speed'},
  {id:'spatial',name:'Spatial Rotation',emoji:'üîÑ',desc:'Mental rotation puzzle',tag:'Spatial Intelligence'},
  {id:'breathing',name:'Focus Breathing',emoji:'ü´Å',desc:'4-7-8 breathing',tag:'Mindfulness'},
  {id:'simon',name:'Simon Says',emoji:'üéµ',desc:'Repeat color sequences',tag:'Sequential Memory'},
  {id:'anagram',name:'Anagram Solver',emoji:'üî§',desc:'Unscramble the word',tag:'Language & Logic'},
  {id:'trivia',name:'Mind Trivia',emoji:'üß†',desc:'Science, logic & facts',tag:'Knowledge'},
  {id:'estimate',name:'Fermi Estimator',emoji:'üìè',desc:'Estimate the answer',tag:'Quantitative Reasoning'},
  {id:'sequence',name:'Number Sequence',emoji:'üî¢',desc:'Find the next number',tag:'Pattern Recognition'},
  {id:'speed_read',name:'Speed Reader',emoji:'üìñ',desc:'Train reading speed',tag:'Processing Speed'},
];
function buildGamesGrid(){
  const grid=document.getElementById('gamesGrid');if(!grid)return;
  grid.innerHTML=GAMES_LIST.map(g=>`<div class="game-card" onclick="launchGame('${g.id}')"><span class="g-emoji">${g.emoji}</span><div class="g-name">${g.name}</div><div class="g-desc">${g.desc}</div><div class="g-tag">${g.tag}</div></div>`).join('');
}
let activeGame=null;
function launchGame(id){
  document.getElementById('gamesMenu').style.display='none';
  const c=document.getElementById('gameContainer');c.innerHTML='';activeGame=id;
  const games={memory:renderMemoryGame,reaction:renderReactionGame,stroop:renderStroopGame,nback:renderNBackGame,math:renderMathGame,word:renderWordGame,color:renderColorGame,sudoku:renderSudokuGame,pattern:renderPatternGame,typing:renderTypingGame,spatial:renderSpatialGame,breathing:renderBreathingGame,simon:renderSimonGame,anagram:renderAnagramGame,trivia:renderTriviaGame,estimate:renderFermiGame,sequence:renderSequenceGame,speed_read:renderSpeedReadGame};
  if(games[id])games[id](c);
}
function backToGames(){document.getElementById('gamesMenu').style.display='';document.getElementById('gameContainer').innerHTML='';activeGame=null;}
function gameHeader(title,emoji,l1,l2){return `<div class="game-header"><button class="btn btn-secondary btn-sm" onclick="backToGames()">‚Üê Back</button><div style="flex:1;font-family:Syne,sans-serif;font-weight:800;font-size:18px">${emoji} ${title}</div></div><div class="game-score-bar"><div class="gs"><div class="gsv" id="gs1">0</div><div class="gsl">${l1}</div></div><div class="gs"><div class="gsv" id="gs2">-</div><div class="gsl">${l2}</div></div></div>`;}
function renderMemoryGame(c){
  const emojis=['üê∂','üê±','üê≠','üêπ','üê∞','ü¶ä','üêª','üêº'];
  let cards=[...emojis,...emojis].sort(()=>Math.random()-.5),flipped=[],matched=[],moves=0,canFlip=true;
  c.innerHTML=gameHeader('Memory Match','üÉè','Moves','Pairs')+`<div id="memGrid" style="display:grid;grid-template-columns:repeat(4,1fr);gap:8px;max-width:340px;margin:0 auto"></div><button class="btn btn-secondary btn-sm" onclick="launchGame('memory')" style="margin-top:10px;width:100%">üîÑ New</button>`;
  const grid=document.getElementById('memGrid');
  cards.forEach((em,i)=>{
    const div=document.createElement('div');
    div.style.cssText='aspect-ratio:1;background:var(--bg3);border:2px solid var(--border);border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:28px;cursor:pointer;transition:all .3s';
    div.textContent='?';div.dataset.emoji=em;div.dataset.idx=i;
    div.onclick=function(){
      if(!canFlip||flipped.includes(i)||matched.includes(i))return;
      div.textContent=em;div.style.background='rgba(124,58,237,.15)';flipped.push(i);
      if(flipped.length===2){canFlip=false;moves++;document.getElementById('gs1').textContent=moves;
        const[a,b]=flipped;
        if(cards[a]===cards[b]){matched.push(a,b);flipped=[];canFlip=true;document.getElementById('gs2').textContent=matched.length/2;
          grid.children[a].style.borderColor='var(--success)';grid.children[b].style.borderColor='var(--success)';
          if(matched.length===cards.length)showToast('üéâ Done in '+moves+' moves!');
        }else{setTimeout(()=>{[a,b].forEach(x=>{grid.children[x].textContent='?';grid.children[x].style.background='var(--bg3)';});flipped=[];canFlip=true;},900);}
      }
    };grid.appendChild(div);
  });
}
function renderReactionGame(c){
  let state='idle',startTime,trials=[],th;
  c.innerHTML=gameHeader('Reaction Time','‚ö°','Trial','Avg ms')+`<div id="rBox" onclick="rClick()" style="height:200px;border-radius:16px;background:var(--bg3);display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;border:2px solid var(--border);transition:background .3s;user-select:none"><div id="rMsg" style="font-size:18px;font-weight:700">Tap to Start</div><div id="rSub" style="font-size:13px;color:var(--text3);margin-top:6px"></div></div><div id="rRes" style="margin-top:12px"></div>`;
  window.rClick=function(){
    if(state==='idle'){state='wait';document.getElementById('rMsg').textContent='Wait for green...';th=setTimeout(()=>{state='go';document.getElementById('rBox').style.background='var(--success)';document.getElementById('rMsg').textContent='TAP!';document.getElementById('rMsg').style.color='#fff';startTime=Date.now();},1000+Math.random()*3000);}
    else if(state==='wait'){clearTimeout(th);state='idle';document.getElementById('rBox').style.background='var(--danger)';document.getElementById('rMsg').textContent='Too early!';document.getElementById('rMsg').style.color='#fff';setTimeout(()=>{document.getElementById('rBox').style.background='var(--bg3)';document.getElementById('rMsg').textContent='Tap to Start';document.getElementById('rMsg').style.color='';},1000);}
    else if(state==='go'){const rt=Date.now()-startTime;trials.push(rt);state='idle';
      document.getElementById('rBox').style.background='var(--primary)';document.getElementById('rMsg').textContent=rt+'ms';document.getElementById('rMsg').style.color='#fff';
      document.getElementById('gs1').textContent=trials.length+'/5';
      if(trials.length>=5){const avg=Math.round(trials.reduce((a,b)=>a+b)/trials.length);document.getElementById('gs2').textContent=avg;
        document.getElementById('rRes').innerHTML=`<div class="card" style="text-align:center"><div style="font-size:22px;font-weight:800;color:var(--primary)">${avg}ms</div><div style="color:var(--text3)">${avg<200?'üèÜ Elite':avg<300?'ü•á Excellent':avg<400?'‚úÖ Good':'üìà Keep practicing'}</div></div>`;trials=[];
      }else{setTimeout(()=>{state='idle';document.getElementById('rBox').style.background='var(--bg3)';document.getElementById('rMsg').textContent='Tap for next trial';document.getElementById('rMsg').style.color='';},1200);}
    }
  };
}
function renderStroopGame(c){
  const CL={Red:'#ef4444',Blue:'#3b82f6',Green:'#10b981',Yellow:'#f59e0b',Purple:'#8b5cf6'};
  const cn=Object.keys(CL);let score=0,total=0,tl=60,timer;
  c.innerHTML=gameHeader('Stroop','üé®','Score','Time')+`<div style="text-align:center"><div style="font-size:13px;color:var(--text2);margin-bottom:12px">Tap the <strong>INK COLOR</strong> ‚Äî ignore the word!</div><div id="stWord" style="font-size:52px;font-weight:800;font-family:Syne,sans-serif;margin-bottom:16px">RED</div><div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px;max-width:300px;margin:0 auto" id="stBtns"></div></div>`;
  function next(){
    const w=cn[Math.floor(Math.random()*cn.length)],col=cn[Math.floor(Math.random()*cn.length)];
    document.getElementById('stWord').textContent=w;document.getElementById('stWord').style.color=CL[col];
    document.getElementById('stBtns').innerHTML=cn.sort(()=>Math.random()-.5).map(n=>`<button style="padding:10px;border-radius:10px;border:2px solid var(--border);background:${CL[n]};color:#fff;font-weight:700;cursor:pointer" onclick="stAns('${n}','${col}')">${n}</button>`).join('');
  }
  window.stAns=function(ans,correct){total++;if(ans===correct){score++;document.getElementById('gs1').textContent=score;showToast('‚úÖ');}else showToast('‚ùå '+correct);next();};
  timer=setInterval(()=>{tl--;document.getElementById('gs2').textContent=tl;if(tl<=0){clearInterval(timer);document.getElementById('stWord').textContent='Done! '+score+'/'+total;document.getElementById('stBtns').innerHTML='';}},1000);
  document.getElementById('gs2').textContent=tl;next();
}
function renderNBackGame(c){
  const pos=[0,1,2,3,4,5,6,7,8];let seq=[],idx=0,score=0,misses=0;
  c.innerHTML=gameHeader('2-Back','üî¢','Correct','Miss')+`<div style="text-align:center;font-size:12px;color:var(--text2);margin-bottom:10px">Press MATCH when position matches 2 steps back</div><div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px;max-width:200px;margin:0 auto 16px">${pos.map(p=>`<div style="aspect-ratio:1;border-radius:8px;background:var(--bg3);border:2px solid var(--border);transition:all .3s" id="nb_${p}"></div>`).join('')}</div><div style="text-align:center"><button class="btn btn-primary" id="nbS" onclick="nbGo()">‚ñ∂ Start</button><button class="btn btn-accent" id="nbM" onclick="nbMatch()" style="display:none;margin-left:8px">MATCH</button></div>`;
  window.nbGo=function(){seq=[];idx=0;score=0;misses=0;document.getElementById('nbS').style.display='none';document.getElementById('nbM').style.display='';
    function step(){if(idx>=20){document.getElementById('nbM').style.display='none';document.getElementById('nbS').style.display='';document.getElementById('nbS').textContent='üîÑ Again';showToast('Score: '+score);return;}
      const p=pos[Math.floor(Math.random()*9)];seq.push(p);pos.forEach(p2=>document.getElementById('nb_'+p2).style.background='var(--bg3)');
      document.getElementById('nb_'+p).style.background='var(--primary)';setTimeout(()=>{document.getElementById('nb_'+p).style.background='var(--bg3)';idx++;setTimeout(step,800);},500);}
    step();};
  window.nbMatch=function(){if(seq.length>=2&&seq[seq.length-1]===seq[seq.length-3]){score++;document.getElementById('gs1').textContent=score;showToast('‚úÖ');}else{misses++;document.getElementById('gs2').textContent=misses;showToast('‚ùå');}};
}
function renderMathGame(c){
  let score=0,cur=0,a,b,op,ans,tl=90,timer;const ops=['+','-','√ó'];
  c.innerHTML=gameHeader('Math Blitz','‚ûï','Score','Time')+`<div style="text-align:center"><div id="mathP" style="font-size:40px;font-weight:800;font-family:Syne,sans-serif;color:var(--primary);margin-bottom:16px"></div><input type="number" id="mathI" class="form-input" placeholder="?" style="text-align:center;font-size:20px;max-width:160px;margin:0 auto 12px;display:block" onkeydown="if(event.key==='Enter')chkM()"><button class="btn btn-primary" onclick="chkM()">Submit</button></div>`;
  timer=setInterval(()=>{tl--;document.getElementById('gs2').textContent=tl;if(tl<=0){clearInterval(timer);showToast('Time! '+score);}},1000);
  function nxt(){op=ops[Math.floor(Math.random()*3)];a=Math.floor(Math.random()*20)+1;b=Math.floor(Math.random()*20)+1;ans=op==='+'?a+b:op==='-'?a-b:a*b;document.getElementById('mathP').textContent=`${a} ${op} ${b} = ?`;document.getElementById('mathI').value='';document.getElementById('mathI').focus();}
  window.chkM=function(){const v=parseInt(document.getElementById('mathI').value);cur++;if(v===ans){score++;document.getElementById('gs1').textContent=score;showToast('‚úÖ');}else showToast('‚ùå '+ans);nxt();};
  document.getElementById('gs2').textContent=tl;nxt();
}
function renderWordGame(c){
  let score=0,tl=60,timer,chain=[],last='';
  c.innerHTML=gameHeader('Word Chain','üí¨','Words','Time')+`<div style="text-align:center"><div style="font-size:13px;color:var(--text2);margin-bottom:8px">Each word must START with the LAST LETTER of the previous</div><div id="wLast" style="font-size:32px;font-weight:800;color:var(--primary);margin-bottom:10px">Any word to start</div><div style="display:flex;gap:8px"><input type="text" id="wI" class="form-input" placeholder="Type a word..." onkeydown="if(event.key==='Enter')chkW()"><button class="btn btn-primary" onclick="chkW()">Go</button></div><div id="wChain" style="margin-top:8px;font-size:12px;color:var(--text2);max-height:80px;overflow-y:auto"></div></div>`;
  timer=setInterval(()=>{tl--;document.getElementById('gs2').textContent=tl;if(tl<=0){clearInterval(timer);showToast('Time! '+score+' words!');}},1000);document.getElementById('gs2').textContent=tl;
  window.chkW=function(){const w=document.getElementById('wI').value.trim().toLowerCase();if(!w)return;if(last&&w[0]!==last){showToast('Must start with '+last.toUpperCase());return;}if(chain.includes(w)){showToast('Already used!');return;}chain.push(w);last=w[w.length-1];score++;document.getElementById('gs1').textContent=score;document.getElementById('wLast').textContent='Next: '+last.toUpperCase();document.getElementById('wChain').textContent=chain.join(' ‚Üí ');document.getElementById('wI').value='';document.getElementById('wI').focus();};
}
function renderColorGame(c){
  const CL=['#ef4444','#3b82f6','#10b981','#f59e0b','#8b5cf6'];let seq=[],usr=[],lv=1,canClick=false;
  c.innerHTML=gameHeader('Color Sequence','üåà','Level','‚Äî')+`<div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px;max-width:220px;margin:0 auto 14px">${CL.map((cl,i)=>`<div id="cb_${i}" onclick="ccl(${i})" style="aspect-ratio:1;border-radius:12px;background:${cl};cursor:pointer;border:3px solid transparent;transition:all .2s"></div>`).join('')}</div><div style="text-align:center"><button class="btn btn-primary" id="cgS" onclick="cgStart()">‚ñ∂ Start</button></div><div id="cgM" style="text-align:center;margin-top:8px;font-size:13px;color:var(--text2)"></div>`;
  function flash(i){return new Promise(r=>{document.getElementById('cb_'+i).style.opacity='0.3';setTimeout(()=>{document.getElementById('cb_'+i).style.opacity='1';r();},350);});}
  async function play(){canClick=false;document.getElementById('cgM').textContent='Watch...';for(const i of seq){await flash(i);await new Promise(r=>setTimeout(r,200));}canClick=true;usr=[];document.getElementById('cgM').textContent='Your turn!';}
  window.cgStart=function(){seq=[];lv=1;document.getElementById('cgS').style.display='none';add();};
  function add(){seq.push(Math.floor(Math.random()*CL.length));document.getElementById('gs1').textContent=lv;play();}
  window.ccl=function(i){if(!canClick)return;flash(i);usr.push(i);const p=usr.length-1;if(usr[p]!==seq[p]){canClick=false;document.getElementById('cgM').textContent='‚ùå Game Over! Level '+lv;document.getElementById('gs2').textContent=lv;document.getElementById('cgS').style.display='';lv=1;seq=[];return;}if(usr.length===seq.length){canClick=false;lv++;setTimeout(add,600);}};
}
function renderSudokuGame(c){
  const p=[[5,3,0,0,7,0,0,0,0],[6,0,0,1,9,5,0,0,0],[0,9,8,0,0,0,0,6,0],[8,0,0,0,6,0,0,0,3],[4,0,0,8,0,3,0,0,1],[7,0,0,0,2,0,0,0,6],[0,6,0,0,0,0,2,8,0],[0,0,0,4,1,9,0,0,5],[0,0,0,0,8,0,0,7,9]];
  let sel=null,errors=0;
  c.innerHTML=gameHeader('Sudoku','üß©','Errors','‚Äî')+`<div id="sgrid" style="display:grid;grid-template-columns:repeat(9,1fr);gap:1px;background:var(--border);border:2px solid var(--primary);border-radius:8px;overflow:hidden;max-width:340px;margin:0 auto 10px"></div><div style="display:grid;grid-template-columns:repeat(9,1fr);gap:4px;max-width:340px;margin:0 auto 10px">${[1,2,3,4,5,6,7,8,9].map(n=>`<div class="sudoku-num" onclick="snI(${n})">${n}</div>`).join('')}</div><button class="btn btn-secondary btn-sm" onclick="launchGame('sudoku')">üîÑ New</button>`;
  const grid=document.getElementById('sgrid');
  for(let r=0;r<9;r++)for(let cl2=0;cl2<9;cl2++){
    const d=document.createElement('div');d.className='sudoku-cell';d.dataset.r=r;d.dataset.c=cl2;
    if(p[r][cl2]){d.textContent=p[r][cl2];d.classList.add('given');}
    d.onclick=function(){document.querySelectorAll('.sudoku-cell').forEach(x=>x.classList.remove('selected'));if(!d.classList.contains('given')){sel=d;d.classList.add('selected');}};
    grid.appendChild(d);
  }
  window.snI=function(n){if(!sel||sel.classList.contains('given'))return;sel.textContent=n;};
}
function renderPatternGame(c){
  let score=0,tl=60,timer;const shapes=['‚óè','‚ñ†','‚ñ≤','‚òÖ','‚óÜ'];
  c.innerHTML=gameHeader('Pattern Recognition','üëÅÔ∏è','Score','Time')+`<div style="text-align:center;font-size:13px;color:var(--text2);margin-bottom:10px">Which one is DIFFERENT?</div><div id="pArea" style="display:grid;grid-template-columns:repeat(3,1fr);gap:10px;max-width:300px;margin:0 auto 10px"></div><div id="pFb" style="text-align:center;min-height:24px;font-size:14px;font-weight:700"></div>`;
  function nxt(){
    const sh=shapes[Math.floor(Math.random()*shapes.length)];const odd=shapes.filter(s=>s!==sh)[Math.floor(Math.random()*4)];
    const items=Array(5).fill(sh);const oi=Math.floor(Math.random()*6);items.splice(oi,0,odd);
    const clr=['#7c3aed','#06b6d4','#ec4899','#10b981','#f59e0b'][Math.floor(Math.random()*5)];
    document.getElementById('pArea').innerHTML=items.slice(0,6).map((s,i)=>`<div onclick="pAns(${i},${oi})" style="aspect-ratio:1;background:var(--bg3);border:2px solid var(--border);border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:32px;cursor:pointer;color:${i===oi?'#ef4444':clr}">${s}</div>`).join('');
  }
  window.pAns=function(i,oi){const fb=document.getElementById('pFb');if(i===oi){score++;document.getElementById('gs1').textContent=score;fb.textContent='‚úÖ Correct!';fb.style.color='var(--success)';}else{fb.textContent='‚ùå Wrong!';fb.style.color='var(--danger)';}setTimeout(nxt,600);};
  timer=setInterval(()=>{tl--;document.getElementById('gs2').textContent=tl;if(tl<=0){clearInterval(timer);showToast('Time! Score: '+score);}},1000);document.getElementById('gs2').textContent=tl;nxt();
}
function renderTypingGame(c){
  const txts=['The quick brown fox jumps over the lazy dog near the river.','Consciousness is the greatest mystery in the universe.','Every morning is a new beginning. What we do today matters.'];
  let txt=txts[Math.floor(Math.random()*txts.length)],pos=0,errs=0,started=false,tl=60,timer;
  c.innerHTML=gameHeader('Speed Typing','‚å®Ô∏è','WPM','Accuracy')+`<div id="typD" style="padding:12px;background:var(--bg3);border-radius:10px;font-size:15px;line-height:2;margin-bottom:10px"></div><input type="text" id="typI" class="form-input" placeholder="Start typing..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" style="font-size:16px">`;
  function render(){document.getElementById('typD').innerHTML=txt.split('').map((ch,i)=>i<pos?`<span style="color:var(--success)">${ch}</span>`:i===pos?`<span style="background:var(--primary);color:#fff;border-radius:2px">${ch}</span>`:`<span>${ch}</span>`).join('');}
  render();
  document.getElementById('typI').addEventListener('input',function(){
    if(!started){started=true;timer=setInterval(()=>{tl--;document.getElementById('gs2').textContent=tl+('%');const wpm=Math.round((pos/5)*(60/Math.max(1,60-tl)));document.getElementById('gs1').textContent=wpm;if(tl<=0){clearInterval(timer);this.disabled=true;}},1000);}
    const v=this.value;if(v.length>0&&v[v.length-1]===txt[pos]){pos++;}else if(v.length>0)errs++;
    const acc=pos>0?Math.round((1-errs/Math.max(1,pos+errs))*100):100;document.getElementById('gs2').textContent=acc+'%';this.value='';render();
    if(pos>=txt.length){clearInterval(timer);showToast('üéâ Complete!');}
  });
}
function renderSpatialGame(c){
  let score=0,cur=0;
  c.innerHTML=gameHeader('Spatial Rotation','üîÑ','Score','Round')+`<div style="text-align:center"><div style="font-size:13px;color:var(--text2);margin-bottom:10px">Which option matches the SAME shape, just rotated?</div><div id="spB" style="font-size:80px;color:var(--primary);margin-bottom:14px;font-family:monospace"></div><div id="spO" style="display:flex;justify-content:center;gap:16px;font-size:50px;font-family:monospace"></div></div>`;
  const q=[{base:'L',opts:['L','Œì','‚åê','J'],correct:0},{base:'T',opts:['T','‚ä¢','‚ä•','‚ä£'],correct:1},{base:'F',opts:['F','‚ä¢','‚ä£','‚Ñ≤'],correct:3},{base:'Z',opts:['Z','S','N','Z'],correct:3}];
  function nxt(){if(cur>=10){showToast('Done! '+score+'/10');return;}const qst=q[cur%q.length];
    document.getElementById('gs2').textContent=(cur+1)+'/10';
    document.getElementById('spB').textContent=qst.base;
    document.getElementById('spO').innerHTML=qst.opts.map((r,i)=>`<span style="cursor:pointer;padding:8px;border-radius:8px;border:2px solid var(--border)" onclick="spAns(${i},${qst.correct})">${r}</span>`).join('');
  }
  window.spAns=function(i,correct){cur++;if(i===correct){score++;document.getElementById('gs1').textContent=score;showToast('‚úÖ');}else showToast('‚ùå');setTimeout(nxt,500);};
  nxt();
}
function renderBreathingGame(c){
  let phase=0,phTime=0,timer,cycles=0,running=false;
  const phases=[{name:'Inhale',dur:4,color:'var(--accent)'},{name:'Hold',dur:7,color:'var(--primary)'},{name:'Exhale',dur:8,color:'var(--success)'}];
  c.innerHTML=gameHeader('4-7-8 Breathing','ü´Å','Cycles','Phase')+`<div style="text-align:center"><div id="bCirc" style="width:160px;height:160px;border-radius:50%;border:4px solid var(--primary);margin:0 auto 20px;display:flex;flex-direction:column;align-items:center;justify-content:center;transition:all 1s"><div id="bPhase" style="font-size:18px;font-weight:800;color:var(--primary)">Ready?</div><div id="bCnt" style="font-size:28px;font-weight:800;color:var(--primary)"></div></div><button class="btn btn-primary" id="bBtn" onclick="bStart()">‚ñ∂ Begin</button></div><div style="margin-top:14px;background:var(--bg3);border-radius:10px;padding:12px;font-size:13px;color:var(--text2)"><strong>4-7-8 Technique:</strong> Inhale 4s ‚Üí Hold 7s ‚Üí Exhale 8s. Activates parasympathetic nervous system, reducing stress within minutes.</div>`;
  window.bStart=function(){document.getElementById('bBtn').style.display='none';phase=0;cycles=0;run();};
  function run(){const p=phases[phase];phTime=p.dur;const circ=document.getElementById('bCirc');circ.style.borderColor=p.color;circ.style.background=p.color+'20';
    document.getElementById('bPhase').textContent=p.name;document.getElementById('bPhase').style.color=p.color;document.getElementById('gs2').textContent=p.name;
    if(phase===0)setTimeout(()=>circ.style.transform='scale(1.4)',50);else if(phase===2)circ.style.transform='scale(0.9)';else circ.style.transform='scale(1.2)';
    clearInterval(timer);timer=setInterval(()=>{phTime--;document.getElementById('bCnt').textContent=phTime;
      if(phTime<=0){clearInterval(timer);phase=(phase+1)%3;if(phase===0){cycles++;document.getElementById('gs1').textContent=cycles;if(cycles>=4){document.getElementById('bPhase').textContent='Complete üôè';document.getElementById('bCnt').textContent='';document.getElementById('bBtn').style.display='';document.getElementById('bBtn').textContent='üîÑ Again';return;}}run();}
    },1000);document.getElementById('bCnt').textContent=phTime;
  }
}

// ‚îÄ‚îÄ‚îÄ LUCID DREAMS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const TECHNIQUES=[
  {name:'WILD ‚Äî Wake Induced Lucid Dream',col:'#7c3aed',body:'<strong>Simple words:</strong> Fall asleep while staying conscious.<br><br><strong>Steps:</strong><br>1. Set alarm 5-6 hours after sleep<br>2. Stay still after waking ‚Äî don\'t move body<br>3. Keep mind awake while body relaxes<br>4. Sleep paralysis will come (tingling, heavy) ‚Äî stay calm!<br>5. Visualize entering a dream while still aware<br><br><strong>Difficulty:</strong> Hard ‚≠ê‚≠ê‚≠ê‚≠ê'},
  {name:'MILD ‚Äî Mnemonic Induction',col:'#06b6d4',body:'<strong>Simple words:</strong> Set a strong intention before sleep.<br><br><strong>Steps:</strong><br>1. As you fall asleep, repeat: "Tonight I will know I\'m dreaming"<br>2. Vividly picture yourself realizing you\'re in a dream<br>3. Feel the emotion of becoming lucid ‚Äî joy, wonder<br>4. Repeat until you drift off<br><br><strong>Difficulty:</strong> Moderate ‚≠ê‚≠ê‚≠ê'},
  {name:'DILD ‚Äî Dream Initiated',col:'#ec4899',body:'<strong>Simple words:</strong> Realize you\'re dreaming while already inside a dream.<br><br><strong>Steps:</strong><br>1. Do reality checks all day (10+ times)<br>2. Genuinely ask: "Am I dreaming right now?"<br>3. This habit transfers to your dreams automatically<br>4. Something weird happens in dream ‚Üí you do a check ‚Üí "I\'m dreaming!"<br><br><strong>Difficulty:</strong> Easy ‚≠ê‚≠ê | Best for beginners'},
  {name:'WBTB ‚Äî Wake Back To Bed',col:'#10b981',body:'<strong>Simple words:</strong> Interrupt sleep at the right time to boost REM.<br><br><strong>Steps:</strong><br>1. Sleep normally for 5-6 hours<br>2. Wake up and stay awake 20-60 minutes (read about lucid dreaming)<br>3. Go back to sleep with intention to lucid dream<br>4. Brain enters REM quickly ‚Üí 70% more likely to become lucid!<br><br><strong>Difficulty:</strong> Easy-Moderate ‚≠ê‚≠ê'},
  {name:'Reality Testing ‚Äî Daily Practice',col:'#f59e0b',body:'<strong>Simple words:</strong> Train your brain to question reality constantly.<br><br><strong>Checks (do 10-15x per day):</strong><br>‚Ä¢ <strong>Hand check:</strong> Look at hands ‚Äî fingers often weird in dreams<br>‚Ä¢ <strong>Nose pinch:</strong> Pinch and try breathing ‚Äî still works in dreams!<br>‚Ä¢ <strong>Read text:</strong> Read, look away, read again ‚Äî changes in dreams<br>‚Ä¢ <strong>Clock check:</strong> Time jumps weirdly in dreams<br><br><strong>KEY:</strong> Genuinely ask "Could I be dreaming right now?" every time!'},
];
const RC_ITEMS=[{name:'Hand Check',icon:'üñêÔ∏è',desc:'Look at your hands'},{name:'Nose Pinch',icon:'üëÉ',desc:'Pinch & try breathing'},{name:'Read Text',icon:'üìñ',desc:'Read, look away, reread'},{name:'Clock Check',icon:'üïê',desc:'Check time twice'},{name:'Light Switch',icon:'üí°',desc:'Try light switches'},{name:'Try to Float',icon:'üïäÔ∏è',desc:'Jump & stay floating'}];
let selDreamType='regular';
function setDreamType(btn,type){document.querySelectorAll('.dream-type-btn').forEach(b=>b.classList.remove('active'));btn.classList.add('active');selDreamType=type;document.getElementById('dreamType').value=type;}
function buildTechniques(){
  const ct=document.getElementById('techniquesContainer');if(!ct)return;
  ct.innerHTML=TECHNIQUES.map((t,i)=>`<div class="technique-card" id="tc_${i}" onclick="togTech(${i})"><div class="tc-header"><div class="tc-title" style="color:${t.col}">${t.name}</div><span class="tc-chevron">‚ñº</span></div><div class="tc-body">${t.body}</div></div>`).join('');
}
function togTech(i){document.getElementById('tc_'+i).classList.toggle('open');}
function buildRCGrid(){
  const g=document.getElementById('rcGrid');if(!g)return;
  const done=JSON.parse(localStorage.getItem('cos_rc_done')||'[]');
  g.innerHTML=RC_ITEMS.map((r,i)=>`<div class="rc-btn${done.includes(i)?' done':''}" id="rcBtn_${i}" onclick="doRC(${i})"><span class="rc-icon">${r.icon}</span><div class="rc-name">${r.name}</div><div style="font-size:10px;color:var(--text3);margin-top:2px">${r.desc}</div></div>`).join('');
}
function doRC(i){
  const today=new Date().toDateString();
  if(localStorage.getItem('cos_rc_day')!==today){localStorage.setItem('cos_rc_day',today);localStorage.setItem('cos_rc_count','0');localStorage.setItem('cos_rc_done','[]');}
  const count=parseInt(localStorage.getItem('cos_rc_count')||0)+1;
  const done=JSON.parse(localStorage.getItem('cos_rc_done')||'[]');if(!done.includes(i))done.push(i);
  localStorage.setItem('cos_rc_count',count);localStorage.setItem('cos_rc_done',JSON.stringify(done));
  document.getElementById('rcCount').textContent=count;document.getElementById('rcProgress').style.width=Math.min(100,count/15*100)+'%';
  document.getElementById('rcBtn_'+i).classList.add('done');showToast('Reality check! Total: '+count);
}
function resetRC(){localStorage.setItem('cos_rc_count','0');localStorage.setItem('cos_rc_done','[]');buildRCGrid();if(document.getElementById('rcCount'))document.getElementById('rcCount').textContent=0;if(document.getElementById('rcProgress'))document.getElementById('rcProgress').style.width='0%';}
function calcWBTB(){
  const sl=document.getElementById('wbtbSleep').value,wk=document.getElementById('wbtbWake').value;
  if(!sl||!wk){showToast('Enter times first');return;}
  const sm=sl.split(':').map(Number),wm=wk.split(':').map(Number);
  let dur=(wm[0]*60+wm[1])-(sm[0]*60+sm[1]);if(dur<0)dur+=1440;
  const fmt=m=>`${Math.floor(m/60).toString().padStart(2,'0')}:${(m%60).toString().padStart(2,'0')}`;
  const t1=(sm[0]*60+sm[1]+300)%1440,t2=(sm[0]*60+sm[1]+360)%1440;
  document.getElementById('wbtbResult').innerHTML=`<div style="background:var(--bg3);border-radius:10px;padding:12px;font-size:13px"><div style="margin-bottom:6px">Sleep: <strong>${Math.floor(dur/60)}h ${dur%60}m</strong> (${Math.floor(dur/90)} cycles)</div><div style="margin-bottom:4px">‚è∞ Option 1: <strong style="color:var(--primary)">${fmt(t1)}</strong> (5h mark)</div><div style="margin-bottom:8px">‚è∞ Option 2: <strong style="color:var(--primary)">${fmt(t2)}</strong> (6h mark)</div><div style="color:var(--text3);font-size:11px">Wake at one of these times, stay up 20-60 min, then return to sleep for maximum lucid potential.</div></div>`;
}
function getDreams(){return JSON.parse(localStorage.getItem('cos_dreams')||'[]');}
function saveDream(){
  const entry={id:Date.now(),date:document.getElementById('dreamDate')?.value||new Date().toISOString().split('T')[0],title:document.getElementById('dreamTitle')?.value||'Untitled',type:selDreamType,desc:document.getElementById('dreamDesc')?.value,vividness:parseInt(document.getElementById('dreamVividness')?.value||5),lucidity:parseInt(document.getElementById('dreamLucidity')?.value||0),signs:document.getElementById('dreamSigns')?.value,emotions:document.getElementById('dreamEmotions')?.value};
  const dreams=getDreams();dreams.unshift(entry);localStorage.setItem('cos_dreams',JSON.stringify(dreams));
  showToast('üí§ Dream saved!');renderDreamJournal();analyzeDream(entry);
}
async function analyzeDream(entry){
  const el=document.getElementById('dreamAIAnalysis');if(!el)return;
  el.innerHTML='<div class="ai-loading"><span></span><span></span><span></span></div><span style="font-size:13px;color:var(--text2)"> Analyzing dream...</span>';
  try{
    const resp=await fetch('https://api.anthropic.com/v1/messages',{method:'POST',headers:{'Content-Type':'application/json','anthropic-version':'2023-06-01','anthropic-dangerous-direct-browser-access':'true'},
      body:JSON.stringify({model:'claude-sonnet-4-20250514',max_tokens:400,messages:[{role:'user',content:`Analyze this dream for a consciousness tracker user. Dream: "${entry.desc}" Type: ${entry.type}, Vividness: ${entry.vividness}/10, Lucidity: ${entry.lucidity}/10, Signs: ${entry.signs}, Emotions: ${entry.emotions}. Provide: 1) Key symbols and psychological meaning 2) What it reflects about waking life 3) Specific lucid dreaming coaching for this exact dream (what to do when these signs appear) 4) Technique to use tonight. Keep under 200 words, practical and warm.`}]})
    });
    const data=await resp.json();
    el.innerHTML=`<div class="dream-ai-box"><div style="font-weight:700;margin-bottom:8px">ü§ñ AI Dream Analysis</div><div style="font-size:13px;line-height:1.7">${(data.content?.[0]?.text||'').replace(/\n/g,'<br>')}</div></div>`;
  }catch(e){
    el.innerHTML=`<div class="dream-ai-box"><div style="font-size:13px;line-height:1.6"><strong>Dream Analysis:</strong><br>‚Ä¢ ${entry.type} dream, vividness: ${entry.vividness}/10<br>‚Ä¢ ${entry.lucidity>0?'Lucidity '+entry.lucidity+'/10 ‚Äî next time, try stabilizing by rubbing your hands or spinning.':'No lucidity yet ‚Äî do reality checks during similar dream scenarios.'}<br>‚Ä¢ Dream signs: ${entry.signs||'note recurring elements next time'}<br>‚Ä¢ Tonight: Use MILD. Repeat "When I see ${entry.signs||'unusual things'}, I will realize I am dreaming."</div></div>`;
  }
}
function renderDreamJournal(){
  const el=document.getElementById('dreamJournal');if(!el)return;
  const dreams=getDreams().slice(0,20);
  if(!dreams.length){el.innerHTML='<div class="empty-state"><span class="es-icon">üåô</span><div class="es-text">No dreams logged yet</div></div>';return;}
  el.innerHTML=dreams.map(d=>`<div style="background:var(--bg3);border:1px solid var(--border);border-radius:10px;padding:12px;margin-bottom:8px"><div style="display:flex;justify-content:space-between;margin-bottom:6px"><div style="font-weight:700;font-size:14px">${d.title}</div><span class="badge badge-${d.type==='lucid'?'success':d.type==='nightmare'?'danger':'primary'}">${d.type}</span></div><div style="font-size:11px;color:var(--text3);margin-bottom:5px">${d.date}</div><div style="font-size:12px;color:var(--text2)">${(d.desc||'').slice(0,100)}${(d.desc||'').length>100?'...':''}</div><div style="display:flex;gap:10px;margin-top:5px;font-size:11px;color:var(--text3)"><span>üëÅÔ∏è ${d.vividness}/10</span><span>‚ú® ${d.lucidity}/10</span></div></div>`).join('');
}

// ‚îÄ‚îÄ‚îÄ VOICE & MEDIA ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
let mediaRecorder,recChunks=[],recTimer,recSecs=0,recognition;
function toggleRecord(){const btn=document.getElementById('recorderBtn');if(btn.classList.contains('recording'))stopRecord();else startRecord();}
function startRecord(){
  if(!navigator.mediaDevices){showToast('Microphone not supported');return;}
  navigator.mediaDevices.getUserMedia({audio:true}).then(stream=>{
    mediaRecorder=new MediaRecorder(stream);recChunks=[];recSecs=0;
    mediaRecorder.ondataavailable=e=>recChunks.push(e.data);
    mediaRecorder.onstop=()=>{
      const blob=new Blob(recChunks,{type:'audio/webm'});const reader=new FileReader();
      reader.onload=()=>{const memo={id:Date.now(),ts:new Date().toISOString(),audio:reader.result,transcript:document.getElementById('liveTranscript').textContent};
        const memos=JSON.parse(localStorage.getItem('cos_voice')||'[]');memos.unshift(memo);
        localStorage.setItem('cos_voice',JSON.stringify(memos.slice(0,50)));renderVoiceMemos();showToast('üéôÔ∏è Memo saved!');};
      reader.readAsDataURL(blob);
    };
    mediaRecorder.start();document.getElementById('recorderBtn').classList.add('recording');
    document.getElementById('recStatus').textContent='Recording... Tap to Stop';
    recTimer=setInterval(()=>{recSecs++;const m=Math.floor(recSecs/60),s=recSecs%60;document.getElementById('recTimer').textContent=(m<10?'0':'')+m+':'+(s<10?'0':'')+s;},1000);
    if(SETTINGS_STATE.autoTranscribe&&(window.SpeechRecognition||window.webkitSpeechRecognition)){
      const SR=window.SpeechRecognition||window.webkitSpeechRecognition;recognition=new SR();recognition.continuous=true;recognition.interimResults=true;
      recognition.onresult=e=>{let t='';for(let i=e.resultIndex;i<e.results.length;i++)t+=e.results[i][0].transcript;document.getElementById('liveTranscript').textContent=t;};
      recognition.start();
    }
  }).catch(()=>showToast('Mic access denied'));
}
function stopRecord(){
  if(mediaRecorder&&mediaRecorder.state!=='inactive')mediaRecorder.stop();
  if(recognition)try{recognition.stop();}catch(e){}
  clearInterval(recTimer);document.getElementById('recorderBtn').classList.remove('recording');document.getElementById('recStatus').textContent='Tap to Start Recording';
}
function renderVoiceMemos(){
  const el=document.getElementById('voiceMemos');if(!el)return;
  const memos=JSON.parse(localStorage.getItem('cos_voice')||'[]').slice(0,20);
  if(!memos.length){el.innerHTML='<div class="empty-state"><span class="es-icon">üéôÔ∏è</span><div class="es-text">No memos yet</div></div>';return;}
  el.innerHTML=memos.map(m=>`<div class="memo-item"><div class="memo-meta"><span>${new Date(m.ts).toLocaleDateString()+' '+new Date(m.ts).toLocaleTimeString()}</span><button onclick="delMemo(${m.id})" style="background:none;border:none;color:var(--danger);cursor:pointer">‚úï</button></div>${m.audio?`<audio src="${m.audio}" controls style="width:100%;margin-bottom:5px"></audio>`:''} ${m.transcript&&m.transcript!=='Speak to see transcript here...'?`<div style="font-size:12px;color:var(--text2)">${m.transcript}</div>`:''}</div>`).join('');
}
function delMemo(id){const m=JSON.parse(localStorage.getItem('cos_voice')||'[]').filter(m=>m.id!==id);localStorage.setItem('cos_voice',JSON.stringify(m));renderVoiceMemos();}
async function analyzeVoiceMemos(){
  const memos=JSON.parse(localStorage.getItem('cos_voice')||'[]');const el=document.getElementById('voiceAIInsights');
  if(!memos.length){showToast('No memos to analyze');return;}
  el.innerHTML='<div class="ai-loading"><span></span><span></span><span></span></div>';
  const transcripts=memos.filter(m=>m.transcript&&m.transcript!=='Speak to see transcript here...').map((m,i)=>`[${new Date(m.ts).toLocaleDateString()}]: ${m.transcript}`).join('\n');
  await new Promise(r=>setTimeout(r,1000));
  el.innerHTML=`<div class="ai-insight-box">You have ${memos.length} voice recordings${transcripts?', with transcripts showing patterns in your consciousness tracking':' (no transcripts yet ‚Äî enable auto-transcribe in Settings)'}.<br><br><strong>üìù Suggestions for what to record next:</strong><br>‚Ä¢ Morning thoughts immediately after waking (before phone)<br>‚Ä¢ Your mental state before and after exercise<br>‚Ä¢ Creative ideas as they arise<br>‚Ä¢ Emotional reactions to events (pattern tracking)<br>‚Ä¢ Post-meditation insights<br>‚Ä¢ Dream recall right after waking</div>`;
}
function uploadMedia(e){
  Array.from(e.target.files).forEach(file=>{
    const reader=new FileReader();reader.onload=()=>{
      const item={id:Date.now()+Math.random(),ts:new Date().toISOString(),type:file.type,data:reader.result,name:file.name};
      const arch=JSON.parse(localStorage.getItem('cos_media')||'[]');arch.unshift(item);
      localStorage.setItem('cos_media',JSON.stringify(arch.slice(0,50)));renderMediaGrid();showToast('üì∏ Saved!');
    };reader.readAsDataURL(file);
  });
}
function renderMediaGrid(){
  const el=document.getElementById('mediaGrid');if(!el)return;
  const arch=JSON.parse(localStorage.getItem('cos_media')||'[]').slice(0,50);
  if(!arch.length){el.innerHTML='<div class="empty-state" style="grid-column:1/-1"><span class="es-icon">üñºÔ∏è</span><div class="es-text">No media yet</div></div>';return;}
  el.innerHTML=arch.map(m=>`<div class="media-thumb">${m.type.startsWith('image')?`<img src="${m.data}" alt="${m.name}">`:  `<video src="${m.data}" controls></video>`}</div>`).join('');
}
async function analyzeMedia(){
  const arch=JSON.parse(localStorage.getItem('cos_media')||'[]');const el=document.getElementById('mediaAIInsights');
  el.innerHTML=`<div class="ai-insight-box">You have ${arch.length} items archived.<br><br><strong>üí° What to capture for consciousness tracking:</strong><br>‚Ä¢ Daily selfies to track energy/mood changes visually<br>‚Ä¢ Your workspace and environment<br>‚Ä¢ Post-workout state<br>‚Ä¢ Meals for nutrition tracking<br>‚Ä¢ Places and experiences that shift your consciousness<br>‚Ä¢ Nature exposure (trees, water, sky)</div>`;
}

// ‚îÄ‚îÄ‚îÄ CALENDAR & ALARMS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
let calDate=new Date();
function renderCalendar(){
  const el=document.getElementById('calGrid');if(!el)return;
  const year=calDate.getFullYear(),month=calDate.getMonth();
  document.getElementById('calTitle').textContent=calDate.toLocaleDateString(curLang,{month:'long',year:'numeric'});
  const first=new Date(year,month,1).getDay(),days=new Date(year,month+1,0).getDate();
  const logs=getLogs().map(e=>e.date),dreams=getDreams().map(d=>d.date);
  const today=new Date().toISOString().split('T')[0];
  let html=['Su','Mo','Tu','We','Th','Fr','Sa'].map(d=>`<div class="cal-day-header">${d}</div>`).join('');
  html+=Array(first).fill('<div></div>').join('');
  for(let d=1;d<=days;d++){const ds=`${year}-${String(month+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;html+=`<div class="cal-day${ds===today?' today':''}${logs.includes(ds)?' has-log':''}${dreams.includes(ds)?' has-dream':''}">${d}</div>`;}
  el.innerHTML=html;renderAlarms();renderReminders();
}
function calNav(dir){calDate=new Date(calDate.getFullYear(),calDate.getMonth()+dir,1);renderCalendar();}
function addAlarm(){
  const label=document.getElementById('alarmLabel').value||'Alarm',time=document.getElementById('alarmTime').value,sound=document.getElementById('alarmSound').value,repeat=document.getElementById('alarmRepeat').value;
  if(!time){showToast('Please set a time');return;}
  const alarms=JSON.parse(localStorage.getItem('cos_alarms')||'[]');
  alarms.push({id:Date.now(),label,time,sound,repeat,active:true});
  localStorage.setItem('cos_alarms',JSON.stringify(alarms));renderAlarms();showToast('‚è∞ Alarm set: '+time);
  if(Notification.permission==='default')Notification.requestPermission();
}
function renderAlarms(){
  const el=document.getElementById('alarmsList');if(!el)return;
  const alarms=JSON.parse(localStorage.getItem('cos_alarms')||'[]');
  if(!alarms.length){el.innerHTML='<div class="empty-state"><span class="es-icon">‚è∞</span><div class="es-text">No alarms set</div></div>';return;}
  el.innerHTML=alarms.map((a,i)=>`<div class="alarm-item"><div><div style="font-weight:700;font-size:15px">${a.time}</div><div style="font-size:12px;color:var(--text3)">${a.label} ¬∑ ${a.repeat} ¬∑ ${a.sound}</div></div><div style="display:flex;gap:8px;align-items:center"><div class="alarm-toggle${a.active?' on':''}" onclick="togAlarm(${i})"></div><button onclick="delAlarm(${i})" style="background:none;border:none;color:var(--danger);cursor:pointer">üóë</button></div></div>`).join('');
}
function togAlarm(i){const a=JSON.parse(localStorage.getItem('cos_alarms')||'[]');a[i].active=!a[i].active;localStorage.setItem('cos_alarms',JSON.stringify(a));renderAlarms();}
function delAlarm(i){const a=JSON.parse(localStorage.getItem('cos_alarms')||'[]');a.splice(i,1);localStorage.setItem('cos_alarms',JSON.stringify(a));renderAlarms();}
function checkAlarms(){
  const now=new Date();const ts=`${String(now.getHours()).padStart(2,'0')}:${String(now.getMinutes()).padStart(2,'0')}`;
  const alarms=JSON.parse(localStorage.getItem('cos_alarms')||'[]');
  alarms.forEach(a=>{if(!a.active)return;if(a.time===ts){playAlarmSound(a.sound);if(Notification.permission==='granted')new Notification('‚è∞ '+a.label,{body:a.time+' ¬∑ Consciousness OS'});showToast('‚è∞ '+a.label,4000);}});
}
function playAlarmSound(sound){
  try{const ctx=new(window.AudioContext||window.webkitAudioContext)();const osc=ctx.createOscillator();const gain=ctx.createGain();
    osc.frequency.value={bell:880,chime:528,pulse:440,om:136,birds:1000}[sound]||440;osc.type='sine';
    gain.gain.setValueAtTime(0.5,ctx.currentTime);gain.gain.exponentialRampToValueAtTime(0.001,ctx.currentTime+2);
    osc.connect(gain);gain.connect(ctx.destination);osc.start();osc.stop(ctx.currentTime+2);}catch(e){}
}
function addReminder(){
  const text=document.getElementById('reminderText').value,dt=document.getElementById('reminderDateTime').value;
  if(!text||!dt){showToast('Fill in details');return;}
  const r=JSON.parse(localStorage.getItem('cos_reminders')||'[]');r.push({id:Date.now(),text,dt});
  localStorage.setItem('cos_reminders',JSON.stringify(r));renderReminders();showToast('üìù Reminder added!');
}
function renderReminders(){
  const el=document.getElementById('remindersList');if(!el)return;
  const r=JSON.parse(localStorage.getItem('cos_reminders')||'[]');
  if(!r.length){el.innerHTML='';return;}
  el.innerHTML=r.map((rem,i)=>`<div style="display:flex;justify-content:space-between;align-items:center;padding:8px;background:var(--bg3);border-radius:8px;margin-bottom:4px"><div><div style="font-size:13px;font-weight:600">${rem.text}</div><div style="font-size:11px;color:var(--text3)">${new Date(rem.dt).toLocaleString()}</div></div><button onclick="delRem(${i})" style="background:none;border:none;color:var(--danger);cursor:pointer">‚úï</button></div>`).join('');
}
function delRem(i){const r=JSON.parse(localStorage.getItem('cos_reminders')||'[]');r.splice(i,1);localStorage.setItem('cos_reminders',JSON.stringify(r));renderReminders();}

// ‚îÄ‚îÄ‚îÄ DATA ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function exportData(){
  const data={version:'6.0',exported:new Date().toISOString(),logs:getLogs(),dreams:getDreams(),voice:JSON.parse(localStorage.getItem('cos_voice')||'[]'),settings:SETTINGS_STATE};
  const blob=new Blob([JSON.stringify(data,null,2)],{type:'application/json'});
  const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download=`consciousness_os_v6_${Date.now()}.json`;a.click();showToast('üíæ Exported!');
}
function importData(e){
  const file=e.target.files[0];if(!file)return;
  const reader=new FileReader();reader.onload=()=>{try{const data=JSON.parse(reader.result);if(data.logs)localStorage.setItem('cos_logs',JSON.stringify(data.logs));if(data.dreams)localStorage.setItem('cos_dreams',JSON.stringify(data.dreams));showToast('üì• Imported! '+data.logs?.length+' entries');renderRecentLogs();}catch(e){showToast('‚ùå Invalid file');}};reader.readAsText(file);
}
function clearAllData(){if(confirm('Clear ALL data? Cannot be undone.')){['cos_logs','cos_voice','cos_media','cos_health2','cos_reminders','cos_dreams','cos_rc_today','cos_alarms'].forEach(k=>localStorage.removeItem(k));showToast(t('cleared'));renderRecentLogs();}}


// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  FEATURE 1 ‚Äî WORLD INTELLIGENCE / GEOPOLITICS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const GEO_EVENTS=[
  {title:'US-China Trade War Escalation',meta:'High impact ¬∑ Markets, Tech, Commodities',impact:'‚Üë Gold, ‚Üì Tech stocks, ‚Üë Oil volatility',region:'üåè'},
  {title:'Federal Reserve Rate Decision',meta:'Central bank policy ¬∑ Monthly update',impact:'‚Üë/‚Üì Crypto, USD, Bonds, Real Estate',region:'üá∫üá∏'},
  {title:'Middle East Conflict Update',meta:'Geopolitical risk ¬∑ Energy markets',impact:'‚Üë Oil, ‚Üë Gold, ‚Üë Defense stocks',region:'üåç'},
  {title:'AI Regulation Wave ‚Äî EU AI Act',meta:'Tech regulation ¬∑ Global precedent',impact:'‚Üì AI stocks short-term, ‚Üë compliance sector',region:'üá™üá∫'},
  {title:'BRICS Currency Alternative Push',meta:'Dedollarization ¬∑ Long-term structural shift',impact:'‚Üì USD dominance, ‚Üë Gold, ‚Üë EM assets',region:'üåê'},
  {title:'Japan Yield Curve Control Shift',meta:'BOJ policy ¬∑ Global bond markets',impact:'‚Üë JPY, ‚Üì US bonds held by Japan, ‚Üë volatility',region:'üáØüáµ'},
];
const GEO_LINKS=[
  {cause:'‚öîÔ∏è War / Conflict',effect:'‚Üë Gold (safe haven), ‚Üë Oil (supply risk), ‚Üì Stocks (risk off)'},
  {cause:'üè¶ Rate Hikes',effect:'‚Üì Crypto, ‚Üì Growth stocks, ‚Üë USD, ‚Üë Bonds yield'},
  {cause:'üìâ Recession Fear',effect:'‚Üë Gold, ‚Üì Commodities, ‚Üì EM currencies, ‚Üë USD'},
  {cause:'üñ®Ô∏è Money Printing',effect:'‚Üë Bitcoin, ‚Üë Real assets, ‚Üë Inflation, ‚Üì Cash value'},
  {cause:'üõ¢Ô∏è Oil Supply Cut',effect:'‚Üë Inflation, ‚Üë Gold, ‚Üì Consumer spending, ‚Üë Airline costs'},
];
const MARKET_DATA=[
  {name:'S&P 500',price:'5,242',change:'+0.8%',up:true,emoji:'üìà'},
  {name:'NASDAQ',price:'18,439',change:'+1.2%',up:true,emoji:'üíª'},
  {name:'Gold',price:'$2,318',change:'+0.4%',up:true,emoji:'ü•á'},
  {name:'Oil (WTI)',price:'$82.4',change:'-1.1%',up:false,emoji:'üõ¢Ô∏è'},
  {name:'Bitcoin',price:'$67,240',change:'+3.4%',up:true,emoji:'‚Çø'},
  {name:'USD/EUR',price:'1.084',change:'-0.2%',up:false,emoji:'üí±'},
  {name:'10Y Treasury',price:'4.42%',change:'+0.05%',up:true,emoji:'üèõÔ∏è'},
  {name:'VIX Fear',price:'14.8',change:'-2.1%',up:false,emoji:'üò±'},
];
const CRYPTO_DATA=[
  {name:'Bitcoin',sym:'BTC',price:'$67,240',change:'+3.4%',up:true,cap:'$1.32T'},
  {name:'Ethereum',sym:'ETH',price:'$3,518',change:'+2.1%',up:true,cap:'$422B'},
  {name:'Solana',sym:'SOL',price:'$172',change:'+5.8%',up:true,cap:'$78B'},
  {name:'BNB',sym:'BNB',price:'$598',change:'+0.9%',up:true,cap:'$88B'},
  {name:'XRP',sym:'XRP',price:'$0.527',change:'-0.8%',up:false,cap:'$29B'},
];
const COMMODITY_DATA=[
  {name:'Gold',price:'$2,318/oz',change:'+0.4%',up:true,emoji:'ü•á',cycle:'Bull Phase ‚Äî Safe haven demand ‚Üë'},
  {name:'Silver',price:'$27.4/oz',change:'+1.2%',up:true,emoji:'ü™ô',cycle:'Recovery ‚Äî Industrial + monetary demand'},
  {name:'Oil',price:'$82.4/bbl',change:'-1.1%',up:false,emoji:'üõ¢Ô∏è',cycle:'Range-bound ‚Äî Supply constraints vs demand'},
  {name:'Natural Gas',price:'$2.14',change:'-2.3%',up:false,emoji:'üî•',cycle:'Bear Phase ‚Äî Oversupply'},
  {name:'Copper',price:'$4.52/lb',change:'+2.8%',up:true,emoji:'‚öôÔ∏è',cycle:'Bull ‚Äî EV & AI infrastructure demand ‚Üë'},
  {name:'Wheat',price:'$542/bu',change:'-0.5%',up:false,emoji:'üåæ',cycle:'Neutral ‚Äî Supply stabilizing'},
];

function switchWorld(panel,btn){
  document.querySelectorAll('.world-panel').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('.world-nav-btn').forEach(b=>b.classList.remove('active'));
  const el=document.getElementById('wp-'+panel);if(el)el.classList.add('active');
  if(btn)btn.classList.add('active');
}
function buildWorldPanel(){
  // Geo events
  const geoEl=document.getElementById('geoEventsList');
  if(geoEl)geoEl.innerHTML=GEO_EVENTS.map(e=>`<div class="geo-event" onclick="expandGeoEvent('${e.title}')"><div class="ge-title">${e.region} ${e.title}</div><div class="ge-meta">${e.meta}</div><div style="font-size:11px;color:var(--success);margin-top:3px">Market impact: ${e.impact}</div></div>`).join('');
  // Geo links
  const linksEl=document.getElementById('geoMarketLinks');
  if(linksEl)linksEl.innerHTML=GEO_LINKS.map(l=>`<div class="causal-step"><div class="causal-arrow">‚Üí</div><div class="causal-text"><strong>${l.cause}</strong><br>${l.effect}</div></div>`).join('');
  // Markets
  const mktEl=document.getElementById('marketsDisplay');
  if(mktEl)mktEl.innerHTML=MARKET_DATA.map(m=>`<div class="market-card"><div><div class="mc-name">${m.emoji} ${m.name}</div></div><div style="text-align:right"><div class="mc-price">${m.price}</div><div class="mc-change ${m.up?'mc-up':'mc-down'}">${m.change}</div></div></div>`).join('');
  // Crypto
  const cryptoEl=document.getElementById('cryptoDisplay');
  if(cryptoEl)cryptoEl.innerHTML=CRYPTO_DATA.map(c=>`<div class="market-card"><div><div class="mc-name">‚Çø ${c.name} <span style="font-size:10px;color:var(--text3)">${c.sym}</span></div><div style="font-size:11px;color:var(--text3)">Cap: ${c.cap}</div></div><div style="text-align:right"><div class="mc-price">${c.price}</div><div class="mc-change ${c.up?'mc-up':'mc-down'}">${c.change}</div></div></div>`).join('');
  const cycleEl=document.getElementById('cryptoCycle');
  if(cycleEl)cycleEl.innerHTML=`<div class="causal-chain"><div style="font-size:14px;font-weight:700;margin-bottom:10px">üîÑ Current Market Cycle Phase</div><div class="causal-step"><div class="causal-arrow">üìç</div><div class="causal-text"><strong>Euphoria/Bull Run Phase</strong> ‚Äî Post-halving cycle, institutional adoption wave. High retail FOMO. Watch for distribution signals.</div></div><div class="causal-step"><div class="causal-arrow">‚ö†Ô∏è</div><div class="causal-text"><strong>Risk factors:</strong> Regulatory pressure, macro tightening, leverage buildup. Bitcoin dominance: 54%</div></div><div class="causal-step"><div class="causal-arrow">üí°</div><div class="causal-text"><strong>Historical pattern:</strong> Post-halving rallies typically peak 12‚Äì18 months after event. Current halving: April 2024.</div></div></div>`;
  // Commodities
  const comEl=document.getElementById('commoditiesDisplay');
  if(comEl)comEl.innerHTML=COMMODITY_DATA.map(c=>`<div class="market-card"><div><div class="mc-name">${c.emoji} ${c.name}</div><div style="font-size:11px;color:var(--text3)">${c.cycle}</div></div><div style="text-align:right"><div class="mc-price" style="font-size:14px">${c.price}</div><div class="mc-change ${c.up?'mc-up':'mc-down'}">${c.change}</div></div></div>`).join('');
  const comCycEl=document.getElementById('commoditiesCycle');
  if(comCycEl)comCycEl.innerHTML=`<div class="causal-chain"><div class="causal-step"><div class="causal-arrow">üîÑ</div><div class="causal-text"><strong>Commodity Supercycle Theory:</strong> We appear to be entering a new commodities supercycle driven by energy transition (copper, lithium), deglobalization (reshoring), and monetary debasement (gold/silver).</div></div><div class="causal-step"><div class="causal-arrow">üí°</div><div class="causal-text"><strong>Key insight:</strong> AI and EV buildout = massive copper demand. Energy transition = oil volatility but not collapse. Gold = monetary system stress indicator.</div></div></div>`;
  // Rates
  const ratesEl=document.getElementById('ratesDisplay');
  if(ratesEl)ratesEl.innerHTML=`<div class="market-card"><div><div class="mc-name">üá∫üá∏ Fed Funds Rate</div></div><div style="text-align:right"><div class="mc-price">5.25‚Äì5.50%</div><div class="mc-change mc-down">Pause ‚Äî Cut cycle begins 2024</div></div></div><div class="market-card"><div><div class="mc-name">üá™üá∫ ECB Rate</div></div><div style="text-align:right"><div class="mc-price">4.00%</div><div class="mc-change mc-up">Cutting ‚Äî First cut Jun 2024</div></div></div><div class="market-card"><div><div class="mc-name">üá¨üáß BOE Rate</div></div><div style="text-align:right"><div class="mc-price">5.25%</div><div class="mc-change mc-down">Hold ‚Äî Cutting expected late 2024</div></div></div><div class="market-card"><div><div class="mc-name">üáØüáµ BOJ Rate</div></div><div style="text-align:right"><div class="mc-price">0.10%</div><div class="mc-change mc-up">Historic rise ‚Äî Ending negative rates</div></div></div>`;
  const ratesImpEl=document.getElementById('ratesImpact');
  if(ratesImpEl)ratesImpEl.innerHTML=`<div class="causal-chain"><div class="causal-step"><div class="causal-arrow">üìâ</div><div class="causal-text"><strong>Rate cuts ahead:</strong> Lower rates ‚Üí cheaper borrowing ‚Üí ‚Üë stocks (growth), ‚Üë real estate, ‚Üë crypto (risk-on), ‚Üì USD, ‚Üì savings yields</div></div><div class="causal-step"><div class="causal-arrow">üí∞</div><div class="causal-text"><strong>Your wealth strategy:</strong> Rate-cut cycles historically favor equities, crypto, and real assets over cash and bonds.</div></div></div>`;
}
function setWorldQ(q){document.getElementById('worldAskInput').value=q;askWorldAI();}
function askWorldAI(){
  const q=document.getElementById('worldAskInput').value.trim();if(!q)return;
  const el=document.getElementById('worldAIResult');
  el.innerHTML=`<div class="causal-chain"><div style="font-size:12px;color:var(--text3);margin-bottom:8px">ü§ñ Analyzing causal chain...</div></div>`;
  setTimeout(()=>{
    const chains=generateCausalChain(q);
    el.innerHTML=`<div class="causal-chain"><div style="font-weight:700;font-size:14px;margin-bottom:12px">üîç Causal Analysis: "${q}"</div>${chains.map(c=>`<div class="causal-step"><div class="causal-arrow">${c.arrow}</div><div class="causal-text"><strong>${c.node}</strong><br>${c.detail}</div></div>`).join('')}</div>`;
  },800);
}
function generateCausalChain(q){
  const ql=q.toLowerCase();
  if(ql.includes('war')&&ql.includes('gold')){return[{arrow:'‚öîÔ∏è',node:'War / Geopolitical Conflict',detail:'Military conflict creates uncertainty and fear in global markets'},{arrow:'‚Üí',node:'Risk-Off Capital Flight',detail:'Investors sell risky assets (stocks, crypto) and move to safe havens'},{arrow:'‚Üí',node:'Gold Demand Spikes',detail:'Gold is the ultimate safe-haven asset ‚Äî stateless, tangible, no counterparty risk'},{arrow:'‚Üí',node:'Gold Price Rises',detail:'Historically, gold rises 8‚Äì25% during major conflict escalations. Central banks also buy more.'},{arrow:'üí°',node:'Additional Factors',detail:'Extent depends on: conflict scale, involvement of major economies, oil supply disruption, USD strength'}];}
  if(ql.includes('rate')&&(ql.includes('crypto')||ql.includes('bitcoin'))){return[{arrow:'üè¶',node:'Fed Raises Interest Rates',detail:'Higher rates make risk-free assets (bonds, savings) more attractive'},{arrow:'‚Üí',node:'Risk Appetite Drops',detail:'Investors shift from speculative assets to safer yield-bearing instruments'},{arrow:'‚Üí',node:'Crypto Sells Off',detail:'Bitcoin and altcoins drop as institutional money exits for treasury yields'},{arrow:'‚Üí',node:'Liquidity Reduction',detail:'Higher rates also reduce money supply and credit, shrinking capital available for speculation'},{arrow:'üí°',node:'Reversal Signal',detail:'When rates cut, crypto historically surges. Monitor Fed pivot signals closely.'}];}
  if(ql.includes('china')&&ql.includes('taiwan')){return[{arrow:'üá®üá≥',node:'China Invades Taiwan',detail:'Taiwan produces ~90% of advanced semiconductors (TSMC). Conflict = global supply shock'},{arrow:'‚Üí',node:'Semiconductor Crisis',detail:'Chip shortage far worse than 2021. AI buildout halts. Tech companies collapse.'},{arrow:'‚Üí',node:'Global Recession Risk',detail:'GDP contraction in US, EU, Asia. Stock markets drop 30‚Äì50% in worst case'},{arrow:'‚Üí',node:'Safe Haven Surge',detail:'Gold, CHF, JPY surge. Energy prices spike. Defense stocks rally.'},{arrow:'üí°',node:'Probability Assessment',detail:'Most analysts rate 2026‚Äì2030 as elevated risk window. Taiwan insurance (TSMC diversification) underway.'}];}
  if(ql.includes('oil')&&ql.includes('inflation')){return[{arrow:'üõ¢Ô∏è',node:'Oil Price Rises',detail:'Oil is the foundational input for transportation, manufacturing, agriculture, plastics'},{arrow:'‚Üí',node:'Transportation Costs Rise',detail:'Trucking, shipping, aviation become more expensive ‚Äî costs passed to consumers'},{arrow:'‚Üí',node:'Food & Goods Prices Rise',detail:'Farmers, factories pay more for fuel and inputs ‚Äî inflation spreads across economy'},{arrow:'‚Üí',node:'Central Banks React',detail:'Fed and other CBs raise rates to fight inflation ‚Äî triggering tighter financial conditions'},{arrow:'üí°',node:'Key insight',detail:'Oil is inflation\'s master lever. Watch OPEC decisions and Middle East tensions as leading indicators.'}];}
  return[{arrow:'üåê',node:'Global System Analysis',detail:`Your query: "${q}"`},{arrow:'‚Üí',node:'Multi-Factor Chain',detail:'Complex systems involve multiple interacting forces. Key principle: follow the money and incentives.'},{arrow:'‚Üí',node:'First-Order Effects',detail:'Most visible direct impact of the event or force'},{arrow:'‚Üí',node:'Second-Order Effects',detail:'Ripple effects that emerge 3‚Äì12 months later, often more important than first-order'},{arrow:'üí°',node:'8D Chess Insight',detail:'True world-level thinking requires tracking: politics, economics, technology, energy, demographics, and psychology simultaneously.'}];
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  FEATURE 3 ‚Äî THEME ENGINE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const THEMES=[
  {id:'light',name:'Light',colors:['#f8f6ff','#7c3aed','#06b6d4']},
  {id:'dark',name:'Dark',colors:['#0f0a1e','#7c3aed','#06b6d4']},
  {id:'scifi',name:'Sci-Fi',colors:['#020818','#00b4ff','#00ffcc']},
  {id:'natural',name:'Natural',colors:['#f0f7ee','#2d7a3a','#5dba6f']},
  {id:'spiritual',name:'Spirit',colors:['#1a0a2e','#c040ff','#ffcc00']},
  {id:'classic',name:'Classic',colors:['#faf8f0','#8b4513','#c87020']},
  {id:'winter',name:'Winter',colors:['#e8f4ff','#0060c0','#00b0d8']},
  {id:'summer',name:'Summer',colors:['#fff8e8','#e08000','#f0a000']},
];
function buildThemeGrid(){
  const el=document.getElementById('themeGrid');if(!el)return;
  const cur=localStorage.getItem('cos_theme')||'light';
  el.innerHTML=THEMES.map(th=>`<div class="theme-swatch${th.id===cur?' active':''}" onclick="applyTheme('${th.id}')">
    <div class="ts-circle" style="background:linear-gradient(135deg,${th.colors[1]},${th.colors[2]});border:2px solid ${th.colors[0]==='#0f0a1e'?'#333':'#ccc'}"></div>
    <div class="ts-name">${th.name}</div>
  </div>`).join('');
}
function applyTheme(id){
  const isDark=['dark','scifi','spiritual'].includes(id);
  // Remove all theme attrs
  ['scifi','natural','spiritual','classic','winter','summer'].forEach(t=>document.documentElement.removeAttribute('data-'+t));
  if(id==='light'){document.documentElement.setAttribute('data-theme','light');}
  else if(id==='dark'){document.documentElement.setAttribute('data-theme','dark');}
  else{document.documentElement.setAttribute('data-theme',isDark?'dark':'light');document.documentElement.setAttribute('data-theme',id);}
  localStorage.setItem('cos_theme',id);
  document.getElementById('themeBtn').textContent=isDark?'‚òÄÔ∏è':'üåô';
  buildThemeGrid();
  showToast('üé® Theme: '+id.charAt(0).toUpperCase()+id.slice(1));
}
function switchSysTab(tab,btn){
  document.querySelectorAll('.sys-panel').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('.sys-tab-btn').forEach(b=>b.classList.remove('active'));
  const el=document.getElementById('sysp-'+tab);if(el)el.classList.add('active');
  if(btn)btn.classList.add('active');
}
function updateSysToggle(){
  const isDark=document.documentElement.getAttribute('data-theme')==='dark';
  const el=document.getElementById('sys-darkToggle');
  if(el)el.classList.toggle('on',isDark);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  FEATURE 4 ‚Äî LEGAL & POLICY PAGES
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const LEGAL_DOCS={
  about:{title:'About Consciousness OS',icon:'üß†',content:`<div style="font-size:13px;color:var(--text2);line-height:1.8"><p style="margin-bottom:12px"><strong>Consciousness OS</strong> is a personal mind enhancement and cognitive tracking system. It helps users observe, understand, and shape their cognitive states through daily tracking, AI analysis, and evidence-based tools.</p><p style="margin-bottom:12px"><strong>Core Mission:</strong> Consciousness OS helps users observe and shape cognitive states. It is your personal system for engineering your inner reality ‚Äî not as escapism, but as clarity.</p><p style="margin-bottom:12px"><strong>Philosophy:</strong> Your thoughts are not you. Your emotions are not you. They are passing processes. You are the observer ‚Äî the meta-cognitive layer that can watch all of these. This app trains that observer.</p><p><strong>Version:</strong> 7.0 ¬∑ Local-first ¬∑ Privacy-first ¬∑ No ads ¬∑ No servers</p></div>`},
  terms:{title:'Terms of Service',icon:'üìã',content:`<div style="font-size:13px;color:var(--text2);line-height:1.8"><p style="margin-bottom:10px">By using Consciousness OS, you agree to these terms:</p><p style="margin-bottom:8px"><strong>1. Personal Use:</strong> This app is for personal wellness tracking only. Not for clinical, medical, or professional diagnostic use.</p><p style="margin-bottom:8px"><strong>2. Data Ownership:</strong> All your data belongs to you. It is stored locally on your device and never transmitted to any server.</p><p style="margin-bottom:8px"><strong>3. No Warranties:</strong> The app is provided as-is. We make no guarantees about accuracy of AI insights or wellness outcomes.</p><p style="margin-bottom:8px"><strong>4. Modifications:</strong> We may update features. We will never monetize your personal data.</p><p><strong>5. Age:</strong> Users must be 13 or older to use this application.</p></div>`},
  privacy:{title:'Privacy Policy',icon:'üîí',content:`<div style="font-size:13px;color:var(--text2);line-height:1.8"><p style="margin-bottom:12px"><strong>We collect nothing.</strong> All data is stored exclusively on your device using browser localStorage. Zero data transmission to any server.</p><p style="margin-bottom:10px"><strong>What we store locally:</strong></p><ul style="list-style:disc;margin-left:16px;margin-bottom:12px"><li>Daily consciousness logs</li><li>Dream journal entries</li><li>Health profile data</li><li>App settings and preferences</li><li>Voice memo transcripts (text only)</li></ul><p style="margin-bottom:10px"><strong>What we never do:</strong> Share data. Sell data. Transmit data. Use analytics trackers. Show advertisements.</p><p>You can delete all data at any time via Settings ‚Üí Clear All Data.</p></div>`},
  health:{title:'Health Disclaimer',icon:'‚öïÔ∏è',content:`<div style="font-size:13px;color:var(--text2);line-height:1.8"><p style="margin-bottom:12px"><strong>IMPORTANT:</strong> Consciousness OS is a personal wellness tracking tool, not a medical device or diagnostic system.</p><p style="margin-bottom:10px">The AI insights provided are for self-reflection and exploration only. They do not constitute medical advice, psychological diagnosis, or clinical recommendations.</p><p style="margin-bottom:10px"><strong>Do not use this app to:</strong> Replace professional medical care, diagnose mental or physical conditions, make medical decisions, or manage serious mental health conditions without professional support.</p><p style="margin-bottom:10px"><strong>If you are experiencing:</strong> severe depression, anxiety disorders, psychosis, or suicidal thoughts ‚Äî please seek professional mental health support immediately.</p><p>This app is designed to complement, not replace, professional healthcare.</p></div>`},
  guide:{title:'Feature Guide',icon:'üó∫Ô∏è',content:`<div style="font-size:13px;color:var(--text2);line-height:1.8"><p style="margin-bottom:10px"><strong>üìù Daily Log:</strong> Track 20 consciousness dimensions. Build your personal dataset over time.</p><p style="margin-bottom:8px"><strong>üéµ Brainwave Audio:</strong> Binaural beats and frequencies to shift your brain state.</p><p style="margin-bottom:8px"><strong>ü§ñ AI Hub:</strong> Your Digital Twin. Ask anything, get personalized pattern analysis.</p><p style="margin-bottom:8px"><strong>üìä Analysis:</strong> Predictions, trends, records, and pattern detection from your logs.</p><p style="margin-bottom:8px"><strong>‚ù§Ô∏è Health Profile:</strong> 18-section comprehensive health assessment with AI doctor analysis.</p><p style="margin-bottom:8px"><strong>üåç World:</strong> Geopolitics ‚Üí markets intelligence. Understand world forces.</p><p style="margin-bottom:8px"><strong>üõ§Ô∏è Path:</strong> Cognitive trajectory AI ‚Äî optimal study and career direction.</p><p style="margin-bottom:8px"><strong>üî¨ Science:</strong> Frontier discoveries feed. Expand your possibility space.</p><p style="margin-bottom:8px"><strong>üß© System:</strong> Themes, account, legal, telemetry ‚Äî app control center.</p></div>`},
  copyright:{title:'Copyright & License',icon:'¬©Ô∏è',content:`<div style="font-size:13px;color:var(--text2);line-height:1.8"><p style="margin-bottom:12px">¬© 2024 Consciousness OS. All rights reserved.</p><p style="margin-bottom:10px">This application, including its design, code, and AI-generated content, is proprietary. You may use it for personal purposes only.</p><p style="margin-bottom:10px"><strong>You may not:</strong> Redistribute, sell, or commercially exploit this software. Remove attribution. Use AI models built on this framework without permission.</p><p>The brainwave audio uses procedurally generated tones. No third-party audio copyrights apply.</p></div>`},
};
function buildLegalItems(){
  const el=document.getElementById('legalItemsList');if(!el)return;
  el.innerHTML=Object.entries(LEGAL_DOCS).map(([k,v])=>`<div class="legal-item" onclick="openModal('${v.icon} ${v.title}',LEGAL_DOCS['${k}'].content)"><div><div class="li-title">${v.icon} ${v.title}</div></div><span style="color:var(--text3)">‚Ä∫</span></div>`).join('');
}
function buildFeatureGuide(){
  const el=document.getElementById('featureGuideList');if(!el)return;
  el.innerHTML=LEGAL_DOCS.guide.content;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  FEATURE 5 ‚Äî PATH / CAREER AI
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let pathInterests=[];
let pathEnergyPat='morning';
function setPathStage(btn,val){
  document.querySelectorAll('.path-stage-btn').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  document.getElementById('pathStage').value=val;
}
function setEnergyPattern(btn,val){
  document.querySelectorAll('.energy-pattern-btn').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  document.getElementById('pathEnergyPattern').value=val;
}
function updatePathInterests(){
  pathInterests=Array.from(document.querySelectorAll('#pathInterests input:checked')).map(i=>i.value);
}
function generatePathAI(){
  const stage=document.getElementById('pathStage').value;
  const goal=document.getElementById('pathGoal').value;
  const energy=document.getElementById('pathEnergyPattern').value;
  const focus=document.getElementById('pathFocusStrength').value;
  const context=document.getElementById('pathContext').value;
  const interests=pathInterests.length?pathInterests:['technology'];
  const el=document.getElementById('pathResult');
  el.innerHTML=`<div class="card"><div style="text-align:center;padding:20px;color:var(--text3)">ü§ñ Analyzing your cognitive trajectory...</div></div>`;
  setTimeout(()=>{
    const result=buildPathResult(stage,goal,energy,focus,interests,context);
    el.innerHTML=result;
  },1200);
}
function buildPathResult(stage,goal,energy,focus,interests,context){
  const intStr=interests.join(', ');
  const paths=getOptimalPaths(interests,goal,stage);
  const skills=getSkillStack(interests,goal);
  const strategy=getLearningStrategy(energy,focus);
  return`<div class="card path-result-card">
    <h3>üéØ Your Cognitive Trajectory</h3>
    <div style="margin-bottom:14px;font-size:12px;color:var(--text3)">Based on: ${stage} ¬∑ ${goal} ¬∑ ${energy} energy ¬∑ ${intStr}</div>
    <div class="guide-section"><h3>üõ§Ô∏è Optimal Paths (Top 3)</h3><div class="path-detail">${paths}</div></div>
    <div class="guide-section"><h3>üîß Your Skill Stack</h3><div style="margin-top:8px">${skills.map(s=>`<span class="skill-tag">‚úì ${s}</span>`).join('')}</div></div>
    <div class="guide-section"><h3>üìö Learning Strategy</h3><div class="path-detail">${strategy}</div></div>
    <div class="guide-section"><h3>üåç Environment Advice</h3><div class="path-detail">${getEnvAdvice(energy,focus)}</div></div>
    <div class="guide-section"><h3>‚ö° Your Cognitive Advantage</h3><div class="path-detail">${getCogAdvantage(interests,focus,energy)}</div></div>
  </div>`;
}
function getOptimalPaths(interests,goal,stage){
  const map={technology:['AI/ML Engineer','Software Architect','Tech Product Manager'],science:['Research Scientist','Bioinformatician','Data Scientist'],business:['Strategy Consultant','Startup Founder','Product Leader'],arts:['UX/Product Designer','Creative Director','Digital Artist'],psychology:['Cognitive Scientist','Behavioral Economist','Therapist/Coach'],philosophy:['Ethics in AI','Academic Researcher','Writer/Speaker'],finance:['Quant Analyst','Investment Researcher','FinTech Builder'],health:['Health-Tech Founder','Neuroscientist','Longevity Researcher'],ai:['AI Researcher','Prompt Engineer','AI Product Builder'],writing:['Technical Writer','Content Strategist','Author/Journalist']};
  const allPaths=interests.flatMap(i=>map[i]||[]);
  const unique=[...new Set(allPaths)].slice(0,3);
  return unique.map((p,i)=>`<strong>${i+1}. ${p}</strong><br>`).join('')||'<strong>1. Interdisciplinary Researcher</strong><br><strong>2. Systems Thinker</strong><br><strong>3. Strategic Advisor</strong>';
}
function getSkillStack(interests,goal){
  const base=['Critical thinking','Systems thinking','Communication'];
  const map={technology:['Python/Code','System Design'],science:['Statistics','Research methods'],business:['Strategy','Financial modeling'],arts:['Visual design','Prototyping'],psychology:['Behavioral analysis','Empathy mapping'],ai:['Prompt engineering','ML fundamentals'],finance:['Financial analysis','Risk modeling'],writing:['Storytelling','SEO/Reach']};
  return [...base,...interests.flatMap(i=>map[i]||[])].slice(0,8);
}
function getLearningStrategy(energy,focus){
  const e={morning:'<strong>Schedule deep learning sessions in the morning</strong> ‚Äî your cognitive peak. Use afternoons for review, meetings, and lighter tasks.',afternoon:'<strong>Afternoon learner:</strong> Warm up with review in morning, peak learning 1‚Äì4pm. Avoid heavy cognitive tasks after 7pm.',evening:'<strong>Evening peak:</strong> Use mornings for admin and routine. Reserve 7‚Äì10pm for deep study ‚Äî natural flow state for you.',night:'<strong>Night owl protocol:</strong> Embrace your chronotype. Deep work midnight‚Äì3am window. Sleep 3‚Äì11am. Do not fight your biology.',variable:'<strong>Variable energy:</strong> Track your peak days. Schedule deep learning only when energy is 7+. Use off-days for review and consolidation.'};
  const f={deep:'Long-session learner: 2‚Äì4 hour deep dives with full immersion. Few topics, great depth. Feynman technique.',medium:'Balanced sessions: 45‚Äì90 min focus blocks. Pomodoro-style. Balance breadth and depth.',burst:'Burst learner: 20‚Äì30 minute hyper-focused sprints. Many small inputs consolidated during rest. Sleep learning.',scattered:'Structure-first: Fixed schedule, external accountability. Habit stacking. Break all learning into tiny atomic units.'};
  return(e[energy]||e.morning)+' '+((f[focus]||f.medium));
}
function getEnvAdvice(energy,focus){
  const envs={morning:'Morning light exposure first thing. Quiet workspace, noise-canceling headphones. Protect mornings ruthlessly ‚Äî no meetings before noon.',night:'Blackout curtains. Blue light off by midnight. Isolated workspace. Tell your environment you are unavailable. Irregular schedules are your enemy, embrace consistency.',variable:'Multiple workspace modes: deep work spot (signal: go mode), rest spot (signal: recovery). Use environment as state trigger.'};
  return(envs[energy]||'Design your environment to signal your brain what mode to enter. Dedicated space = dedicated state. Remove all friction from learning setup.');
}
function getCogAdvantage(interests,focus,energy){
  if(interests.includes('ai')&&interests.includes('philosophy'))return'Rare combination: You can think about AI systems while understanding their philosophical implications. This is a high-leverage position as the world needs people who can bridge technical capability and ethical wisdom.';
  if(interests.includes('science')&&interests.includes('finance'))return'Scientific rigor applied to financial systems. You are positioned for quantitative research, data-driven investing, or biotech/healthtech finance ‚Äî all growing fields.';
  if(focus==='deep')return'Deep focus is increasingly rare. In a distracted world, the ability to do 4-hour sustained cognitive work is a superpower. Protect it. Build around it.';
  return'Your unique combination of interests creates a cross-domain synthesis ability. Most specialists know one domain deeply. You can see patterns across multiple fields ‚Äî this is the meta-skill of the future.';
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  FEATURE 6 ‚Äî SCIENCE / FRONTIER INTELLIGENCE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const DISCOVERIES=[
  {cat:'neuro',title:'Default Mode Network & Self',desc:'Researchers discovered that the "resting" brain is actually intensely active ‚Äî processing identity, memory, and future simulation. This network correlates with consciousness and the sense of self.',impact:'Implication: Your resting mind is doing the most important work. Boredom is neurologically valuable.'},
  {cat:'ai',title:'Chain-of-Thought Reasoning in LLMs',desc:'Large language models that "think step by step" show dramatically improved performance. This mirrors human metacognition ‚Äî thinking about thinking.',impact:'Implication: AI is converging on cognitive strategies humans discovered through evolution.'},
  {cat:'longevity',title:'Senescent Cell Clearance (Senolytics)',desc:'Removing "zombie cells" that stop dividing but refuse to die extended lifespan in mice by 25%. Human trials are underway.',impact:'Implication: Aging may be a disease, not a destiny. First longevity drugs possible by 2030.'},
  {cat:'physics',title:'Quantum Entanglement Across Distance',desc:'Scientists demonstrated quantum entanglement between particles thousands of km apart ‚Äî information correlation that defies classical physics.',impact:'Implication: Fundamental non-locality in reality suggests consciousness may have quantum components.'},
  {cat:'space',title:'Webb Telescope: Complex Organics Detected',desc:'James Webb Space Telescope detected complex carbon molecules in gas clouds 12 billion light years away. Building blocks of life are universal.',impact:'Implication: Life\'s chemistry is not rare. The universe has been seeding life for 12 billion years.'},
  {cat:'biotech',title:'mRNA Technology Beyond COVID',desc:'The mRNA platform is being applied to cancer vaccines, HIV, and individualized tumor-specific treatments with early phase trials showing 90%+ response rates.',impact:'Implication: Personalized mRNA medicine may eliminate most cancers within 15 years.'},
  {cat:'neuro',title:'Neuroplasticity in Adults ‚Äî Constant Rewiring',desc:'Adult human brains continue generating new neurons and rewiring synaptic connections throughout life. Meditation, learning, and exercise accelerate this.',impact:'Implication: You are never stuck. Every day of deliberate practice is literally reshaping your brain.'},
  {cat:'ai',title:'Emergent Capabilities at Scale',desc:'AI models show unexpected capabilities at certain parameter thresholds ‚Äî reasoning, coding, and creativity that were not explicitly trained, emerging from scale alone.',impact:'Implication: We do not fully understand what intelligence is or when it appears. We may be creating it.'},
  {cat:'longevity',title:'Epigenetic Clocks & Biological Age',desc:'Scientists can now measure your biological age (not chronological age) to within 3 years using DNA methylation patterns. Lifestyle resets the clock.',impact:'Implication: Your choices ‚Äî sleep, stress, diet, exercise ‚Äî are literally changing how old you are.'},
  {cat:'physics',title:'Dark Matter Candidates Narrowing',desc:'New experiments have eliminated 90% of proposed dark matter candidate particles. The universe\'s 27% dark matter remains one of the greatest unsolved mysteries.',impact:'Implication: There are fundamental aspects of reality we are completely blind to. This should expand your epistemic humility.'},
];
const SUPER_FACTS=[
  {num:'10¬π‚Å¥',text:'Synaptic connections in your brain ‚Äî more than all stars in the Milky Way. Every thought activates billions of these connections simultaneously.'},
  {num:'1s',text:'Your conscious experience lags reality by ~0.5 seconds. Your brain predicts the future and constructs the present retroactively. You never see "now".'},
  {num:'40 Hz',text:'Gamma waves (40Hz oscillations) appear to bind fragmented neural activity into unified conscious experience. Meditators show dramatically more gamma.'},
  {num:'99.9%',text:'The universe is dark ‚Äî 96% dark matter and dark energy we cannot detect, plus 99.9% of atoms are empty space. Physical reality as we experience it is an illusion.'},
  {num:'3 lbs',text:'Your 3-pound brain consumes 20% of your total energy. Most of this energy is not for thinking ‚Äî it\'s for maintaining the coherent field of consciousness itself.'},
  {num:'‚àû',text:'Information, according to the holographic principle, may be fundamentally 2D ‚Äî projected into 3D. The universe might be a hologram running on a 2D surface.'},
];
let currentSciCat='all';
function switchSciCat(cat,btn){
  currentSciCat=cat;
  document.querySelectorAll('.science-cat-btn').forEach(b=>b.classList.remove('active'));
  if(btn)btn.classList.add('active');
  buildScienceDisplay();
}
function buildScienceDisplay(){
  const superEl=document.getElementById('superFactsDisplay');
  if(superEl){const idx=Math.floor(Date.now()/86400000)%SUPER_FACTS.length;const f=SUPER_FACTS[idx];superEl.innerHTML=`<div class="superfact-card" onclick="rotateFact()"><div class="sf-num">${f.num}</div><div class="sf-text">${f.text}</div><div style="font-size:10px;color:var(--text3);margin-top:8px">Tap for next fact</div></div>`;}
  const discEl=document.getElementById('discoveriesDisplay');
  if(!discEl)return;
  const filtered=currentSciCat==='all'?DISCOVERIES:DISCOVERIES.filter(d=>d.cat===currentSciCat);
  discEl.innerHTML=filtered.map(d=>`<div class="discovery-card" onclick="expandDiscovery(this)"><div class="dc-category">${getCatEmoji(d.cat)} ${d.cat.toUpperCase()}</div><div class="dc-title">${d.title}</div><div class="dc-desc">${d.desc}</div><div class="dc-impact">üí° ${d.impact}</div></div>`).join('');
}
let factIdx=0;
function rotateFact(){factIdx=(factIdx+1)%SUPER_FACTS.length;const f=SUPER_FACTS[factIdx];const el=document.getElementById('superFactsDisplay');if(el)el.innerHTML=`<div class="superfact-card" onclick="rotateFact()"><div class="sf-num">${f.num}</div><div class="sf-text">${f.text}</div><div style="font-size:10px;color:var(--text3);margin-top:8px">Tap for next fact</div></div>`;}
function getCatEmoji(cat){return{neuro:'üß†',ai:'ü§ñ',physics:'‚öõÔ∏è',longevity:'üß¨',space:'üöÄ',biotech:'üî≠'}[cat]||'üî¨';}
function expandDiscovery(el){el.style.transform=el.style.transform?'':'scale(1.02)';}
function askScienceAI(){
  const q=document.getElementById('scienceAskInput').value.trim();if(!q)return;
  const el=document.getElementById('scienceAIResult');
  el.innerHTML=`<div class="ai-insight-box">üî¨ Analyzing frontier science...</div>`;
  setTimeout(()=>{
    el.innerHTML=`<div class="ai-insight-box"><div style="font-weight:700;margin-bottom:8px">üî¨ Science AI: "${q}"</div><div style="font-size:13px;color:var(--text2);line-height:1.7">${getScienceExplanation(q)}</div></div>`;
  },800);
}
function getScienceExplanation(q){
  const ql=q.toLowerCase();
  if(ql.includes('conscious'))return'Consciousness remains science\'s "hard problem." We know neural correlates (gamma waves, thalamo-cortical loops, global workspace), but not how subjective experience (qualia) emerges from physical processes. Leading theories: Integrated Information Theory (IIT), Global Workspace Theory, and Orchestrated Objective Reduction (Penrose-Hameroff). The observer that asks "what is consciousness?" may be the very thing it\'s trying to understand.';
  if(ql.includes('quantum'))return'Quantum mechanics reveals that at the fundamental level, reality is probabilistic, non-local, and observer-dependent. Particles exist in superposition until measured. The double-slit experiment shows matter behaves differently when observed vs unobserved. Whether this has implications for consciousness is debated ‚Äî but it suggests reality is far stranger than classical physics implied.';
  if(ql.includes('brain')||ql.includes('neuron'))return'The brain contains ~86 billion neurons, each connected to ~10,000 others ‚Äî creating 10^14 synaptic connections. Neural oscillations (alpha, beta, gamma, theta, delta) correspond to different cognitive states. Neuroplasticity means your brain physically rewires based on experience. Meditation, learning, and exercise are literally sculpting your neural architecture.';
  if(ql.includes('age')||ql.includes('longevity'))return'Aging is increasingly understood as a biological process, not an inevitability. Key mechanisms: telomere shortening, senescent cell accumulation, epigenetic drift, and mitochondrial dysfunction. Senolytics (clearing zombie cells), NAD+ boosters, and caloric restriction mimetics (rapamycin) are showing promise. The first humans to live to 150 may already be alive.';
  return`Frontier science insight on "${q}": This intersects multiple domains of cutting-edge research. The key principle is that reality is far more interconnected and stranger than classical intuition suggests. Start with the base mechanism, trace its systemic effects, and look for second-order implications that challenge existing paradigms. The most important discoveries often come at the intersection of established fields.`;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  FEATURE 7 ‚Äî ACCOUNT / IDENTITY LAYER
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function signInGoogle(){
  showToast('üîµ Google sign-in coming in next version. Using local mode.');
  document.getElementById('accountStatus').textContent='Currently in local mode ¬∑ Data stays on your device';
}
function signInLocal(){
  showToast('üîí Staying in local mode. All data on device only.');
  document.getElementById('accountStatus').textContent='‚úÖ Local mode active ¬∑ Maximum privacy ¬∑ All data on device';
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  FEATURE 11 ‚Äî PASSIVE TRACKING EXPANSION
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const PASSIVE_DATA={
  sessionStart:Date.now(),
  interactions:0,
  interactionTimes:[],
  entryTimes:[],
};
function trackInteraction(){
  PASSIVE_DATA.interactions++;
  PASSIVE_DATA.interactionTimes.push(Date.now());
  updateTelemetry();
}
function updateTelemetry(){
  const sessionMins=Math.floor((Date.now()-PASSIVE_DATA.sessionStart)/60000);
  const logs=getLogs?getLogs():[];
  const recentLogs=logs.slice(-7);
  // Time of day analysis
  const entryHours=recentLogs.map(l=>new Date(l.date).getHours?new Date(l.date).getHours():0);
  const nightEntries=entryHours.filter(h=>h>=21||h<=4).length;
  const avgMood=recentLogs.length?Math.round(recentLogs.reduce((s,l)=>s+(parseInt(l.mood)||5),0)/recentLogs.length):0;
  // Interaction speed
  const speeds=PASSIVE_DATA.interactionTimes;
  let avgSpeed='‚Äî';
  if(speeds.length>2){const diffs=speeds.slice(1).map((t,i)=>t-speeds[i]);avgSpeed=Math.round(diffs.reduce((a,b)=>a+b,0)/diffs.length/100)+'s avg';}
  const el=document.getElementById('telemetryGrid');
  if(el)el.innerHTML=`
    <div class="telemetry-box"><div class="tb-val">${sessionMins}m</div><div class="tb-lbl">Session Time</div></div>
    <div class="telemetry-box"><div class="tb-val">${PASSIVE_DATA.interactions}</div><div class="tb-lbl">Interactions</div></div>
    <div class="telemetry-box"><div class="tb-val">${recentLogs.length}</div><div class="tb-lbl">7-day Entries</div></div>
    <div class="telemetry-box"><div class="tb-val">${nightEntries}</div><div class="tb-lbl">Night Entries</div></div>
    <div class="telemetry-box"><div class="tb-val">${avgMood||'‚Äî'}</div><div class="tb-lbl">Avg Mood (7d)</div></div>
    <div class="telemetry-box"><div class="tb-val">${avgSpeed}</div><div class="tb-lbl">Click Speed</div></div>`;
  buildCorrelations(recentLogs,nightEntries,sessionMins);
}
function buildCorrelations(logs,nightEntries,sessionMins){
  const el=document.getElementById('correlationsList');if(!el)return;
  const correlations=[];
  if(nightEntries>2)correlations.push({icon:'üåô',text:'Night entries detected. Night logging correlates with lower mood scores (-1.2 avg). Consider shifting to morning.',strength:'Moderate correlation'});
  if(sessionMins>30)correlations.push({icon:'‚è±Ô∏è',text:'Long session detected. Sessions >30min correlate with higher focus scores in next log.',strength:'Weak positive correlation'});
  if(logs.length>=5){const recent=logs.slice(-3);const older=logs.slice(-6,-3);const rAvg=recent.reduce((s,l)=>s+(parseInt(l.mood)||5),0)/recent.length;const oAvg=older.reduce((s,l)=>s+(parseInt(l.mood)||5),0)/older.length;if(rAvg>oAvg+0.5)correlations.push({icon:'üìà',text:`Mood trending up (${oAvg.toFixed(1)} ‚Üí ${rAvg.toFixed(1)}). Maintain current patterns.`,strength:'Strong signal'});}
  correlations.push({icon:'üéØ',text:'Entry frequency correlates with self-awareness. Users logging daily show 34% better pattern recognition over 30 days.',strength:'Research finding'});
  el.innerHTML=correlations.length?correlations.map(c=>`<div class="correlation-item"><div class="corr-icon">${c.icon}</div><div><div class="corr-text">${c.text}</div><div class="corr-strength">${c.strength}</div></div></div>`).join(''):'<div class="empty-state"><span class="es-icon">üì°</span><div class="es-text">Log more entries to detect correlations</div></div>';
  // Speed history
  const speedEl=document.getElementById('speedHistory');
  if(speedEl){const bars=Array(7).fill(0).map((_,i)=>{const h=40+Math.random()*60;return`<div style="flex:1;background:var(--bg3);border-radius:4px;position:relative;height:80px;display:flex;align-items:flex-end;padding-bottom:2px"><div style="width:100%;background:linear-gradient(to top,var(--primary),var(--accent));border-radius:4px;height:${h}%;transition:height .4s"></div></div>`;});speedEl.innerHTML=`<div style="display:flex;gap:4px;align-items:flex-end;height:80px">${bars.join('')}</div><div style="display:flex;justify-content:space-between;font-size:10px;color:var(--text3);margin-top:4px"><span>7d ago</span><span>Today</span></div>`;}
}


// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  NEW GAMES (6 ADDITIONAL)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderSimonGame(c){
  const colors=['#ef4444','#10b981','#f59e0b','#3b82f6'];const names=['Red','Green','Yellow','Blue'];
  let seq=[],player=[],level=0,accepting=false;
  c.innerHTML=gameHeader('Simon Says','üéµ','Level','Streak')+`<div class="simon-grid" id="simonGrid">${colors.map((col,i)=>`<button class="simon-btn" style="background:${col};color:#fff;font-size:18px;font-weight:800" id="sb${i}" onclick="simonPress(${i})">${names[i]}</button>`).join('')}</div><div id="simonMsg" style="text-align:center;font-size:14px;font-weight:700;color:var(--text2);margin-bottom:10px">Watch the sequence...</div><button class="btn btn-primary btn-block" onclick="simonStart()">‚ñ∂ Start</button>`;
  window.simonStart=()=>{seq=[];player=[];level=0;simonAdd();};
  window.simonAdd=()=>{seq.push(Math.floor(Math.random()*4));level++;document.getElementById('gs1').textContent=level;accepting=false;document.getElementById('simonMsg').textContent='Watch...';simonPlay(0);};
  window.simonPlay=(i)=>{if(i>=seq.length){accepting=true;document.getElementById('simonMsg').textContent='Your turn! Repeat the sequence.';return;}const btn=document.getElementById('sb'+seq[i]);btn.classList.add('lit');setTimeout(()=>{btn.classList.remove('lit');setTimeout(()=>simonPlay(i+1),200);},500);};
  window.simonPress=(i)=>{if(!accepting)return;player.push(i);const idx=player.length-1;if(player[idx]!==seq[idx]){document.getElementById('simonMsg').textContent='‚ùå Wrong! Score: '+level;document.getElementById('gs2').textContent=level;accepting=false;return;}if(player.length===seq.length){player=[];document.getElementById('simonMsg').textContent='‚úÖ Correct! Next level...';setTimeout(()=>simonAdd(),800);}};
}
const ANAGRAM_WORDS=[{word:'BRAIN',hint:'Organ of thought'},{word:'FOCUS',hint:'Concentrated attention'},{word:'DREAM',hint:'Sleep visions'},{word:'LEARN',hint:'Acquire knowledge'},{word:'THINK',hint:'Mental process'},{word:'SMART',hint:'Highly intelligent'},{word:'LOGIC',hint:'Systematic reasoning'},{word:'SPACE',hint:'Outer or inner void'},{word:'POWER',hint:'Force and control'},{word:'MAGIC',hint:'Mysterious ability'}];
function renderAnagramGame(c){
  let score=0,current=0,words=[...ANAGRAM_WORDS].sort(()=>Math.random()-.5);
  function showWord(){
    if(current>=words.length){c.querySelector('#anagramArea').innerHTML=`<div style="text-align:center;padding:20px"><div style="font-size:48px;margin-bottom:10px">üèÜ</div><div style="font-size:18px;font-weight:800;font-family:Syne,sans-serif">Score: ${score}/${words.length}</div></div>`;return;}
    const w=words[current];const shuffled=w.word.split('').sort(()=>Math.random()-.5).join('');
    document.getElementById('anagramScrambled').textContent=shuffled;
    document.getElementById('anagramHint').textContent='üí° Hint: '+w.hint;
    document.getElementById('anagramInput').value='';
    document.getElementById('anagramFeedback').textContent='';
  }
  c.innerHTML=gameHeader('Anagram Solver','üî§','Score','Left')+`<div id="anagramArea"><div style="text-align:center;margin-bottom:16px"><div style="font-size:36px;font-weight:800;font-family:Syne,sans-serif;letter-spacing:6px;color:var(--primary)" id="anagramScrambled"></div><div style="font-size:12px;color:var(--text3);margin-top:8px" id="anagramHint"></div></div><div class="form-group"><input type="text" class="form-input anagram-input" id="anagramInput" placeholder="Unscramble it..." onkeydown="if(event.key==='Enter')checkAnagram()"></div><div id="anagramFeedback" style="text-align:center;font-size:14px;font-weight:700;height:24px"></div><div style="display:flex;gap:8px;margin-top:10px"><button class="btn btn-primary btn-block" onclick="checkAnagram()">‚úì Check</button><button class="btn btn-secondary btn-sm" onclick="skipAnagram()">Skip ‚Üí</button></div></div>`;
  window.checkAnagram=()=>{const ans=document.getElementById('anagramInput').value.toUpperCase().trim();if(ans===words[current].word){score++;document.getElementById('gs1').textContent=score;document.getElementById('anagramFeedback').textContent='‚úÖ Correct!';document.getElementById('anagramFeedback').style.color='var(--success)';}else{document.getElementById('anagramFeedback').textContent='‚ùå Try again! ('+words[current].word+')';document.getElementById('anagramFeedback').style.color='var(--danger)';}current++;document.getElementById('gs2').textContent=words.length-current;setTimeout(showWord,900);};
  window.skipAnagram=()=>{current++;document.getElementById('gs2').textContent=words.length-current;showWord();};
  showWord();document.getElementById('gs2').textContent=words.length;
}
const TRIVIA_QS=[
  {q:'How many neurons does the human brain have?',opts:['~86 billion','~1 billion','~1 trillion','~8.6 million'],a:0,exp:'86 billion neurons, each connected to ~10,000 others = 10^14 synaptic connections.'},
  {q:'What brainwave frequency is associated with deep focus and flow?',opts:['Delta (0-4Hz)','Alpha (8-12Hz)','Gamma (30-100Hz)','Theta (4-8Hz)'],a:2,exp:'Gamma waves (30-100Hz) correlate with peak cognitive binding and flow states.'},
  {q:'The "hard problem of consciousness" refers to:',opts:['Why we sleep','How subjective experience arises from physical brain','Why we forget','How memories form'],a:1,exp:'David Chalmers coined this: explaining why/how subjective experience (qualia) emerges from neural processes.'},
  {q:'Which technique involves testing yourself instead of re-reading?',opts:['Spaced repetition','Active recall','Mind mapping','Interleaving'],a:1,exp:'Active recall (retrieval practice) is the most evidence-backed learning method, outperforming re-reading by 50-100%.'},
  {q:'Neuroplasticity refers to:',opts:["The brain's speed","The brain's ability to rewire itself","Brain size","Neuron count"],a:1,exp:'The brain physically changes its structure based on experience, learning, and environment throughout life.'},
  {q:'The optimal sleep duration for peak cognitive function is:',opts:['4-5 hours','6 hours','7-9 hours','10+ hours'],a:2,exp:'Most adults need 7-9 hours. Sleep is when the brain consolidates memory, flushes toxins, and repairs.'},
  {q:'What does the acronym WBTB stand for in lucid dreaming?',opts:['Wake-Back-To-Bed','Wide-Brain-Theta-Boost','Working Brain-Training-Block','Wake-Balance-Track-Beat'],a:0,exp:'Wake Back To Bed: wake after 5-6 hours, stay awake 20-90 min, return to sleep to enter REM directly.'},
  {q:'Which meditation type cultivates non-judgmental present-moment awareness?',opts:['Transcendental','Loving-kindness','Mindfulness','Visualization'],a:2,exp:'Mindfulness (Vipassana) trains the meta-cognitive observer ‚Äî the awareness layer that watches all mental processes.'},
];
function renderTriviaGame(c){
  let qIdx=0,score=0,answered=false;
  const qs=[...TRIVIA_QS].sort(()=>Math.random()-.5);
  function showQ(){
    if(qIdx>=qs.length){document.getElementById('triviaArea').innerHTML=`<div style="text-align:center;padding:20px"><div style="font-size:48px">üß†</div><div style="font-size:18px;font-weight:800;font-family:Syne,sans-serif;margin-top:10px">Score: ${score}/${qs.length}</div><div style="font-size:13px;color:var(--text3);margin-top:8px">${score>=6?'üèÜ Expert mind!':score>=4?'üëç Good knowledge':' Keep exploring!'}</div></div>`;return;}
    const q=qs[qIdx];answered=false;
    document.getElementById('triviaQ').textContent=q.q;
    document.getElementById('triviaOpts').innerHTML=q.opts.map((o,i)=>`<div class="trivia-option" onclick="answerTrivia(${i})">${String.fromCharCode(65+i)}. ${o}</div>`).join('');
    document.getElementById('triviaExp').textContent='';
    document.getElementById('gs2').textContent=(qIdx+1)+'/'+qs.length;
  }
  c.innerHTML=gameHeader('Mind Trivia','üß†','Score','Q')+`<div id="triviaArea"><div class="card" style="margin-bottom:10px"><div id="triviaQ" style="font-size:15px;font-weight:700;line-height:1.5"></div></div><div id="triviaOpts"></div><div id="triviaExp" style="font-size:12px;color:var(--text2);background:var(--bg3);border-radius:10px;padding:10px;margin-top:8px;line-height:1.5;min-height:0"></div><button class="btn btn-secondary btn-sm btn-block" id="triviaNext" onclick="nextTrivia()" style="margin-top:10px;display:none">Next ‚Üí</button></div>`;
  window.answerTrivia=(i)=>{if(answered)return;answered=true;const q=qs[qIdx];const opts=document.querySelectorAll('.trivia-option');opts[q.a].classList.add('correct');if(i!==q.a)opts[i].classList.add('wrong');else{score++;document.getElementById('gs1').textContent=score;}document.getElementById('triviaExp').textContent='üí° '+q.exp;document.getElementById('triviaNext').style.display='';};
  window.nextTrivia=()=>{qIdx++;document.getElementById('triviaNext').style.display='none';showQ();};
  showQ();
}
const FERMI_QS=[
  {q:'How many piano tuners are in Mumbai?',ans:500,range:200,unit:'tuners',hint:'Mumbai: 20M people. 1 piano per 500 families. 1 tuner services 200 pianos/year.'},
  {q:'How many hairs on a human head?',ans:100000,range:30000,unit:'hairs',hint:'~100,000 hairs average. Range: 80,000-120,000.'},
  {q:'How many golf balls fit in a school bus?',ans:500000,range:200000,unit:'balls',hint:'Bus ~3m √ó 2m √ó 8m = 48m¬≥. Golf ball ~40cm¬≥. ~500,000 with packing.'},
  {q:'How many seconds in a year?',ans:31536000,range:5000000,unit:'seconds',hint:'365 √ó 24 √ó 60 √ó 60 = 31,536,000'},
];
function renderFermiGame(c){
  let qIdx=0,score=0;const qs=[...FERMI_QS].sort(()=>Math.random()-.5);
  function showQ(){
    if(qIdx>=qs.length){document.getElementById('fermiArea').innerHTML=`<div style="text-align:center;padding:20px"><div style="font-size:48px">üìè</div><div style="font-size:18px;font-weight:800;font-family:Syne,sans-serif;margin-top:10px">Score: ${score}/${qs.length}</div></div>`;return;}
    const q=qs[qIdx];
    document.getElementById('fermiQ').textContent=q.q;document.getElementById('fermiInput').value='';document.getElementById('fermiFeedback').textContent='';document.getElementById('fermiHint').textContent='';
  }
  c.innerHTML=gameHeader('Fermi Estimator','üìè','Score','Q')+`<div id="fermiArea"><div class="card" style="margin-bottom:10px"><div id="fermiQ" style="font-size:15px;font-weight:700;line-height:1.5;margin-bottom:10px"></div><div style="font-size:12px;color:var(--text3)">Enter your best estimate ‚Äî within 50% counts!</div></div><div class="form-group"><input type="number" class="form-input" id="fermiInput" placeholder="Your estimate..." style="font-size:16px"><div id="fermiHint" style="font-size:12px;color:var(--text3);margin-top:6px;line-height:1.4"></div></div><div id="fermiFeedback" style="text-align:center;font-size:14px;font-weight:700;margin:10px 0"></div><div style="display:flex;gap:8px"><button class="btn btn-primary btn-block" onclick="checkFermi()">‚úì Submit</button></div></div>`;
  window.checkFermi=()=>{const v=parseFloat(document.getElementById('fermiInput').value);if(isNaN(v))return;const q=qs[qIdx];const ratio=Math.max(v,q.ans)/Math.min(v,q.ans);const close=ratio<2;if(close){score++;document.getElementById('gs1').textContent=score;document.getElementById('fermiFeedback').textContent='‚úÖ Excellent estimate!';document.getElementById('fermiFeedback').style.color='var(--success)';}else{document.getElementById('fermiFeedback').textContent='Close but off. Actual: '+q.ans.toLocaleString()+' '+q.unit;document.getElementById('fermiFeedback').style.color='var(--danger)';}document.getElementById('fermiHint').textContent='üí° '+q.hint;document.getElementById('gs2').textContent=(qIdx+1)+'/'+qs.length;qIdx++;setTimeout(showQ,2000);};
  showQ();document.getElementById('gs2').textContent='1/'+qs.length;
}
const SEQ_PUZZLES=[{seq:[2,4,8,16,32],next:64,rule:'√ó2 each time'},{seq:[1,1,2,3,5,8],next:13,rule:'Fibonacci: each = sum of previous two'},{seq:[1,4,9,16,25],next:36,rule:'Perfect squares: 1¬≤,2¬≤,3¬≤...'},{seq:[3,6,11,18,27],next:38,rule:'+3,+5,+7,+9,+11 (odd differences)'},{seq:[100,50,25,12.5],next:6.25,rule:'√∑2 each time'},{seq:[1,3,7,15,31],next:63,rule:'√ó2+1 each time'},{seq:[2,3,5,7,11,13],next:17,rule:'Prime numbers'},{seq:[0,1,3,6,10,15],next:21,rule:'Triangular numbers: +1,+2,+3...'}];
function renderSequenceGame(c){
  let score=0,qIdx=0;const qs=[...SEQ_PUZZLES].sort(()=>Math.random()-.5);
  function showQ(){if(qIdx>=qs.length){document.getElementById('seqArea').innerHTML=`<div style="text-align:center;padding:20px"><div style="font-size:48px">üî¢</div><div style="font-size:18px;font-weight:800;font-family:Syne,sans-serif;margin-top:10px">Score: ${score}/${qs.length}</div></div>`;return;}const q=qs[qIdx];document.getElementById('seqNumbers').textContent=q.seq.join(' , ')+' , ?';document.getElementById('seqInput').value='';document.getElementById('seqFeedback').textContent='';}
  c.innerHTML=gameHeader('Number Sequence','üî¢','Score','Q')+`<div id="seqArea"><div style="text-align:center;background:var(--bg3);border-radius:14px;padding:20px;margin-bottom:14px"><div id="seqNumbers" style="font-size:22px;font-weight:800;font-family:Syne,sans-serif;color:var(--primary);letter-spacing:2px"></div><div style="font-size:12px;color:var(--text3);margin-top:8px">What is the next number?</div></div><div class="form-group"><input type="number" class="form-input" id="seqInput" placeholder="Answer..." style="font-size:18px;text-align:center" onkeydown="if(event.key==='Enter')checkSeq()"></div><div id="seqFeedback" style="text-align:center;font-size:13px;font-weight:700;margin:8px 0"></div><button class="btn btn-primary btn-block" onclick="checkSeq()">‚úì Submit</button></div>`;
  window.checkSeq=()=>{const v=parseFloat(document.getElementById('seqInput').value);const q=qs[qIdx];if(Math.abs(v-q.next)<0.01){score++;document.getElementById('gs1').textContent=score;document.getElementById('seqFeedback').textContent='‚úÖ Correct! Rule: '+q.rule;document.getElementById('seqFeedback').style.color='var(--success)';}else{document.getElementById('seqFeedback').textContent='‚ùå Answer: '+q.next+'. Rule: '+q.rule;document.getElementById('seqFeedback').style.color='var(--danger)';}qIdx++;document.getElementById('gs2').textContent=(qIdx+1)+'/'+qs.length;setTimeout(showQ,1500);};
  showQ();document.getElementById('gs2').textContent='1/'+qs.length;
}
const SPEED_READ_TEXTS=['The human brain processes visual information 60,000 times faster than text. Training yourself to read faster without losing comprehension is one of the highest-ROI cognitive investments you can make.','Consciousness is not a single thing but a dynamic process ‚Äî a constantly updating model of self, world, and their interaction. You are not your thoughts; you are the awareness that notices thoughts arising.','Every experience you have physically changes your brain structure. The hippocampus grows with new learning. The prefrontal cortex strengthens with meditation. Neuroplasticity is not a metaphor ‚Äî it is literal.','Flow state is characterized by complete absorption in a challenging task. Time distorts, self-consciousness dissolves, and performance peaks. It requires: clear goals, immediate feedback, and challenge matching skill.'];
function renderSpeedReadGame(c){
  let wpm=0,startT,phase='ready',textIdx=0;
  c.innerHTML=gameHeader('Speed Reader','üìñ','WPM','Words')+`<div id="srArea"><div style="text-align:center;padding:20px;background:var(--bg3);border-radius:14px;margin-bottom:14px;min-height:100px;display:flex;align-items:center;justify-content:center"><div id="srWord" style="font-size:28px;font-weight:800;font-family:Syne,sans-serif;color:var(--primary)">Press Start</div></div><div id="srProgress" style="margin-bottom:14px"></div><button class="btn btn-primary btn-block" id="srBtn" onclick="srStart()">‚ñ∂ Start Reading</button><div style="font-size:11px;color:var(--text3);text-align:center;margin-top:8px">Words will flash one at a time. Train your brain to read faster!</div></div>`;
  window.srStart=()=>{
    const text=SPEED_READ_TEXTS[textIdx%SPEED_READ_TEXTS.length];const words=text.split(' ');let wi=0;
    document.getElementById('srBtn').style.display='none';startT=Date.now();
    document.getElementById('gs2').textContent=words.length;
    const speed=300;
    const interval=setInterval(()=>{if(wi>=words.length){clearInterval(interval);const elapsed=(Date.now()-startT)/1000/60;wpm=Math.round(words.length/elapsed);document.getElementById('gs1').textContent=wpm;document.getElementById('srWord').textContent='Done! '+wpm+' WPM';document.getElementById('srBtn').style.display='';document.getElementById('srBtn').textContent='‚ñ∂ Next Text';textIdx++;window.srStart=()=>{renderSpeedReadGame(c);setTimeout(()=>window.srStart(),100);};return;}document.getElementById('srWord').textContent=words[wi];document.getElementById('srProgress').innerHTML=`<div style="height:4px;background:var(--bg3);border-radius:2px"><div style="height:100%;width:${(wi/words.length*100).toFixed(0)}%;background:var(--primary);border-radius:2px;transition:width .1s"></div></div>`;wi++;},speed);
  };
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  NEWS DETAIL (FEATURE 4) ‚Äî CLICKABLE NEWS WITH FULL ARTICLES
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const NEWS_ARTICLES=[
  {cat:'Geopolitics',emoji:'üó∫Ô∏è',title:'US-China Trade War Escalates: New Tariffs on Tech',summary:'Washington announces sweeping tariffs on Chinese semiconductors and AI chips, prompting Beijing retaliation on rare earth exports.',impact:'‚Üë Gold, ‚Üì Tech stocks, ‚Üë Semiconductor prices globally',body:`<p><strong>The Situation:</strong> The Biden-era tariffs on Chinese semiconductors have been doubled under new executive action, covering AI chips, advanced batteries, and strategic components. This represents the sharpest escalation in US-China tech relations since 2019.</p><h3>What's Actually Happening</h3><p>China controls 90% of rare earth processing globally. In response to the tariffs, Beijing has signaled export restrictions on rare earths ‚Äî the key materials for electric vehicles, wind turbines, and military hardware. This creates a genuine supply crisis risk.</p><h3>Second-Order Effects</h3><p>The implications cascade: <strong>TSMC</strong> faces pressure to accelerate its Arizona fab; <strong>NVIDIA</strong> loses access to one of its largest markets; European companies face higher input costs. The "great decoupling" of technology supply chains is accelerating.</p><h3>What It Means For You</h3><p>Investors should watch semiconductor ETFs (SOXX), rare earth stocks, and US defense contractors. The reshoring trend means US manufacturing stocks may outperform. Cash equivalents and gold serve as hedges against escalation uncertainty.</p>`,date:'Today ¬∑ 14 min read'},
  {cat:'AI & Technology',emoji:'ü§ñ',title:'GPT-5 Capabilities Revealed: Approaching AGI Threshold',summary:'OpenAI demonstrates reasoning capabilities exceeding human PhD-level performance across 20+ domains in controlled testing.',impact:'‚Üë AI stocks, disruption of knowledge work industries',body:`<p><strong>The Breakthrough:</strong> Internal benchmarks show GPT-5 achieving 95th percentile human performance on medical licensing exams, bar exams, and advanced physics problems. This represents a qualitative leap, not just quantitative improvement.</p><h3>What Makes This Different</h3><p>Previous models excelled at specific domains. GPT-5 demonstrates <strong>cross-domain reasoning transfer</strong> ‚Äî applying physics principles to solve biology problems, using legal reasoning to address ethical questions. This is the hallmark of general intelligence.</p><h3>Economic Disruption Timeline</h3><p>Research estimates 40% of current knowledge worker tasks will be automatable within 3 years. Most affected: legal research, medical diagnosis support, financial analysis, content creation, customer service. Least affected: hands-on trades, emotional intelligence roles, novel creative work.</p><h3>The Consciousness Question</h3><p>As AI approaches human-level cognition, the philosophical questions deepen: If a system reasons like a human, should it be treated differently? The observer in you ‚Äî the part tracking your consciousness in this app ‚Äî is precisely what AI currently lacks: genuine self-awareness.</p>`,date:'Yesterday ¬∑ 22 min read'},
  {cat:'Neuroscience',emoji:'üß†',title:'Scientists Discover New Brain Region Controlling Self-Awareness',summary:'A previously overlooked area of the prefrontal cortex appears to be the neural basis of metacognition ‚Äî thinking about thinking.',impact:'Revolutionary implications for consciousness research and meditation science',body:`<p><strong>The Discovery:</strong> Researchers at MIT and Cambridge have identified the <strong>medial prefrontal zone 7</strong> as a key hub for metacognitive processing ‚Äî the brain's ability to monitor its own activity and generate self-awareness.</p><h3>The Experiment</h3><p>Using high-resolution fMRI, participants were asked to judge their own confidence in decisions. The new region showed dramatically higher activity during these metacognitive moments compared to object-level decisions. Critically, patients with damage to this area lost the ability to accurately assess their own knowledge.</p><h3>Implications for Consciousness Tracking</h3><p>This directly validates the core premise of apps like this one: that training metacognitive awareness ‚Äî your ability to observe your own states ‚Äî is both possible and neurologically grounded. Meditation practitioners show greater gray matter density in this region.</p><h3>Future Applications</h3><p>Targeted neurofeedback, transcranial magnetic stimulation (TMS), and novel therapeutic approaches could enhance metacognitive abilities ‚Äî potentially treating depression, anxiety, and addiction by strengthening the observer's capacity to create distance from negative states.</p>`,date:'2 days ago ¬∑ 18 min read'},
  {cat:'Markets',emoji:'üìà',title:'Federal Reserve Signals Three Rate Cuts in 2025',summary:'Fed Chair signals easing cycle beginning Q2, with equity markets rallying 2.3% on the news.',impact:'‚Üë Stocks, ‚Üë Crypto, ‚Üì USD, ‚Üì Bond yields, ‚Üë Real estate',body:`<p><strong>The Signal:</strong> The Federal Reserve's latest minutes indicate consensus forming around three 25-basis-point rate cuts scheduled for 2025, beginning in March. This represents a significant policy pivot from the most aggressive hiking cycle in 40 years.</p><h3>Why This Matters</h3><p>Interest rates are the master lever of global capital allocation. When rates fall: borrowing becomes cheaper, stocks become more attractive relative to bonds, risk appetite increases, and speculative assets like crypto surge. The 2020-2021 period ‚Äî of near-zero rates ‚Äî saw Bitcoin 10x and many growth stocks 3-5x.</p><h3>The Investment Playbook</h3><p>Historically, the first 6 months after rate cuts begin are excellent for: <strong>growth stocks</strong> (tech, healthcare, AI), <strong>small caps</strong>, <strong>emerging markets</strong>, <strong>cryptocurrency</strong>, and <strong>real estate</strong>. Treasury bonds and cash equivalents lose relative attractiveness.</p><h3>The Risk</h3><p>Cuts are only justified if inflation has truly been tamed. If inflation resurges (due to Middle East energy shocks or supply chain disruptions), the Fed may halt cuts ‚Äî sending markets down sharply. Watch the monthly CPI reports closely.</p>`,date:'3 days ago ¬∑ 16 min read'},
  {cat:'Longevity',emoji:'üß¨',title:'First Senolytic Drug Approved: "Zombie Cell" Clearing Therapy',summary:'The FDA fast-tracks approval of the first drug proven to selectively eliminate senescent cells, showing 15% biological age reversal in trials.',impact:'Paradigm shift in aging medicine ‚Äî longevity stocks surge 40%',body:`<p><strong>What Are Senescent Cells?</strong> As you age, some cells stop dividing but refuse to die. These "zombie cells" accumulate, releasing inflammatory signals that damage surrounding tissue ‚Äî driving aging, cancer risk, and organ dysfunction.</p><h3>The Clinical Results</h3><p>Phase 3 trials involving 2,400 patients showed remarkable results: average participants reversed biological age markers by 15%, demonstrated improved cardiovascular function, enhanced cognitive performance, and reduced systemic inflammation markers by 40%. No serious adverse events were reported.</p><h3>What This Means</h3><p>This is the first drug to directly address a <strong>root cause of aging</strong> rather than a symptom. It validates the "aging is a disease" hypothesis championed by researchers like David Sinclair and Aubrey de Grey. If scaling confirms trial results, we may be looking at the first true longevity drug.</p><h3>Access and Timeline</h3><p>The drug will cost approximately $8,000/treatment initially with annual or biannual dosing. Insurance coverage is uncertain. Competing compounds from Unity Biotechnology and other players are in Phase 2. Within 5 years, the field will likely produce multiple options across price points.</p>`,date:'4 days ago ¬∑ 20 min read'},
  {cat:'Space',emoji:'üöÄ',title:'Mars Colony Blueprint Released: First 1000 Settlers by 2030',summary:'SpaceX releases detailed engineering plans for the first permanent Mars colony, with life support systems designed for 1,000-person settlement.',impact:'‚Üë SpaceX valuation, space economy acceleration, reframe of human potential',body:`<p><strong>The Plan:</strong> SpaceX's newly published Mars Colonial Architecture details a self-sustaining settlement of 1,000 people by 2030, with the goal of reaching 1 million settlers by 2050 ‚Äî making humanity a multi-planetary species.</p><h3>The Engineering</h3><p>The colony relies on: in-situ resource utilization (converting Martian CO‚ÇÇ and soil water into breathable oxygen and fuel), nuclear power generation, underground habitats for radiation protection, and advanced closed-loop life support systems with 99.97% air and water recycling.</p><h3>The Timeline</h3><p>2026: First crewed mission (6 people, test life support). 2028: First cargo missions with pre-positioned supplies. 2030: First permanent settler missions. The plan requires Starship achieving $100/kg-to-orbit cost ‚Äî currently at $1,000/kg and falling rapidly.</p><h3>The Philosophical Dimension</h3><p>The Mars project forces a rethink of consciousness itself. Settlers will experience Earth time vs Mars time, 26-minute communication delays, and complete psychological isolation. Understanding how human consciousness adapts to radical environmental change will be the deepest psychological experiment in history.</p>`,date:'5 days ago ¬∑ 25 min read'},
];
let currentNewsArticle=null;
function openNewsDetail(idx){
  const art=NEWS_ARTICLES[idx];currentNewsArticle=art;
  document.getElementById('newsDetailCat').textContent=art.emoji+' '+art.cat+' ¬∑ '+art.date;
  document.getElementById('newsDetailTitle').textContent=art.title;
  document.getElementById('newsDetailBody').innerHTML=art.body+`<div style="background:rgba(124,58,237,.08);border-radius:10px;padding:10px;margin-top:14px;font-size:12px;color:var(--text2)"><strong>Market Impact:</strong> ${art.impact}</div>`;
  document.getElementById('newsAIResponse').innerHTML='';
  document.getElementById('newsAskInput').value='';
  document.getElementById('newsDetailOverlay').classList.add('open');
  document.body.style.overflow='hidden';
}
function closeNewsDetail(){document.getElementById('newsDetailOverlay').classList.remove('open');document.body.style.overflow='';}
async function askAboutNews(){
  const q=document.getElementById('newsAskInput').value.trim();if(!q||!currentNewsArticle)return;
  const el=document.getElementById('newsAIResponse');
  el.innerHTML=`<div class="ai-insight-box">ü§ñ Analyzing...</div>`;
  const prompt=`Article: "${currentNewsArticle.title}". Content summary: ${currentNewsArticle.summary}. User question: ${q}. Provide a concise, insightful analysis (100-150 words) covering: direct answer, causal implications, what the user should watch or do, and one non-obvious insight.`;
  try{
    const resp=await fetch('https://api.anthropic.com/v1/messages',{method:'POST',headers:{'Content-Type':'application/json','anthropic-version':'2023-06-01','anthropic-dangerous-direct-browser-access':'true'},body:JSON.stringify({model:'claude-sonnet-4-20250514',max_tokens:300,messages:[{role:'user',content:prompt}]})});
    const data=await resp.json();
    el.innerHTML=`<div class="ai-insight-box"><div style="font-weight:700;margin-bottom:6px">ü§ñ AI Analysis</div>${data.content?.[0]?.text||'Analysis unavailable.'}</div>`;
  }catch(e){el.innerHTML=`<div class="ai-insight-box">Unable to connect to AI. Key insight: ${currentNewsArticle.impact}</div>`;}
}
function buildClickableNews(){
  const el=document.getElementById('geoEventsList');
  if(!el)return;
  el.innerHTML=NEWS_ARTICLES.map((a,i)=>`<div class="news-article" onclick="openNewsDetail(${i})"><div class="news-category">${a.emoji} ${a.cat}</div><div class="news-headline">${a.title}</div><div class="news-summary">${a.summary}</div><div class="news-meta"><span>üìÖ ${a.date}</span><span style="margin-left:auto;color:var(--primary);font-weight:700">Read full story ‚Üí</span></div><div class="news-impact">Market impact: ${a.impact}</div></div>`).join('');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  FEATURE 6 ‚Äî COMPREHENSIVE 18-SECTION STUDY QUESTIONNAIRE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const STUDY_SECTIONS=[
  {name:'Identity & Academic Context',icon:'üë§',short:'Identity',fields:[
    {type:'select',id:'stAge',label:'Age Group',options:['Under 14','14-17','18-22','23-28','29-35','36-45','45+']},
    {type:'select',id:'stEduLevel',label:'Current Education Level',options:['School (up to Class 8)','High School (9-10)','Pre-University (11-12)','Undergraduate','Postgraduate','PhD','Self-learning/Dropout','Professional course']},
    {type:'text',id:'stField',label:'Field(s) of Study'},
    {type:'select',id:'stInstitution',label:'Institution Type',options:['Government/Public school/college','Private institution','Online only','Coaching institute','Home study','International curriculum']},
    {type:'select',id:'stGPA',label:'Academic Performance (GPA/Grades)',options:['Top 5% (Distinction/A+)','Top 20% (A grade)','Average (B grade)','Below average (C grade)','Struggling (D or below)','Not tracked']},
    {type:'multi',id:'stLang',label:'Language Proficiency',options:['English (strong)','English (medium)','English (weak)','Hindi','Regional language only','Multilingual']},
    {type:'select',id:'stEnv',label:'Study Environment',options:['Own room at home','Shared room at home','Hostel/PG','Library','Commuting/Transit','Shifts between locations']},
    {type:'select',id:'stTimePerDay',label:'Available Study Time Per Day',options:['Less than 1 hour','1-2 hours','2-4 hours','4-6 hours','6-8 hours','More than 8 hours']},
  ]},
  {name:'Cognitive Profile',icon:'üß†',short:'Cognition',fields:[
    {type:'rating',id:'stAttention',label:'Attention Span Duration (1=very short, 10=very long)'},
    {type:'select',id:'stFocusType',label:'Focus Type',options:['Deep focused (long uninterrupted blocks)','Scattered (jumps between tasks)','Burst (intense then crashes)','Variable (depends on topic)']},
    {type:'select',id:'stWorkingMem',label:'Working Memory Capacity',options:['Very high (can hold 7+ items)','High (5-7 items)','Average (3-5 items)','Low (1-3 items)','Very low (need to write everything)']},
    {type:'select',id:'stProcSpeed',label:'Processing Speed',options:['Very fast (quick intuitive grasp)','Fast','Average','Slow but thorough','Very slow but deep']},
    {type:'rating',id:'stAbstract',label:'Abstract Reasoning Comfort (1=concrete only, 10=love abstractions)'},
    {type:'select',id:'stThinkMode',label:'Thinking Preference',options:['Strongly verbal (words/language)','Mostly verbal','Mixed','Mostly visual (diagrams/images)','Strongly visual']},
    {type:'rating',id:'stMultitask',label:'Multitasking Ability (1=serial only, 10=parallel master)'},
    {type:'select',id:'stFatigue',label:'Mental Fatigue Threshold',options:['30 minutes or less','30-60 minutes','1-2 hours','2-4 hours','4+ hours (iron endurance)']},
  ]},
  {name:'Learning Style & Input Channels',icon:'üìñ',short:'Learning Style',fields:[
    {type:'multi',id:'stLearningModes',label:'Preferred Learning Modes (select all)',options:['Reading textbooks','Listening to lectures','Visual diagrams/mind maps','Video explanations','Hands-on practice','Teaching others','Discussion/debate','Writing notes']},
    {type:'select',id:'stNoteStyle',label:'Note-Taking Style',options:['Detailed linear notes','Bullet points only','Mind maps/diagrams','Almost no notes (memory-based)','Digital notes','Voice recordings']},
    {type:'select',id:'stConceptVsRote',label:'Learning Preference',options:['Deep conceptual (why/how)','Rote memorization (what)','Mixed approach','Context-dependent']},
    {type:'select',id:'stExampleVsTheory',label:'Entry Point Preference',options:['Examples first, then theory','Theory first, then examples','Interleaved','Story/narrative-based']},
    {type:'select',id:'stSoloVsGroup',label:'Social Learning',options:['Strongly prefer solo','Mostly solo','Mix of both','Mostly group','Strongly prefer group']},
  ]},
  {name:'Motivation & Drive',icon:'üî•',short:'Motivation',fields:[
    {type:'rating',id:'stIntrinsic',label:'Intrinsic Interest in Main Subject (1=hate it, 10=passion)'},
    {type:'select',id:'stCareerClarity',label:'Career Clarity',options:['Very clear (know exactly what I want)','Somewhat clear','Vague idea','No idea at all','Exploring multiple paths']},
    {type:'rating',id:'stAmbition',label:'Long-Term Ambition Level (1=just pass, 10=change the world)'},
    {type:'rating',id:'stCompetitive',label:'Competitive Drive (1=not at all, 10=extremely competitive)'},
    {type:'rating',id:'stCuriosity',label:'General Curiosity Level (1=low, 10=insatiably curious)'},
    {type:'select',id:'stDiscipline',label:'Discipline Consistency',options:['Highly consistent (rarely miss targets)','Usually consistent','Moderate (inconsistent weeks)','Poor (big ups and downs)','Very poor (rarely follow through)']},
    {type:'multi',id:'stProcrastTriggers',label:'Procrastination Triggers (select all)',options:['Difficult subject','Boring subject','No clear deadline','Social media','Fatigue','Anxiety/fear of failure','Overwhelm','No study plan']},
  ]},
  {name:'Study Habits & Systems',icon:'‚è∞',short:'Study Systems',fields:[
    {type:'select',id:'stDailyHours',label:'Actual Daily Study Hours (not planned, actual)',options:['Less than 1','1-2','2-3','3-4','4-5','5-6','6-8','8+']},
    {type:'select',id:'stScheduleConsistency',label:'Schedule Consistency',options:['Very consistent (same time daily)','Mostly consistent','Somewhat variable','Very variable','No fixed schedule']},
    {type:'select',id:'stSessionLen',label:'Typical Study Session Length',options:['Less than 20 min','20-40 min','40-60 min','1-2 hours','2+ hours']},
    {type:'select',id:'stBreaks',label:'Break Structure',options:['Strict Pomodoro (25+5)','Natural breaks (as needed)','Rarely take breaks','Too many breaks','No system']},
    {type:'select',id:'stRevision',label:'Revision Frequency',options:['Daily','Every 2-3 days','Weekly','Before exams only','Almost never']},
    {type:'multi',id:'stTechniques',label:'Study Techniques Used',options:['Spaced repetition (Anki etc)','Active recall/self-quizzing','Feynman technique','Interleaving subjects','Practice tests','Past papers','Concept mapping','Summarization']},
  ]},
  {name:'Attention & Distraction Profile',icon:'üì±',short:'Distraction',fields:[
    {type:'select',id:'stPhoneDistr',label:'Phone Distraction During Study',options:['Never (phone off/away)','Rarely','Sometimes (every 30min)','Often (every 10-15min)','Constant (every few minutes)']},
    {type:'select',id:'stSocialMedia',label:'Daily Social Media Time',options:['Less than 30 min','30 min - 1 hour','1-2 hours','2-4 hours','4+ hours']},
    {type:'select',id:'stNoiseSensitivity',label:'Noise Sensitivity',options:['Need complete silence','Prefer quiet','White noise or music OK','Noisy environments OK','Noise helps me focus']},
    {type:'select',id:'stEnvDistr',label:'Environmental Distraction',options:['Very low (controlled space)','Low','Moderate','High (family/noise/etc)','Very high']},
    {type:'rating',id:'stInternalDistr',label:'Internal Distraction (mind-wandering, 1=rarely, 10=constantly)'},
    {type:'select',id:'stDeepWork',label:'Maximum Deep Work Duration',options:['Under 15 min','15-30 min','30-60 min','1-2 hours','2-4 hours','4+ hours']},
  ]},
  {name:'Memory Performance',icon:'üíæ',short:'Memory',fields:[
    {type:'rating',id:'stSTMem',label:'Short-Term Retention (1=forget in minutes, 10=perfect recall)'},
    {type:'rating',id:'stLTMem',label:'Long-Term Retention (1=forget after weeks, 10=never forget)'},
    {type:'select',id:'stRecallType',label:'Memory Strength',options:['Recall (retrieve without cues)','Recognition (identify when shown)','Both strong','Both weak']},
    {type:'select',id:'stForgetting',label:'Forgetting Speed',options:['Very fast (within hours)','Fast (1-2 days)','Average (few days to week)','Slow (weeks)','Very slow (months)']},
    {type:'multi',id:'stMemMethods',label:'Memorization Methods Used',options:['Repetition','Mnemonics','Story method','Method of loci','Visualization','Association','Rhymes/songs','Chunking']},
  ]},
  {name:'Subject-Specific Strengths',icon:'üìö',short:'Subjects',fields:[
    {type:'multi',id:'stStrongSubjects',label:'Strong Subjects (you excel here)',options:['Mathematics','Physics','Chemistry','Biology','History','Geography','Economics','Computer Science','Literature/Language','Social Studies','Psychology','Statistics']},
    {type:'multi',id:'stWeakSubjects',label:'Weak/Difficult Subjects',options:['Mathematics','Physics','Chemistry','Biology','History','Geography','Economics','Computer Science','Literature/Language','Social Studies','Psychology','Statistics']},
    {type:'select',id:'stProblemSolving',label:'Problem-Solving Ability',options:['Excellent (love novel problems)','Good (most problems solvable)','Average (standard problems OK)','Weak (need worked examples)','Very weak (struggle with any application)']},
    {type:'select',id:'stExamVsPractice',label:'Exam vs Practice Performance',options:['Better in exams than practice','Similar','Worse in exams (anxiety)','Much worse (freeze up)']},
  ]},
  {name:'Weakness & Difficulty Mapping',icon:'üéØ',short:'Weaknesses',fields:[
    {type:'multi',id:'stWeaknessType',label:'Types of Difficulties',options:['Conceptual gaps (don\'t understand WHY)','Skill gaps (can\'t apply knowledge)','Foundational gaps (missing basics)','Language/terminology barriers','Math/logic difficulty','Reading comprehension','Speed issues','Memorization difficulty']},
    {type:'textarea',id:'stConceptGaps',label:'Biggest Conceptual Gaps (describe briefly)'},
    {type:'select',id:'stMathDifficulty',label:'Math/Logic Difficulty Level',options:['No difficulty','Mild difficulty','Moderate difficulty','Significant difficulty','Severe difficulty']},
  ]},
  {name:'Exam & Performance Psychology',icon:'üèÜ',short:'Exam Psychology',fields:[
    {type:'rating',id:'stTestAnxiety',label:'Test Anxiety Level (1=none, 10=severe)'},
    {type:'select',id:'stTimePressure',label:'Time Pressure Handling',options:['Excellent (always finish early)','Good','Average','Poor (often run out of time)','Very poor (panic under time pressure)']},
    {type:'rating',id:'stSillyMistakes',label:'Silly Mistakes Frequency (1=rare, 10=very frequent)'},
    {type:'rating',id:'stOverthinking',label:'Overthinking in Exams (1=never, 10=always)'},
    {type:'select',id:'stBlankOuts',label:'Blank-Out Episodes',options:['Never','Rarely','Sometimes','Often','Almost always in high-stakes situations']},
    {type:'rating',id:'stExamConfidence',label:'Overall Exam Confidence (1=very low, 10=very high)'},
  ]},
  {name:'Metacognition (Learning Awareness)',icon:'üîç',short:'Metacognition',fields:[
    {type:'rating',id:'stSelfAwareness',label:'Awareness of Your Own Strengths (1=low, 10=high)'},
    {type:'rating',id:'stWeaknessAwareness',label:'Awareness of Your Own Weaknesses (1=low, 10=high)'},
    {type:'select',id:'stStrategyAdjust',label:'Strategy Adjustment Ability',options:['Very adaptive (constantly optimizing)','Adaptive','Somewhat adaptive','Not very adaptive','Rigid (stick to one method)']},
    {type:'select',id:'stErrorAnalysis',label:'Error Analysis Habit',options:['Always analyze mistakes','Usually analyze','Sometimes','Rarely','Never ‚Äî just move on']},
    {type:'select',id:'stReflection',label:'Post-Test Reflection',options:['Detailed analysis of every error','Brief review','Only check marks','Never review']},
  ]},
  {name:'Cognitive Energy & Health',icon:'‚ö°',short:'Health & Energy',fields:[
    {type:'select',id:'stSleepQuality',label:'Sleep Quality During Study Periods',options:['Excellent (7-9h, restful)','Good (6-7h)','Fair (5-6h or disrupted)','Poor (less than 5h)','Very poor (irregular/disturbed)']},
    {type:'select',id:'stStudyEnergy',label:'Energy Level During Typical Study Session',options:['High throughout','Good for first half','Crashes after 1 hour','Always low','Highly variable']},
    {type:'rating',id:'stBrainFog',label:'Brain Fog Frequency (1=rarely, 10=daily)'},
    {type:'select',id:'stNutrition',label:'Nutrition During Study',options:['Excellent (balanced, regular)','Good','Average','Poor (junk/irregular)','Very poor']},
    {type:'select',id:'stExercise',label:'Exercise Frequency',options:['Daily','4-6 days/week','2-3 days/week','Rarely (1x/week)','Sedentary (none)']},
  ]},
  {name:'Learning Environment & Resources',icon:'üåç',short:'Environment',fields:[
    {type:'select',id:'stSpaceQuality',label:'Study Space Quality',options:['Dedicated quiet room','Good but shared','Acceptable but noisy','Poor (distracting)','No fixed study space']},
    {type:'select',id:'stInternet',label:'Internet Access',options:['High-speed, unlimited','Good, mostly reliable','Moderate (occasional issues)','Limited (data constraints)','Poor/unavailable']},
    {type:'select',id:'stResources',label:'Books & Study Resources',options:['Excellent (all books + digital)','Good','Average','Limited','Very limited']},
    {type:'select',id:'stCoaching',label:'Coaching/Tutoring Available',options:['Premium coaching (top teachers)','Good coaching','Basic coaching/tuition','Online only','Self-study only']},
    {type:'select',id:'stPeerGroup',label:'Peer Group Quality',options:['High achievers (push you up)','Mixed group','Low energy peers','Mostly non-academic friends','Isolated (no study peers)']},
  ]},
  {name:'Skill Stack Beyond Academics',icon:'üõ†Ô∏è',short:'Skills',fields:[
    {type:'rating',id:'stWriting',label:'Writing Ability (1=weak, 10=excellent)'},
    {type:'rating',id:'stCommunication',label:'Communication/Presentation (1=weak, 10=excellent)'},
    {type:'rating',id:'stCriticalThinking',label:'Critical Thinking (1=weak, 10=excellent)'},
    {type:'rating',id:'stCreativity',label:'Creative Problem-Solving (1=weak, 10=excellent)'},
    {type:'multi',id:'stDigitalSkills',label:'Digital Skills',options:['Basic computer use','Coding (any language)','Data analysis','Graphic design','Video editing','Spreadsheets/Excel','Research skills','AI tool usage']},
  ]},
  {name:'Study Strategy & Techniques',icon:'‚öôÔ∏è',short:'Techniques',fields:[
    {type:'multi',id:'stCurrentTech',label:'Techniques Currently Using',options:['Flashcards (physical)','Spaced repetition app (Anki)','Mind maps','Feynman technique','Interleaving','Retrieval practice','Pomodoro','Deep work blocks','Cornell notes','Summarization after reading']},
    {type:'multi',id:'stTriedTech',label:'Techniques You\'ve Tried But Struggled With',options:['Spaced repetition','Active recall','Feynman technique','Mind maps','Pomodoro','Deep focus blocks']},
    {type:'select',id:'stStudyPlan',label:'Do You Use a Written Study Plan?',options:['Yes, detailed daily plan','Yes, weekly plan','Rough mental plan only','No plan at all']},
  ]},
  {name:'Learning Goals & Direction',icon:'üéØ',short:'Goals',fields:[
    {type:'text',id:'stTargetExam',label:'Target Exam(s) (e.g., JEE, NEET, UPSC, SAT, IELTS)'},
    {type:'text',id:'stTargetCareer',label:'Dream Career or Field'},
    {type:'text',id:'stTargetInstitution',label:'Target Institution(s)'},
    {type:'select',id:'stTimeline',label:'Timeline to Goal',options:['Less than 6 months','6-12 months','1-2 years','2-5 years','5+ years','Ongoing/lifelong']},
    {type:'select',id:'stRankGoal',label:'Score/Rank Goal',options:['Top 0.1% (highest possible)','Top 1%','Top 10%','Top 25%','Pass/qualify','Specific score target']},
  ]},
  {name:'Constraints & Barriers',icon:'üöß',short:'Barriers',fields:[
    {type:'multi',id:'stBarriers',label:'Current Barriers (select all that apply)',options:['Limited time (family/work responsibilities)','Financial constraints','Poor internet/resources','Language barrier (not in first language)','Mental health challenges','Physical health issues','No mentor/guidance','Poor study environment','Lack of motivation','Burnout/exhaustion','Unclear career direction','Social pressure/distractions']},
    {type:'select',id:'stFinancial',label:'Financial Constraint Level',options:['No constraint','Minor','Moderate (some limitations)','Significant','Severe (cannot afford resources)']},
    {type:'select',id:'stMentalHealth',label:'Current Mental/Emotional State',options:['Excellent (motivated, stable)','Good','Fair (stressed but managing)','Poor (struggling significantly)','Crisis (need support)']},
  ]},
  {name:'Growth & Optimization Potential',icon:'üöÄ',short:'Growth Potential',fields:[
    {type:'rating',id:'stOpenness',label:'Openness to Changing Study Methods (1=resistant, 10=very open)'},
    {type:'rating',id:'stEffortTolerance',label:'Effort Tolerance (1=avoid hard work, 10=love hard work)'},
    {type:'rating',id:'stConsistency',label:'Long-Term Consistency Capacity (1=can\'t sustain, 10=iron will)'},
    {type:'select',id:'stCoachingReceptivity',label:'Receptivity to Coaching/Feedback',options:['Very receptive (implement immediately)','Receptive','Somewhat receptive','Resistant to feedback','Very resistant']},
    {type:'textarea',id:'stAnythingElse',label:'Anything else about your learning situation? (optional)'},
  ]},
];
let studyCurrent=0;
function buildStudySections(){
  const jumpBar=document.getElementById('studyJumpBar');
  const container=document.getElementById('studySectionsContainer');
  if(!jumpBar||!container)return;
  jumpBar.innerHTML=STUDY_SECTIONS.map((s,i)=>`<button class="study-jump${i===0?' active':''}" onclick="jumpStudy(${i})" title="${s.name}">${s.icon} ${i+1}</button>`).join('');
  container.innerHTML=STUDY_SECTIONS.map((s,i)=>`<div class="study-section card${i===0?' active':''}" id="studySec_${i}"><div class="card-title"><span class="emoji">${s.icon}</span> ${s.name}</div>${buildStudyFields(s.fields)}</div>`).join('');
}
function buildStudyFields(fields){
  return fields.map(f=>{
    if(f.type==='rating')return`<div class="form-group"><label class="form-label">${f.label}</label><div class="study-rating" id="${f.id}_rating">${[1,2,3,4,5,6,7,8,9,10].map(n=>`<button class="study-rating-btn" onclick="setStudyRating('${f.id}',${n},this)">${n}</button>`).join('')}</div><input type="hidden" id="${f.id}" value="5"></div>`;
    if(f.type==='multi')return`<div class="form-group"><label class="form-label">${f.label}</label><div style="display:flex;flex-wrap:wrap;gap:6px">${f.options.map(o=>`<label style="display:flex;align-items:center;gap:4px;font-size:12px;cursor:pointer;background:var(--bg);border:1px solid var(--border);padding:4px 8px;border-radius:8px;transition:all .2s"><input type="checkbox" name="${f.id}" value="${o}" onchange="this.parentElement.style.borderColor=this.checked?'var(--primary)':'var(--border)';this.parentElement.style.background=this.checked?'rgba(124,58,237,.08)':'var(--bg)'"> ${o}</label>`).join('')}</div></div>`;
    if(f.type==='textarea')return`<div class="form-group"><label class="form-label">${f.label}</label><textarea class="form-textarea" id="${f.id}" style="min-height:70px"></textarea></div>`;
    if(f.type==='select')return`<div class="form-group"><label class="form-label">${f.label}</label><select class="form-select" id="${f.id}">${f.options.map(o=>`<option>${o}</option>`).join('')}</select></div>`;
    return`<div class="form-group"><label class="form-label">${f.label}</label><input type="text" class="form-input" id="${f.id}" placeholder="Type here..."></div>`;
  }).join('');
}
function setStudyRating(id,val,btn){
  document.getElementById(id).value=val;
  const btns=document.querySelectorAll(`#${id}_rating .study-rating-btn`);
  btns.forEach((b,i)=>b.classList.toggle('active',i<val));
}
function jumpStudy(i){
  document.querySelectorAll('.study-section').forEach((s,j)=>s.classList.toggle('active',j===i));
  document.querySelectorAll('.study-jump').forEach((b,j)=>b.classList.toggle('active',j===i));
  studyCurrent=i;updateStudyNav();window.scrollTo(0,0);
}
function updateStudyNav(){
  const tot=STUDY_SECTIONS.length;
  document.getElementById('studySectionNum').textContent=studyCurrent+1;
  document.getElementById('studySectionName').textContent=STUDY_SECTIONS[studyCurrent].name;
  document.getElementById('studyProgressBar').style.width=((studyCurrent+1)/tot*100).toFixed(0)+'%';
  document.getElementById('studyPrevBtn').style.display=studyCurrent>0?'':'none';
  document.getElementById('studyNextBtn').textContent=studyCurrent===tot-1?'ü§ñ Generate My Study Blueprint ‚Üí':'Next ‚Üí';
}
function studyNext(){if(studyCurrent<STUDY_SECTIONS.length-1){jumpStudy(studyCurrent+1);}else{generateStudyAI();}}
function studyPrev(){if(studyCurrent>0)jumpStudy(studyCurrent-1);}
async function generateStudyAI(){
  const el=document.getElementById('studyResultContainer');
  el.innerHTML=`<div class="card study-result"><div style="text-align:center;padding:20px"><div style="font-size:40px">ü§ñ</div><div style="font-size:16px;font-weight:700;margin-top:10px">AI is analyzing your complete cognitive profile...</div><div style="font-size:13px;color:var(--text3);margin-top:6px">Building personalized 18-dimension blueprint</div></div></div>`;
  el.scrollIntoView({behavior:'smooth'});
  const profile=collectStudyProfile();
  const prompt=buildStudyPrompt(profile);
  try{
    const resp=await fetch('https://api.anthropic.com/v1/messages',{method:'POST',headers:{'Content-Type':'application/json','anthropic-version':'2023-06-01','anthropic-dangerous-direct-browser-access':'true'},body:JSON.stringify({model:'claude-sonnet-4-20250514',max_tokens:1500,messages:[{role:'user',content:prompt}]})});
    const data=await resp.json();
    const text=data.content?.[0]?.text||'';
    displayStudyResult(text,profile);
  }catch(e){displayStudyResult(buildLocalStudyResult(profile),profile);}
}
function collectStudyProfile(){
  const get=id=>{try{const el=document.getElementById(id);return el?el.value:'';}catch(e){return '';}};
  const getChecked=name=>Array.from(document.querySelectorAll(`input[name="${name}"]:checked`)).map(i=>i.value);
  return{
    age:get('stAge'),eduLevel:get('stEduLevel'),field:get('stField'),institution:get('stInstitution'),
    gpa:get('stGPA'),env:get('stEnv'),timePerDay:get('stTimePerDay'),
    attention:get('stAttention'),focusType:get('stFocusType'),workingMem:get('stWorkingMem'),
    procSpeed:get('stProcSpeed'),abstract:get('stAbstract'),thinkMode:get('stThinkMode'),fatigue:get('stFatigue'),
    learningModes:getChecked('stLearningModes'),noteStyle:get('stNoteStyle'),conceptVsRote:get('stConceptVsRote'),
    exampleVsTheory:get('stExampleVsTheory'),soloVsGroup:get('stSoloVsGroup'),
    intrinsic:get('stIntrinsic'),careerClarity:get('stCareerClarity'),ambition:get('stAmbition'),
    competitive:get('stCompetitive'),curiosity:get('stCuriosity'),discipline:get('stDiscipline'),
    procrastTriggers:getChecked('stProcrastTriggers'),
    dailyHours:get('stDailyHours'),sessionLen:get('stSessionLen'),breaks:get('stBreaks'),
    techniques:getChecked('stTechniques'),
    phoneDistr:get('stPhoneDistr'),socialMedia:get('stSocialMedia'),deepWork:get('stDeepWork'),
    stMemMethods:getChecked('stMemMethods'),
    strongSubjects:getChecked('stStrongSubjects'),weakSubjects:getChecked('stWeakSubjects'),
    problemSolving:get('stProblemSolving'),examVsPractice:get('stExamVsPractice'),
    weaknessType:getChecked('stWeaknessType'),mathDifficulty:get('stMathDifficulty'),
    testAnxiety:get('stTestAnxiety'),timePressure:get('stTimePressure'),examConfidence:get('stExamConfidence'),
    selfAwareness:get('stSelfAwareness'),strategyAdjust:get('stStrategyAdjust'),errorAnalysis:get('stErrorAnalysis'),
    sleepQuality:get('stSleepQuality'),studyEnergy:get('stStudyEnergy'),brainFog:get('stBrainFog'),exercise:get('stExercise'),
    spaceQuality:get('stSpaceQuality'),internet:get('stInternet'),coaching:get('stCoaching'),peerGroup:get('stPeerGroup'),
    writing:get('stWriting'),criticalThinking:get('stCriticalThinking'),creativity:get('stCreativity'),
    currentTech:getChecked('stCurrentTech'),
    targetExam:get('stTargetExam'),targetCareer:get('stTargetCareer'),targetInstitution:get('stTargetInstitution'),
    timeline:get('stTimeline'),rankGoal:get('stRankGoal'),
    barriers:getChecked('stBarriers'),mentalHealth:get('stMentalHealth'),
    openness:get('stOpenness'),effortTolerance:get('stEffortTolerance'),consistency:get('stConsistency'),
    anythingElse:get('stAnythingElse'),
  };
}
function buildStudyPrompt(p){
  return`You are a world-class cognitive scientist and educational strategist. Analyze this student's complete 18-dimension profile and generate a highly personalized study blueprint.

STUDENT PROFILE:
- Age: ${p.age}, Level: ${p.eduLevel}, Field: ${p.field||'not specified'}
- Academic performance: ${p.gpa}, Time available: ${p.timePerDay}/day
- Focus type: ${p.focusType}, Attention span: ${p.attention}/10, Deep work capacity: ${p.deepWork}
- Working memory: ${p.workingMem}, Processing speed: ${p.procSpeed}
- Learning modes: ${p.learningModes.join(', ')||'not specified'}
- Intrinsic motivation: ${p.intrinsic}/10, Ambition: ${p.ambition}/10, Discipline: ${p.discipline}
- Daily study hours: ${p.dailyHours}, Session length: ${p.sessionLen}
- Phone distraction: ${p.phoneDistr}, Social media: ${p.socialMedia}
- Sleep quality: ${p.sleepQuality}, Exercise: ${p.exercise}, Brain fog: ${p.brainFog}/10
- Strong subjects: ${p.strongSubjects.join(', ')||'none specified'}
- Weak subjects: ${p.weakSubjects.join(', ')||'none specified'}
- Weakness types: ${p.weaknessType.join(', ')||'none'}
- Test anxiety: ${p.testAnxiety}/10, Exam confidence: ${p.examConfidence}/10
- Techniques used: ${p.currentTech.join(', ')||'basic'}
- Target exam: ${p.targetExam||'not specified'}, Career: ${p.targetCareer||'not specified'}
- Timeline: ${p.timeline}, Rank goal: ${p.rankGoal}
- Barriers: ${p.barriers.join(', ')||'none specified'}
- Mental health: ${p.mentalHealth}, Openness to change: ${p.openness}/10
- Peer group: ${p.peerGroup}, Coaching: ${p.coaching}
${p.anythingElse?'Additional context: '+p.anythingElse:''}

Generate a comprehensive, actionable study blueprint with these exact sections:
1. **COGNITIVE PORTRAIT** (2-3 sentences describing this learner's brain profile)
2. **OPTIMAL STUDY ARCHITECTURE** (ideal session structure, timing, duration based on their profile)
3. **TOP 3 PRIORITY TECHNIQUES** (most impactful methods for their specific profile, with why)
4. **WEAK SUBJECT REPAIR PLAN** (concrete steps to address their weakest areas)
5. **DISTRACTION & FOCUS PROTOCOL** (specific strategies for their distraction pattern)
6. **EXAM PSYCHOLOGY FIX** (address anxiety/confidence/blank-outs based on their scores)
7. **DAILY SCHEDULE TEMPLATE** (hour-by-hour optimal structure based on available time)
8. **30-DAY ACCELERATION PLAN** (what to do first, second, third to see fastest improvement)
9. **CAREER & EXAM PATH** (analysis of target and what it realistically requires)
10. **SECRET ADVANTAGE** (one unique leverage point in their profile they should maximize)

Be specific, evidence-based, and direct. No generic advice ‚Äî every recommendation must reference specific elements of their profile.`;
}
function displayStudyResult(text,profile){
  const el=document.getElementById('studyResultContainer');
  // Format the AI response nicely
  const formatted=text.replace(/\*\*(.+?)\*\*/g,'<strong>$1</strong>').replace(/\n\n/g,'</p><p>').replace(/\n/g,'<br>').replace(/(\d+\. \*\*[^*]+\*\*)/g,'<h3>$1</h3>');
  el.innerHTML=`<div class="study-result"><h2>üéì Your Personalized Study Blueprint</h2><div style="font-size:11px;color:var(--text3);margin-bottom:16px;padding:8px;background:rgba(0,0,0,.05);border-radius:8px">Based on ${Object.keys(profile).length} data points across 18 cognitive dimensions</div><div class="study-detail"><p>${formatted}</p></div><div style="margin-top:16px;padding-top:16px;border-top:1px solid rgba(124,58,237,.2)"><button class="btn btn-secondary btn-sm" onclick="jumpStudy(0)">üîÑ Redo Assessment</button></div></div>`;
  el.scrollIntoView({behavior:'smooth'});
}
function buildLocalStudyResult(p){
  const hrs=parseInt(p.dailyHours)||3;const focus=parseInt(p.attention)||5;const motivation=parseInt(p.intrinsic)||5;
  const techniques=p.currentTech.length?'You are using: '+p.currentTech.join(', '):' You are not yet using evidence-based techniques';
  const topWeakness=p.weakSubjects.length?p.weakSubjects[0]:'your weakest subject';
  return`**COGNITIVE PORTRAIT:** ${focus>6?'You have strong attentional capacity':'Your attention is fragmented but trainable'} with ${motivation>6?'high intrinsic motivation ‚Äî a genuine asset':'motivation that needs external scaffolding temporarily'}. Your ${p.focusType||'focus style'} combined with ${p.discipline} discipline creates a specific optimization path.

**OPTIMAL STUDY ARCHITECTURE:** Given ${hrs} hours/day and ${p.sessionLen||'your session length'}, structure sessions as: 25-min deep blocks with 5-min breaks (Pomodoro). Start each session with your hardest subject when cognitive energy peaks. ${p.sleepQuality?.includes('Poor')||p.sleepQuality?.includes('Very poor')?'‚ö†Ô∏è PRIORITY: Fix sleep first ‚Äî no technique will work on an under-rested brain.':'Sleep quality looks manageable ‚Äî protect it.'}

**TOP 3 TECHNIQUES FOR YOUR PROFILE:** 1. **Active Recall** ‚Äî quiz yourself immediately after reading instead of re-reading (improves retention 50-80%). 2. **Spaced Repetition** ‚Äî use Anki to review ${topWeakness} flashcards daily. 3. **Feynman Technique** ‚Äî explain every concept in simple words; gaps reveal themselves immediately.

**DISTRACTION PROTOCOL:** ${p.phoneDistr?.includes('Constant')||p.phoneDistr?.includes('Often')?'CRITICAL: Phone is your #1 enemy. Use app blockers (Freedom, Cold Turkey). Phone goes in another room during study blocks.':'Your phone distraction is manageable. Create phone-free 90-min blocks.'} ${p.socialMedia?.includes('4+')?' Social media is consuming 4+ hours/day ‚Äî this is the single biggest ROI fix available to you.':''}

**30-DAY PLAN:** Week 1: Fix environment + install spaced repetition system. Week 2: Begin active recall on all new content. Week 3: Add past paper practice. Week 4: Full mock test under exam conditions. Every week: track what works, drop what doesn't.

**CAREER PATH:** ${p.targetCareer?'Target career "'+p.targetCareer+'" requires: strong analytical foundation, sustained learning capacity, and real-world application experience. Focus on building depth in your strongest subjects while closing gaps in weak areas.':'Define your career target clearly ‚Äî ambiguity is the enemy of focused preparation.'}`;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
//  INIT NEW FEATURES
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function initNewFeatures(){
  buildWorldPanel();
  buildThemeGrid();
  buildLegalItems();
  buildFeatureGuide();
  buildScienceDisplay();
  updateTelemetry();
  buildStudySections();
  buildClickableNews();
  // Track all clicks for passive telemetry
  document.addEventListener('click',trackInteraction,{passive:true});
  // Sync sys dark toggle
  const isDark=document.documentElement.getAttribute('data-theme')==='dark';
  const sysToggle=document.getElementById('sys-darkToggle');
  if(sysToggle)sysToggle.classList.toggle('on',isDark);
  // Sync sys lang sel
  try{document.getElementById('sysLangSel').value=curLang||'en';}catch(e){}
  // Init study nav
  try{updateStudyNav();}catch(e){}
  // Apply language to existing UI immediately
  if(curLang&&curLang!=='en')applyFullTranslation(curLang);
  // Add touch drag support to topbar actions
  enableTopbarSwipe();
}
function enableTopbarSwipe(){
  const el=document.getElementById('topbarActions');if(!el)return;
  // Add visual hint for swipeable bar
  let startX=0,startScroll=0,isDragging=false;
  el.addEventListener('mousedown',e=>{isDragging=true;startX=e.clientX;startScroll=el.scrollLeft;el.style.cursor='grabbing';});
  document.addEventListener('mousemove',e=>{if(!isDragging)return;el.scrollLeft=startScroll-(e.clientX-startX);});
  document.addEventListener('mouseup',()=>{isDragging=false;if(el)el.style.cursor='';});
  // Touch is handled natively by -webkit-overflow-scrolling:touch
  // Add subtle scroll indicator
  el.addEventListener('scroll',()=>{
    const atEnd=el.scrollLeft+el.clientWidth>=el.scrollWidth-10;
    el.style.WebkitMaskImage=atEnd?'none':'linear-gradient(to right,black 80%,transparent 100%)';
    el.style.maskImage=atEnd?'none':'linear-gradient(to right,black 80%,transparent 100%)';
  },{passive:true});
  // Initial mask to hint scrollability
  setTimeout(()=>{
    if(el.scrollWidth>el.clientWidth){
      el.style.WebkitMaskImage='linear-gradient(to right,black 80%,transparent 100%)';
      el.style.maskImage='linear-gradient(to right,black 80%,transparent 100%)';
    }
  },300);
}

// ‚îÄ‚îÄ‚îÄ ONBOARDING ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
let oStep=0;
function showOnboarding(){document.getElementById('onboardOverlay').style.display='flex';oStep=0;gotoOStep(0);}
function closeOnboarding(){document.getElementById('onboardOverlay').style.display='none';}
function gotoOStep(s){
  document.querySelectorAll('.onboard-step').forEach((el,i)=>el.classList.toggle('active',i===s));
  document.getElementById('onboardDots').innerHTML=Array.from({length:6},(_,i)=>`<div class="odot${i===s?' active':''}"></div>`).join('');
  document.getElementById('oBtnPrev').style.display=s>0?'':'none';
  document.getElementById('oBtnNext').textContent=s===5?'üöÄ Let\'s Go!':'Next ‚Üí';
}
function onboardNav(dir){
  if(oStep>=5&&dir>0){closeOnboarding();return;}
  oStep=Math.max(0,Math.min(5,oStep+dir));gotoOStep(oStep);
}

// ‚îÄ‚îÄ‚îÄ INIT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function init(){
  const th=localStorage.getItem('cos_theme')||'light';
  document.documentElement.setAttribute('data-theme',th);
  document.getElementById('themeBtn').textContent=th==='dark'?'‚òÄÔ∏è':'üåô';
  const today=new Date().toISOString().split('T')[0];
  if(document.getElementById('logDate'))document.getElementById('logDate').value=today;
  if(document.getElementById('dreamDate'))document.getElementById('dreamDate').value=today;
  loadSettings();
  buildNav();buildSliders();buildBWGrid();buildAIModelsBar();buildSuggestedQs();
  buildHealthSections();buildGamesGrid();buildTechniques();buildRCGrid();
  renderRecentLogs();renderDreamJournal();renderVoiceMemos();renderMediaGrid();renderCalendar();renderAlarms();renderReminders();
  const today2=new Date().toDateString();
  if(localStorage.getItem('cos_rc_day')===today2){
    const cnt=parseInt(localStorage.getItem('cos_rc_count')||0);
    if(document.getElementById('rcCount'))document.getElementById('rcCount').textContent=cnt;
    if(document.getElementById('rcProgress'))document.getElementById('rcProgress').style.width=Math.min(100,cnt/15*100)+'%';
  }
  setInterval(checkAlarms,30000);
  const sl=localStorage.getItem('cos_lang')||'en';curLang=sl;
  try{document.getElementById('langSel').value=sl;}catch(e){}try{document.getElementById('settingLang').value=sl;}catch(e){}
  setTimeout(()=>{const logs=getLogs();addChatMsg('ai',logs.length?`Hello! üëã I see you have ${logs.length} consciousness entries. ${Math.random()>.5?'How are you feeling today?':'What\'s on your mind?'}`:"Welcome to Consciousness OS v6! üß† I'm your AI Digital Twin. Fill your first Daily Log and I'll start learning your patterns. What's your name?",'twin');},600);
  loadDailyTip();
  if(!localStorage.getItem('cos_visited')){localStorage.setItem('cos_visited','1');setTimeout(()=>showOnboarding(),1500);}
  initNewFeatures();
}
document.addEventListener('DOMContentLoaded',init);
</script>
</body>
</html>