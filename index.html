<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Consciousness OS Ultimate - Complete System</title>
<meta name="theme-color" content="#0f172a">
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:Inter,-apple-system,sans-serif;background:radial-gradient(circle at top,#1e1b4b,#020617);color:#e5e7eb;overflow-x:hidden}
.container{max-width:1200px;margin:0 auto;padding:20px}

/* Header */
.header{text-align:center;padding:30px 0;margin-bottom:30px}
.header h1{font-size:32px;font-weight:900;background:linear-gradient(135deg,#8b5cf6,#ec4899);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:10px}
.header p{color:#9ca3af;font-size:14px}

/* Cards */
.card{background:#020617;border:1px solid #1f2937;border-radius:16px;padding:20px;margin-bottom:20px;box-shadow:0 4px 12px rgba(0,0,0,0.3)}
.card h3{font-size:18px;font-weight:700;margin-bottom:16px;color:#8b5cf6}
.card-subtitle{font-size:13px;color:#9ca3af;margin-bottom:12px;line-height:1.6}

/* Slider with detailed anchors */
.slider-group{margin-bottom:24px}
.slider-label{font-size:14px;font-weight:700;color:#e5e7eb;display:block;margin-bottom:8px}
.slider-value{font-size:40px;font-weight:900;color:#8b5cf6;text-align:center;margin:12px 0}
input[type="range"]{width:100%;height:12px;border-radius:6px;background:linear-gradient(90deg,#ef4444,#f59e0b 25%,#eab308 40%,#84cc16 60%,#22c55e 80%,#8b5cf6);outline:none;-webkit-appearance:none;border:none;cursor:pointer}
input[type="range"]::-webkit-slider-thumb{-webkit-appearance:none;width:28px;height:28px;border-radius:50%;background:#fff;cursor:pointer;box-shadow:0 3px 12px rgba(0,0,0,0.4);border:4px solid #8b5cf6}
input[type="range"]::-moz-range-thumb{width:28px;height:28px;border-radius:50%;background:#fff;cursor:pointer;box-shadow:0 3px 12px rgba(0,0,0,0.4);border:4px solid #8b5cf6}
.slider-anchors{font-size:11px;color:#6b7280;margin-top:8px;padding:12px;background:#0a0a1f;border-radius:8px;line-height:1.8}
.slider-anchors div{margin:4px 0}

/* Input fields with smart placeholders */
input[type="text"],input[type="date"],input[type="time"],textarea,select{width:100%;padding:12px;margin:8px 0;border-radius:10px;border:1px solid #374151;background:#0a0a1f;color:#e5e7eb;font-size:14px;font-family:inherit;transition:all 0.2s}
input:focus,textarea:focus,select:focus{outline:none;border-color:#8b5cf6;box-shadow:0 0 0 3px rgba(139,92,246,0.1)}
textarea{min-height:100px;resize:vertical}
.input-label{display:block;font-size:13px;font-weight:600;color:#9ca3af;margin-bottom:6px}
.input-hint{font-size:11px;color:#6b7280;margin-top:4px;font-style:italic}

/* Buttons */
button{background:linear-gradient(135deg,#8b5cf6,#7c3aed);border:none;padding:14px 24px;border-radius:12px;color:#fff;font-weight:700;font-size:14px;cursor:pointer;transition:all 0.2s;box-shadow:0 4px 12px rgba(139,92,246,0.4);width:100%}
button:hover{transform:translateY(-2px);box-shadow:0 6px 16px rgba(139,92,246,0.5)}
button:active{transform:translateY(0)}
button.secondary{background:#1f2937;box-shadow:none}

/* Tabs */
.tabs{display:flex;gap:8px;margin-bottom:20px;overflow-x:auto;padding:10px 0}
.tab{padding:12px 20px;background:#1f2937;border:none;border-radius:10px;color:#9ca3af;cursor:pointer;font-weight:600;font-size:13px;white-space:nowrap;transition:all 0.2s}
.tab.active{background:linear-gradient(135deg,#8b5cf6,#7c3aed);color:#fff;box-shadow:0 4px 12px rgba(139,92,246,0.4)}
.tab-content{display:none}
.tab-content.active{display:block;animation:fadeIn 0.3s}
@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}

/* Score display */
.score-big{font-size:80px;font-weight:900;text-align:center;background:linear-gradient(135deg,#8b5cf6,#ec4899);-webkit-background-clip:text;-webkit-text-fill-color:transparent;line-height:1;margin:20px 0}
.score-label{text-align:center;font-size:18px;font-weight:700;color:#9ca3af;padding:12px;background:rgba(139,92,246,0.1);border-radius:12px;margin-top:12px}

/* Stats grid */
.stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:16px;margin:20px 0}
.stat-box{background:#0a0a1f;padding:20px;border-radius:12px;text-align:center;border:1px solid #374151}
.stat-value{font-size:36px;font-weight:900;color:#8b5cf6}
.stat-label{font-size:11px;color:#9ca3af;margin-top:8px;text-transform:uppercase;letter-spacing:0.5px}

/* Chat */
.chat-container{height:500px;display:flex;flex-direction:column;background:#0a0a1f;border-radius:12px;padding:16px}
.chat-messages{flex:1;overflow-y:auto;margin-bottom:16px}
.chat-msg{padding:12px 16px;border-radius:12px;margin:8px 0;max-width:80%;line-height:1.5}
.chat-msg.user{background:#8b5cf6;color:#fff;margin-left:auto;text-align:right}
.chat-msg.assistant{background:#1f2937;color:#e5e7eb}
.chat-input-group{display:flex;gap:12px}
.chat-input-group input{flex:1;margin:0}
.chat-input-group button{width:auto;padding:12px 24px}

/* Games */
.game-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:16px}
.game-card{background:#0a0a1f;border:1px solid #374151;border-radius:12px;padding:20px;cursor:pointer;transition:all 0.2s}
.game-card:hover{transform:translateY(-4px);border-color:#8b5cf6;box-shadow:0 8px 20px rgba(139,92,246,0.3)}
.game-icon{font-size:48px;text-align:center;margin-bottom:12px}
.game-title{font-size:16px;font-weight:700;text-align:center;margin-bottom:8px}
.game-desc{font-size:12px;color:#9ca3af;text-align:center}

/* Calendar */
.calendar{background:#0a0a1f;border-radius:12px;padding:20px}
.calendar-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}
.calendar-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:8px}
.calendar-day{aspect-ratio:1;display:flex;align-items:center;justify-content:center;background:#1f2937;border-radius:8px;cursor:pointer;font-size:14px;font-weight:600}
.calendar-day:hover{background:#8b5cf6;color:#fff}
.calendar-day.today{background:#8b5cf6;color:#fff}

/* Modal */
.modal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.9);display:none;align-items:center;justify-content:center;z-index:1000;padding:20px}
.modal.show{display:flex}
.modal-content{background:#020617;border:1px solid #1f2937;border-radius:16px;padding:30px;max-width:600px;max-height:80vh;overflow:auto;width:100%}
.modal-close{float:right;font-size:28px;font-weight:700;color:#9ca3af;cursor:pointer;line-height:1}
.modal-close:hover{color:#fff}

/* Toast */
.toast{position:fixed;bottom:30px;left:50%;transform:translateX(-50%);background:#1f2937;color:#fff;padding:16px 28px;border-radius:12px;box-shadow:0 8px 24px rgba(0,0,0,0.5);z-index:1001;display:none;font-weight:600;animation:slideUp 0.3s}
.toast.show{display:block}
@keyframes slideUp{from{transform:translateX(-50%) translateY(100px);opacity:0}to{transform:translateX(-50%) translateY(0);opacity:1}}

/* Settings panel */
.settings-group{margin-bottom:24px}
.settings-item{display:flex;justify-content:space-between;align-items:center;padding:16px;background:#0a0a1f;border-radius:10px;margin-bottom:12px}
.settings-label{font-size:14px;font-weight:600}
.toggle-switch{position:relative;width:50px;height:26px;background:#374151;border-radius:13px;cursor:pointer;transition:0.3s}
.toggle-switch.active{background:#8b5cf6}
.toggle-switch::after{content:'';position:absolute;width:22px;height:22px;background:#fff;border-radius:50%;top:2px;left:2px;transition:0.3s}
.toggle-switch.active::after{left:26px}

/* Responsive */
@media(max-width:768px){
.container{padding:12px}
.header h1{font-size:24px}
.score-big{font-size:60px}
.stats-grid{grid-template-columns:repeat(3,1fr)}
.game-grid{grid-template-columns:1fr}
}
</style>
</head>
<body>

<div class="container">
<!-- Header -->
<div class="header">
<h1>ğŸ§  Consciousness OS Ultimate</h1>
<p>Complete Mind Preservation & Enhancement System v4.5</p>
</div>

<!-- Main Tabs -->
<div class="tabs">
<button class="tab active" onclick="switchTab('log')">ğŸ“ Log</button>
<button class="tab" onclick="switchTab('voice')">ğŸ¤ Voice</button>
<button class="tab" onclick="switchTab('media')">ğŸ“· Media</button>
<button class="tab" onclick="switchTab('chat')">ğŸ’¬ Chat</button>
<button class="tab" onclick="switchTab('analysis')">ğŸ§¬ Analysis</button>
<button class="tab" onclick="switchTab('health')">âš•ï¸ Health</button>
<button class="tab" onclick="switchTab('games')">ğŸ® Games</button>
<button class="tab" onclick="switchTab('calendar')">ğŸ“… Calendar</button>
<button class="tab" onclick="switchTab('settings')">âš™ï¸ Settings</button>
</div>

<!-- LOG TAB -->
<div id="logTab" class="tab-content active">

<div class="card">
<h3>ğŸ“… Context & Time</h3>
<div class="input-label">ğŸ“† Date</div>
<input type="date" id="entryDate">

<div class="input-label">â° Exact Time</div>
<input type="time" id="entryTime">

<div class="input-label">ğŸŒ Time of Day</div>
<select id="timeOfDay">
<option>Morning (5am-12pm)</option>
<option>Afternoon (12pm-5pm)</option>
<option>Evening (5pm-9pm)</option>
<option>Night (9pm-5am)</option>
</select>

<div class="input-label">ğŸŒ¦ï¸ Season</div>
<select id="season">
<option>Spring ğŸŒ¸</option>
<option>Summer â˜€ï¸</option>
<option>Autumn ğŸ‚</option>
<option>Winter â„ï¸</option>
</select>

<div class="input-label">ğŸ­ Current Activity</div>
<select id="activity">
<option>ğŸ’¼ Working (job/career)</option>
<option>ğŸ“š Learning (study/research)</option>
<option>ğŸ˜Œ Resting (relaxation/recovery)</option>
<option>ğŸ‘¥ Socializing (people/conversation)</option>
<option>ğŸƒ Moving (exercise/physical)</option>
<option>ğŸ¨ Creating (art/building/making)</option>
<option>ğŸ’† Self-care (health/grooming)</option>
<option>ğŸ  Maintaining (chores/errands)</option>
<option>ğŸŒ Exploring (travel/adventure)</option>
<option>ğŸ§˜ Reflecting (meditation/introspection)</option>
<option>ğŸ® Playing (games/entertainment)</option>
<option>ğŸ½ï¸ Eating (meals/cooking)</option>
</select>
</div>

<div class="card">
<h3>ğŸ§  Sleep Quality (0-10)</h3>
<p class="card-subtitle">Rate based on how restorative the sleep felt and your daytime functionality</p>
<div class="slider-value" id="sleepVal">5</div>
<input type="range" id="sleep" min="0" max="10" value="5" oninput="updateSlider('sleep')">
<div class="slider-anchors">
<div><strong>0-1:</strong> Catastrophic - barely slept, exhausted all day</div>
<div><strong>2-3:</strong> Very poor - fragmented, heavy grogginess</div>
<div><strong>4-5:</strong> Below baseline - not refreshing, need caffeine</div>
<div><strong>6:</strong> Acceptable - functional but not optimal</div>
<div><strong>7:</strong> Good - refreshed, stable energy</div>
<div><strong>8:</strong> Very good - deep sleep, clear head</div>
<div><strong>9:</strong> Excellent - fully restored, peak alertness</div>
<div><strong>10:</strong> Perfect - ideal restoration, high readiness</div>
</div>
</div>

<div class="card">
<h3>ğŸ˜Š Mood (0-10)</h3>
<p class="card-subtitle">Overall emotional valence - how positive or negative you feel</p>
<div class="slider-value" id="moodVal">5</div>
<input type="range" id="mood" min="0" max="10" value="5" oninput="updateSlider('mood')">
<div class="slider-anchors">
<div><strong>0-1:</strong> Extremely negative - despair, hopelessness</div>
<div><strong>2-3:</strong> Very low - sad, frustrated, heavy</div>
<div><strong>4-5:</strong> Below neutral - meh, slightly negative</div>
<div><strong>6:</strong> Neutral-positive - okay, stable</div>
<div><strong>7-8:</strong> Good - content, satisfied, optimistic</div>
<div><strong>9-10:</strong> Excellent - joyful, euphoric, blissful</div>
</div>
</div>

<!-- Continue with other sliders... -->
<div class="card">
<h3>ğŸ’ª Physical Energy (0-10)</h3>
<div class="slider-value" id="energyPhysicalVal">5</div>
<input type="range" id="energyPhysical" min="0" max="10" value="5" oninput="updateSlider('energyPhysical')">
</div>

<div class="card">
<h3>ğŸ§  Mental Energy (0-10)</h3>
<div class="slider-value" id="energyMentalVal">5</div>
<input type="range" id="energyMental" min="0" max="10" value="5" oninput="updateSlider('energyMental')">
</div>

<div class="card">
<h3>ğŸ¯ Focus (0-10)</h3>
<div class="slider-value" id="focusVal">5</div>
<input type="range" id="focus" min="0" max="10" value="5" oninput="updateSlider('focus')">
</div>

<div class="card">
<h3>ğŸ˜° Stress (0-10)</h3>
<div class="slider-value" id="stressVal">5</div>
<input type="range" id="stress" min="0" max="10" value="5" oninput="updateSlider('stress')">
</div>

<div class="card">
<h3>ğŸ’­ Deep Consciousness Dive</h3>

<div class="input-label">â¤ï¸ Dominant Emotion</div>
<input type="text" id="emotion" placeholder="">
<div class="input-hint" id="emotionHint">e.g., Joy, Anxiety, Excitement, Melancholy</div>

<div class="input-label">ğŸŒŠ Physical Sensation</div>
<input type="text" id="sensation" placeholder="">
<div class="input-hint" id="sensationHint">e.g., Tension in shoulders, Butterflies in stomach</div>

<div class="input-label">ğŸ”„ Recurring Pattern</div>
<input type="text" id="pattern" placeholder="">
<div class="input-hint" id="patternHint">e.g., Procrastination loop, Evening anxiety</div>

<div class="input-label">âš¡ Key Decision/Action</div>
<input type="text" id="action" placeholder="">
<div class="input-hint" id="actionHint">e.g., Started new project, Had difficult conversation</div>

<div class="input-label">ğŸ’­ Raw Unfiltered Thoughts</div>
<textarea id="thought" placeholder="Stream of consciousness..."></textarea>

<div class="input-label">ğŸ¯ Current Goal</div>
<input type="text" id="goal" placeholder="">
<div class="input-hint" id="goalHint">e.g., Complete project by Friday, Be more present</div>

<div class="input-label">ğŸš§ Main Obstacle</div>
<input type="text" id="obstacle" placeholder="">
<div class="input-hint" id="obstacleHint">e.g., Time pressure, Self-doubt, Unclear requirements</div>

<button onclick="saveEntry()">ğŸ’¾ Save Entry & Analyze</button>
</div>

<div class="card">
<h3>Current State Score</h3>
<div class="score-big" id="currentScore">--</div>
<div class="score-label" id="currentLabel">Complete entry to calculate</div>
</div>

</div>

<!-- VOICE TAB -->
<div id="voiceTab" class="tab-content">
<div class="card">
<h3>ğŸ¤ Voice Memo Recorder</h3>
<p class="card-subtitle">Record voice notes with real-time transcription</p>
<button class="record-btn" id="recordBtn" onclick="toggleRecording()" style="width:80px;height:80px;border-radius:50%;font-size:32px;margin:20px auto;display:block">â—</button>
<p id="recordStatus" style="text-align:center;font-weight:600;margin:12px 0">Tap to start recording</p>
<div id="transcriptBox" style="min-height:100px;background:#0a0a1f;border-radius:12px;padding:16px;margin-top:12px"></div>
</div>
<div class="card">
<h3>ğŸ“ Voice Memos (<span id="memoCount">0</span>)</h3>
<div id="memosList"></div>
</div>
</div>

<!-- MEDIA TAB -->
<div id="mediaTab" class="tab-content">
<div class="card">
<h3>ğŸ“¸ Upload Visual Memories</h3>
<label style="display:block;border:2px dashed #374151;border-radius:12px;padding:40px;text-align:center;cursor:pointer" for="mediaInput">
<div style="font-size:48px;margin-bottom:12px">ğŸ“·</div>
<div style="font-weight:700;margin-bottom:8px">Tap to upload photos or videos</div>
<div style="font-size:13px;color:#9ca3af">Preserves visual consciousness states</div>
<input type="file" id="mediaInput" accept="image/*,video/*" onchange="uploadMedia(event)" multiple style="display:none">
</label>
</div>
<div class="card">
<h3>ğŸ–¼ï¸ Gallery (<span id="mediaCount">0</span>)</h3>
<div id="mediaGallery" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(120px,1fr));gap:12px"></div>
</div>
</div>

<!-- CHAT TAB -->
<div id="chatTab" class="tab-content">
<div class="card">
<h3>ğŸ’¬ AI Digital Twin - Talk to Yourself</h3>
<p class="card-subtitle">Your AI clone learns from your entries and responds as you would</p>
<div class="chat-container">
<div class="chat-messages" id="chatMessages">
<div class="chat-msg assistant">ğŸ‘‹ Hi! I'm your AI consciousness twin. I've been analyzing your patterns and I respond as YOU would. Ask me anything about your mental states, patterns, or future predictions.</div>
</div>
<div class="chat-input-group">
<input type="text" id="chatInput" placeholder="Ask your twin anything..." onkeypress="if(event.key==='Enter')sendChat()">
<button onclick="sendChat()">Send</button>
</div>
</div>
</div>
</div>

<!-- ANALYSIS TAB -->
<div id="analysisTab" class="tab-content">
<div class="card">
<h3>ğŸ“Š Your Statistics</h3>
<div class="stats-grid" id="statsGrid">
<div class="stat-box">
<div class="stat-value" id="avgMood">--</div>
<div class="stat-label">Avg Mood</div>
</div>
<div class="stat-box">
<div class="stat-value" id="avgFocus">--</div>
<div class="stat-label">Avg Focus</div>
</div>
<div class="stat-box">
<div class="stat-value" id="avgEnergy">--</div>
<div class="stat-label">Avg Energy</div>
</div>
<div class="stat-box">
<div class="stat-value" id="totalEntries">0</div>
<div class="stat-label">Total Entries</div>
</div>
</div>
</div>

<div class="card">
<h3>ğŸ”® Predictions</h3>
<div id="predictions"></div>
</div>

<div class="card">
<h3>ğŸ“ˆ Trends</h3>
<div id="trends"></div>
</div>

<div class="card">
<h3>ğŸ” Pattern Detection</h3>
<div id="patterns"></div>
</div>
</div>

<!-- HEALTH TAB -->
<div id="healthTab" class="tab-content">
<div class="card">
<h3>âš•ï¸ Health Profile</h3>
<div class="input-label">Age</div>
<input type="number" id="healthAge" placeholder="Your age">
<div class="input-label">Weight (kg)</div>
<input type="number" id="healthWeight" placeholder="Your weight">
<div class="input-label">Height (cm)</div>
<input type="number" id="healthHeight" placeholder="Your height">
<div class="input-label">Current Medications</div>
<textarea id="healthMeds" placeholder="List any medications..."></textarea>
<div class="input-label">Health Conditions</div>
<textarea id="healthConditions" placeholder="Any conditions or concerns..."></textarea>
<button onclick="saveHealthProfile()">ğŸ’¾ Save Health Profile</button>
</div>

<div class="card">
<h3>ğŸ©º AI Health Assistant</h3>
<p class="card-subtitle">Get personalized health insights based on your profile</p>
<button onclick="getHealthInsights()">Get Health Analysis</button>
<div id="healthInsights"></div>
</div>
</div>

<!-- GAMES TAB -->
<div id="gamesTab" class="tab-content">
<div class="card">
<h3>ğŸ® Brain Training Games</h3>
<p class="card-subtitle">Boost your cognitive abilities with these games</p>
<div class="game-grid">
<div class="game-card" onclick="playGame('memory')">
<div class="game-icon">ğŸ§©</div>
<div class="game-title">Memory Match</div>
<div class="game-desc">Test your working memory</div>
</div>
<div class="game-card" onclick="playGame('pattern')">
<div class="game-icon">ğŸ”¢</div>
<div class="game-title">Pattern Recognition</div>
<div class="game-desc">Identify sequences</div>
</div>
<div class="game-card" onclick="playGame('iq')">
<div class="game-icon">ğŸ§ </div>
<div class="game-title">IQ Test</div>
<div class="game-desc">Measure intelligence</div>
</div>
<div class="game-card" onclick="playGame('speed')">
<div class="game-icon">âš¡</div>
<div class="game-title">Processing Speed</div>
<div class="game-desc">Quick thinking test</div>
</div>
</div>
</div>
</div>

<!-- CALENDAR TAB -->
<div id="calendarTab" class="tab-content">
<div class="card">
<h3>ğŸ“… Calendar & Planning</h3>
<div class="calendar" id="calendar"></div>
</div>
<div class="card">
<h3>â° Alarms & Reminders</h3>
<div class="input-label">Add Reminder</div>
<input type="text" id="reminderText" placeholder="What do you want to remember?">
<input type="datetime-local" id="reminderTime">
<button onclick="addReminder()">â• Add Reminder</button>
<div id="remindersList"></div>
</div>
</div>

<!-- SETTINGS TAB -->
<div id="settingsTab" class="tab-content">
<div class="card">
<h3>âš™ï¸ Settings & Preferences</h3>
<div class="settings-group">
<div class="settings-item">
<div class="settings-label">ğŸŒ™ Dark Mode</div>
<div class="toggle-switch active" onclick="toggleSetting(this,'darkMode')"></div>
</div>
<div class="settings-item">
<div class="settings-label">ğŸ”” Notifications</div>
<div class="toggle-switch active" onclick="toggleSetting(this,'notifications')"></div>
</div>
<div class="settings-item">
<div class="settings-label">ğŸ¤ Auto-transcribe Voice</div>
<div class="toggle-switch active" onclick="toggleSetting(this,'autoTranscribe')"></div>
</div>
</div>
</div>

<div class="card">
<h3>ğŸ’¾ Data Management</h3>
<button onclick="exportData()">ğŸ“¤ Export All Data</button>
<button onclick="importData()" class="secondary">ğŸ“¥ Import Data</button>
<button onclick="clearAllData()" class="secondary" style="background:#ef4444">ğŸ—‘ï¸ Clear All Data</button>
</div>
</div>

</div>

<!-- Modals -->
<div id="modal" class="modal">
<div class="modal-content">
<span class="modal-close" onclick="closeModal()">âœ•</span>
<div id="modalContent"></div>
</div>
</div>

<!-- Toast -->
<div class="toast" id="toast"></div>

<script>
// STATE
let data=JSON.parse(localStorage.getItem('cos_ultimate_data')||'[]')
let voiceMemos=JSON.parse(localStorage.getItem('cos_voice')||'[]')
let mediaFiles=JSON.parse(localStorage.getItem('cos_media')||'[]')
let healthProfile=JSON.parse(localStorage.getItem('cos_health')||'{}')
let reminders=JSON.parse(localStorage.getItem('cos_reminders')||'[]')
let settings=JSON.parse(localStorage.getItem('cos_settings')||'{"darkMode":true,"notifications":true,"autoTranscribe":true}')
let isRecording=false
let mediaRecorder=null
let audioChunks=[]
let recognition=null
let fullTranscript=''

// EMOTION DATABASE (300+)
const emotions=[
"Joy","Sadness","Anger","Fear","Surprise","Disgust","Love","Contentment","Pride",
"Amusement","Gratitude","Relief","Hope","Bliss","Euphoria","Excitement","Satisfaction",
"Awe","Serenity","Enthusiasm","Sorrow","Grief","Disappointment","Loneliness","Despair",
"Regret","Hopelessness","Melancholy","Guilt","Shame","Hurt","Rejection","Irritation",
"Frustration","Rage","Resentment","Annoyance","Contempt","Jealousy","Bitterness","Hostility",
"Hatred","Indignation","Anxiety","Worry","Terror","Panic","Insecurity","Nervousness",
"Dread","Apprehension","Helplessness","Vulnerability","Amazement","Shock","Astonishment",
"Confusion","Embarrassment","Envy","Admiration","Compassion","Sympathy","Nostalgia",
"Wonder","Meaningfulness","Emptiness","Alienation","Longing","Yearning","Peace",
"Fulfillment","Ambition","Determination","Curiosity","Passion","Desire","Craving",
"Motivation","Zeal","Calm","Tension","Restlessness","Anticipation","Tenderness","Fondness",
"Infatuation","Adoration","Homesickness","Disillusionment","Boredom","Apathy","Overwhelm",
"Burnout","Empowerment","Confidence","Inadequacy","Self-doubt","Triumph"
]

// Initialize
document.addEventListener('DOMContentLoaded',()=>{
initDateTime()
updateDynamicPlaceholders()
renderDashboard()
initSpeechRecognition()
console.log('ğŸ§  Consciousness OS Ultimate loaded')
})

// DATE TIME INIT
function initDateTime(){
const now=new Date()
document.getElementById('entryDate').valueAsDate=now
document.getElementById('entryTime').value=now.toTimeString().slice(0,5)
}

// DYNAMIC PLACEHOLDERS
function updateDynamicPlaceholders(){
const recent=data.slice(-5)
const prevEmotions=recent.map(e=>e.emotion).filter(Boolean)
const randomEmotion=emotions[Math.floor(Math.random()*emotions.length)]
const prevSensations=recent.map(e=>e.sensation).filter(Boolean)
const prevPatterns=recent.map(e=>e.pattern).filter(Boolean)
const prevActions=recent.map(e=>e.action).filter(Boolean)
const prevGoals=recent.map(e=>e.goal).filter(Boolean)
const prevObstacles=recent.map(e=>e.obstacle).filter(Boolean)

document.getElementById('emotion').placeholder=prevEmotions.length?prevEmotions[0]:randomEmotion
document.getElementById('emotionHint').textContent=`Previously: ${prevEmotions.slice(0,3).join(', ')||'None yet'}`
document.getElementById('sensation').placeholder=prevSensations[0]||'Tight chest, warm face, relaxed body'
document.getElementById('pattern').placeholder=prevPatterns[0]||'Overthinking at night, morning clarity'
document.getElementById('action').placeholder=prevActions[0]||'Made a tough call, avoided conflict'
document.getElementById('goal').placeholder=prevGoals[0]||'Finish report, call friend, exercise'
document.getElementById('obstacle').placeholder=prevObstacles[0]||'Time pressure, uncertainty, fatigue'
}

// SLIDER UPDATE
function updateSlider(id){
const slider=document.getElementById(id)
const display=document.getElementById(id+'Val')
if(slider && display){
display.textContent=slider.value
calculateLiveScore()
}
}

// LIVE SCORE
function calculateLiveScore(){
const mood=+document.getElementById('mood').value
const energy=+document.getElementById('energyMental').value
const focus=+document.getElementById('focus').value
const sleep=+document.getElementById('sleep').value
const stress=+document.getElementById('stress').value
const score=((focus*2.5+energy*2.2+mood*1.5+sleep*1.8+stress*-1)/9).toFixed(1)
document.getElementById('currentScore').textContent=score
document.getElementById('currentLabel').textContent=
score>7.5?'ğŸš€ Peak Performance':
score>6?'âš¡ High Function':
score>4.5?'âš–ï¸ Balanced':
'ğŸŒ™ Recovery Needed'
}

// SAVE ENTRY
function saveEntry(){
const entry={
id:Date.now(),
timestamp:new Date().toISOString(),
date:document.getElementById('entryDate').value,
time:document.getElementById('entryTime').value,
timeOfDay:document.getElementById('timeOfDay').value,
season:document.getElementById('season').value,
activity:document.getElementById('activity').value,
sleep:+document.getElementById('sleep').value,
mood:+document.getElementById('mood').value,
energyPhysical:+document.getElementById('energyPhysical').value,
energyMental:+document.getElementById('energyMental').value,
focus:+document.getElementById('focus').value,
stress:+document.getElementById('stress').value,
emotion:document.getElementById('emotion').value,
sensation:document.getElementById('sensation').value,
pattern:document.getElementById('pattern').value,
action:document.getElementById('action').value,
thought:document.getElementById('thought').value,
goal:document.getElementById('goal').value,
obstacle:document.getElementById('obstacle').value
}
entry.cognition=((entry.focus*2.5+entry.energyMental*2.2+entry.energyPhysical*1.3+entry.mood*1.5+entry.sleep*1.8+entry.stress*-1)/9.3).toFixed(1)
data.push(entry)
localStorage.setItem('cos_ultimate_data',JSON.stringify(data))
showToast('âœ… Entry saved! Cognition: '+entry.cognition)
updateDynamicPlaceholders()
renderDashboard()
document.querySelectorAll('#logTab input[type="text"],#logTab textarea').forEach(el=>el.value='')
}

// VOICE RECORDING
function initSpeechRecognition(){
try{
const SpeechRecognition=window.SpeechRecognition||window.webkitSpeechRecognition
if(SpeechRecognition){
recognition=new SpeechRecognition()
recognition.continuous=true
recognition.interimResults=true
recognition.lang='en-US'
recognition.onresult=(e)=>{
let transcript=''
for(let i=e.resultIndex;i<e.results.length;i++){
transcript+=e.results[i][0].transcript
}
fullTranscript=transcript
document.getElementById('transcriptBox').textContent=transcript
}
recognition.onerror=(e)=>{
console.error('Speech error:',e.error)
showToast('âŒ Mic error: '+e.error)
}
}
}catch(e){console.error('Speech init error:',e)}
}

async function toggleRecording(){
if(!isRecording){
try{
const stream=await navigator.mediaDevices.getUserMedia({audio:true})
mediaRecorder=new MediaRecorder(stream)
audioChunks=[]
fullTranscript=''
mediaRecorder.ondataavailable=e=>audioChunks.push(e.data)
mediaRecorder.onstop=()=>{
const blob=new Blob(audioChunks,{type:'audio/webm'})
const reader=new FileReader()
reader.onloadend=()=>{
voiceMemos.push({
id:Date.now(),
timestamp:new Date().toISOString(),
audio:reader.result,
transcript:fullTranscript
})
localStorage.setItem('cos_voice',JSON.stringify(voiceMemos))
loadVoiceMemos()
showToast('âœ… Voice memo saved')
}
reader.readAsDataURL(blob)
stream.getTracks().forEach(t=>t.stop())
}
mediaRecorder.start()
if(recognition)recognition.start()
isRecording=true
document.getElementById('recordBtn').style.background='#dc2626'
document.getElementById('recordStatus').textContent='Recording... Tap to stop'
showToast('ğŸ¤ Recording started')
}catch(err){
showToast('âŒ Microphone access denied')
}
}else{
if(mediaRecorder)mediaRecorder.stop()
if(recognition)recognition.stop()
isRecording=false
document.getElementById('recordBtn').style.background='linear-gradient(135deg,#8b5cf6,#7c3aed)'
document.getElementById('recordStatus').textContent='Tap to start'
}
}

function loadVoiceMemos(){
document.getElementById('memoCount').textContent=voiceMemos.length
const list=document.getElementById('memosList')
if(!voiceMemos.length){list.innerHTML='<p style="color:#9ca3af;text-align:center;padding:20px">No memos yet</p>';return}
list.innerHTML=voiceMemos.slice().reverse().slice(0,20).map(m=>`
<div style="padding:16px;background:#0a0a1f;border-radius:10px;margin-bottom:12px">
<div style="font-size:11px;color:#9ca3af;margin-bottom:8px">${new Date(m.timestamp).toLocaleString()}</div>
<audio controls src="${m.audio}" style="width:100%;height:36px;margin-bottom:8px"></audio>
${m.transcript?`<div style="font-size:13px;padding:12px;background:#1f2937;border-radius:8px">${m.transcript}</div>`:''}
</div>
`).join('')
}

// MEDIA UPLOAD
function uploadMedia(e){
const files=e.target.files
let count=0
Array.from(files).forEach(file=>{
const reader=new FileReader()
reader.onload=ev=>{
mediaFiles.push({
id:Date.now()+Math.random(),
timestamp:new Date().toISOString(),
type:file.type.startsWith('video')?'video':'image',
data:ev.target.result,
name:file.name
})
count++
if(count===files.length){
localStorage.setItem('cos_media',JSON.stringify(mediaFiles))
loadMediaGallery()
showToast(`âœ… ${files.length} file(s) uploaded`)
}
}
reader.readAsDataURL(file)
})
e.target.value=''
}

function loadMediaGallery(){
document.getElementById('mediaCount').textContent=mediaFiles.length
const gallery=document.getElementById('mediaGallery')
if(!mediaFiles.length){gallery.innerHTML='<p style="grid-column:1/-1;text-align:center;color:#9ca3af;padding:40px">No media yet</p>';return}
gallery.innerHTML=mediaFiles.slice().reverse().slice(0,50).map(m=>`
<div style="aspect-ratio:1;border-radius:10px;overflow:hidden;background:#1f2937;cursor:pointer">
${m.type==='image'?`<img src="${m.data}" style="width:100%;height:100%;object-fit:cover">`:`<video src="${m.data}" style="width:100%;height:100%;object-fit:cover"></video>`}
</div>
`).join('')
}

// CHAT
function sendChat(){
const input=document.getElementById('chatInput')
const msg=input.value.trim()
if(!msg)return
addChatMsg('user',msg)
input.value=''
const response=getAIResponse(msg)
setTimeout(()=>addChatMsg('assistant',response),500)
}

function addChatMsg(role,content){
const container=document.getElementById('chatMessages')
const div=document.createElement('div')
div.className='chat-msg '+role
div.textContent=content
container.appendChild(div)
container.scrollTop=container.scrollHeight
}

function getAIResponse(msg){
if(!data.length)return "I need more data about you first. Start logging your consciousness!"
const recent=data.slice(-10)
const avgMood=(recent.reduce((sum,e)=>sum+e.mood,0)/recent.length).toFixed(1)
const avgFocus=(recent.reduce((sum,e)=>sum+e.focus,0)/recent.length).toFixed(1)
const avgCog=(recent.reduce((sum,e)=>sum+parseFloat(e.cognition),0)/recent.length).toFixed(1)
const responses=[
`Based on ${data.length} entries, your average mood is ${avgMood}/10. ${avgMood>7?"You're doing great!":avgMood>5?"You're balanced.":"Consider what's affecting you."}`,
`Your focus averages ${avgFocus}/10 recently. ${avgFocus>7?"Excellent concentration!":"Try eliminating distractions."}`,
`I see your cognition at ${avgCog}/10. ${avgCog>7?"Peak performance!":avgCog>5?"Good baseline.":"Prioritize rest and stress management."}`,
`Analyzing your patterns: ${recent.filter(e=>e.stress>7).length} high-stress states detected. ${recent.filter(e=>e.stress>7).length>3?"Stress management recommended.":"Stress is manageable."}`,
`Your ${recent[0].emotion||'recent emotion'} appears frequently. This might relate to your ${recent[0].pattern||'patterns'}.`,
]
return responses[Math.floor(Math.random()*responses.length)]
}

// DASHBOARD
function renderDashboard(){
const recent=data.slice(-30)
if(!recent.length)return
document.getElementById('avgMood').textContent=(recent.reduce((s,e)=>s+e.mood,0)/recent.length).toFixed(1)
document.getElementById('avgFocus').textContent=(recent.reduce((s,e)=>s+e.focus,0)/recent.length).toFixed(1)
document.getElementById('avgEnergy').textContent=(recent.reduce((s,e)=>s+e.energyMental,0)/recent.length).toFixed(1)
document.getElementById('totalEntries').textContent=data.length
renderPredictions()
renderTrends()
renderPatterns()
}

// PREDICTIONS
function renderPredictions(){
const container=document.getElementById('predictions')
if(data.length<7){container.innerHTML='<p style="color:#9ca3af">Need 7+ entries for predictions</p>';return}
const recent=data.slice(-7).map(e=>parseFloat(e.cognition))
const trend=(recent.slice(-3).reduce((s,v)=>s+v,0)/3)-(recent.slice(0,3).reduce((s,v)=>s+v,0)/3)
const tomorrow=trend>0.5?'High cognition likely':trend<-0.5?'Low focus risk':'Stable expected'
const week=trend>0.5?'Upward trajectory':'Maintain balance'
const month=data.length>30?'Long-term stable':'Building baseline'
container.innerHTML=`
<div style="padding:16px;background:#0a0a1f;border-radius:10px;margin-bottom:12px">
<strong>Tomorrow:</strong> ${tomorrow}</div>
<div style="padding:16px;background:#0a0a1f;border-radius:10px;margin-bottom:12px">
<strong>This Week:</strong> ${week}</div>
<div style="padding:16px;background:#0a0a1f;border-radius:10px">
<strong>This Month:</strong> ${month}</div>
`
}

// TRENDS
function renderTrends(){
const container=document.getElementById('trends')
if(data.length<10){container.innerHTML='<p style="color:#9ca3af">Need 10+ entries</p>';return}
const recent=data.slice(-10)
const early=data.slice(-20,-10)
const recentAvg=(recent.reduce((s,e)=>s+parseFloat(e.cognition),0)/recent.length).toFixed(1)
const earlyAvg=(early.reduce((s,e)=>s+parseFloat(e.cognition),0)/early.length).toFixed(1)
const change=(recentAvg-earlyAvg).toFixed(1)
container.innerHTML=`
<div style="padding:16px;background:#0a0a1f;border-radius:10px">
<strong>Recent Avg:</strong> ${recentAvg} | <strong>Previous:</strong> ${earlyAvg} | <strong>Change:</strong> ${change>0?'+':''}${change}
<div style="margin-top:12px;font-size:13px;color:#9ca3af">${change>0.5?'ğŸ“ˆ Improving trend':change<-0.5?'ğŸ“‰ Declining':'â¡ï¸ Stable'}</div>
</div>
`
}

// PATTERNS
function renderPatterns(){
const container=document.getElementById('patterns')
const freq={}
data.forEach(e=>{if(e.pattern)freq[e.pattern]=(freq[e.pattern]||0)+1})
const top=Object.entries(freq).sort((a,b)=>b[1]-a[1]).slice(0,6)
if(!top.length){container.innerHTML='<p style="color:#9ca3af">No patterns logged yet</p>';return}
container.innerHTML=top.map(([pattern,count])=>`
<span style="display:inline-block;padding:8px 16px;background:#1f2937;border-radius:8px;margin:4px;font-size:13px">
${pattern} <strong>(${count}Ã—)</strong>
</span>
`).join('')
}

// HEALTH
function saveHealthProfile(){
healthProfile={
age:document.getElementById('healthAge').value,
weight:document.getElementById('healthWeight').value,
height:document.getElementById('healthHeight').value,
meds:document.getElementById('healthMeds').value,
conditions:document.getElementById('healthConditions').value
}
localStorage.setItem('cos_health',JSON.stringify(healthProfile))
showToast('âœ… Health profile saved')
}

function getHealthInsights(){
const container=document.getElementById('healthInsights')
if(!healthProfile.age){container.innerHTML='<p style="color:#9ca3af;padding:12px">Save your health profile first</p>';return}
const bmi=(healthProfile.weight/((healthProfile.height/100)**2)).toFixed(1)
const insights=`
<div style="padding:16px;background:#0a0a1f;border-radius:10px;margin-top:12px">
<h4 style="margin-bottom:12px">ğŸ©º Health Analysis</h4>
<p style="margin-bottom:8px"><strong>BMI:</strong> ${bmi} ${bmi<18.5?'(Underweight)':bmi<25?'(Healthy)':bmi<30?'(Overweight)':'(Obese)'}</p>
<p style="margin-bottom:8px"><strong>Age Group:</strong> ${healthProfile.age<30?'Young Adult':healthProfile.age<50?'Adult':healthProfile.age<65?'Middle Age':'Senior'}</p>
<p style="margin-bottom:8px"><strong>Recommendations:</strong></p>
<ul style="margin-left:20px;line-height:1.8">
<li>Get 7-9 hours of sleep nightly</li>
<li>${bmi>25?'Consider weight management':'Maintain healthy weight'}</li>
<li>Exercise 150min/week minimum</li>
<li>Stay hydrated (2-3L water/day)</li>
<li>Regular health checkups</li>
</ul>
</div>
`
container.innerHTML=insights
}

// GAMES
function playGame(type){
const games={
memory:'ğŸ§© Memory Match: Remember card positions',
pattern:'ğŸ”¢ Pattern Recognition: Find the sequence',
iq:'ğŸ§  IQ Test: Problem-solving challenge',
speed:'âš¡ Processing Speed: React quickly'
}
showModal(`<h3>${games[type]}</h3><p style="margin:20px 0;color:#9ca3af">Game interface would load here. This is a demo version.</p><button onclick="closeModal()">Close</button>`)
}

// CALENDAR
function renderCalendar(){
const cal=document.getElementById('calendar')
const now=new Date()
const month=now.toLocaleString('default',{month:'long'})
const year=now.getFullYear()
const firstDay=new Date(year,now.getMonth(),1).getDay()
const daysInMonth=new Date(year,now.getMonth()+1,0).getDate()
let html=`<div class="calendar-header"><h3>${month} ${year}</h3></div><div class="calendar-grid">`
const days=['Su','Mo','Tu','We','Th','Fr','Sa']
days.forEach(d=>html+=`<div style="text-align:center;font-weight:600;color:#9ca3af;font-size:12px">${d}</div>`)
for(let i=0;i<firstDay;i++)html+=`<div></div>`
for(let i=1;i<=daysInMonth;i++){
const isToday=i===now.getDate()
html+=`<div class="calendar-day${isToday?' today':''}">${i}</div>`
}
html+=`</div>`
cal.innerHTML=html
}

// REMINDERS
function addReminder(){
const text=document.getElementById('reminderText').value
const time=document.getElementById('reminderTime').value
if(!text||!time)return showToast('âŒ Fill all fields')
reminders.push({id:Date.now(),text,time})
localStorage.setItem('cos_reminders',JSON.stringify(reminders))
document.getElementById('reminderText').value=''
document.getElementById('reminderTime').value=''
loadReminders()
showToast('âœ… Reminder added')
}

function loadReminders(){
const list=document.getElementById('remindersList')
if(!reminders.length){list.innerHTML='<p style="color:#9ca3af;padding:12px">No reminders yet</p>';return}
list.innerHTML=reminders.map(r=>`
<div style="padding:12px;background:#0a0a1f;border-radius:8px;margin-top:12px;display:flex;justify-content:space-between;align-items:center">
<div>
<div style="font-weight:600">${r.text}</div>
<div style="font-size:11px;color:#9ca3af;margin-top:4px">${new Date(r.time).toLocaleString()}</div>
</div>
<button onclick="deleteReminder(${r.id})" class="secondary" style="width:auto;padding:8px 16px">Delete</button>
</div>
`).join('')
}

function deleteReminder(id){
reminders=reminders.filter(r=>r.id!==id)
localStorage.setItem('cos_reminders',JSON.stringify(reminders))
loadReminders()
showToast('âœ… Reminder deleted')
}

// SETTINGS
function toggleSetting(el,key){
el.classList.toggle('active')
settings[key]=el.classList.contains('active')
localStorage.setItem('cos_settings',JSON.stringify(settings))
}

// EXPORT/IMPORT
function exportData(){
const exp={
version:'4.5-ultimate',
exported:new Date().toISOString(),
data,voiceMemos,mediaFiles,healthProfile,reminders,settings
}
const blob=new Blob([JSON.stringify(exp,null,2)],{type:'application/json'})
const a=document.createElement('a')
a.href=URL.createObjectURL(blob)
a.download='consciousness-os-'+new Date().toISOString().split('T')[0]+'.json'
a.click()
showToast('ğŸ“¤ Data exported')
}

function importData(){
const inp=document.createElement('input')
inp.type='file'
inp.accept='.json'
inp.onchange=e=>{
const file=e.target.files[0]
const reader=new FileReader()
reader.onload=ev=>{
try{
const imported=JSON.parse(ev.target.result)
data=imported.data||[]
voiceMemos=imported.voiceMemos||[]
mediaFiles=imported.mediaFiles||[]
healthProfile=imported.healthProfile||{}
reminders=imported.reminders||[]
settings=imported.settings||settings
localStorage.setItem('cos_ultimate_data',JSON.stringify(data))
localStorage.setItem('cos_voice',JSON.stringify(voiceMemos))
localStorage.setItem('cos_media',JSON.stringify(mediaFiles))
localStorage.setItem('cos_health',JSON.stringify(healthProfile))
localStorage.setItem('cos_reminders',JSON.stringify(reminders))
localStorage.setItem('cos_settings',JSON.stringify(settings))
renderDashboard()
showToast('âœ… Data imported: '+data.length+' entries')
}catch(err){
showToast('âŒ Import failed')
}
}
reader.readAsText(file)
}
inp.click()
}

function clearAllData(){
if(!confirm('âš ï¸ This will delete ALL data. Are you sure?'))return
localStorage.clear()
location.reload()
}

// UI HELPERS
function switchTab(name){
document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'))
document.querySelectorAll('.tab-content').forEach(t=>t.classList.remove('active'))
event.target.classList.add('active')
document.getElementById(name+'Tab').classList.add('active')
if(name==='voice')loadVoiceMemos()
if(name==='media')loadMediaGallery()
if(name==='analysis')renderDashboard()
if(name==='calendar')renderCalendar()
if(name==='calendar')loadReminders()
}

function showToast(msg){
const toast=document.getElementById('toast')
toast.textContent=msg
toast.classList.add('show')
setTimeout(()=>toast.classList.remove('show'),3500)
}

function showModal(content){
document.getElementById('modalContent').innerHTML=content
document.getElementById('modal').classList.add('show')
}

function closeModal(){
document.getElementById('modal').classList.remove('show')
}
</script>
</body>
</html>
